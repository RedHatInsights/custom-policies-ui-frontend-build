(self.webpackChunkpolicies_ui_frontend=self.webpackChunkpolicies_ui_frontend||[]).push([[396],{22391:(e,t,i)=>{"use strict";i.d(t,{Z:()=>Jn});var n=i(8650),a=i(55128),r=i(93264),o=i(5569),l=i(5148),s=i(58788),c=i(11331),d=i(47435),u=i(8813);const p=(0,a.getOuiaPropsFactory)("Policies"),m=(0,u.style)({paddingTop:(0,d.calc)(`${c.default.value} - var(--pf-c-page__main-section--PaddingTop)`)}),g=e=>r.createElement(s.EmptyState,Object.assign({variant:s.EmptyStateVariant.full,className:`${m} ${e.className?e.className:""} `},p("Policy/EmptyState",e)),e.icon&&r.createElement(s.EmptyStateIcon,{icon:e.icon,color:e.iconColor}),r.createElement(s.Title,{headingLevel:"h5",size:"lg"},e.title),r.createElement(s.EmptyStateBody,null,e.content),e.actionNode,e.actionLabel&&r.createElement(s.Button,{variant:"primary",onClick:e.action,isDisabled:!e.action},e.actionLabel));var y;!function(e){e.NOTIFICATION="notification"}(y||(y={}));const h={pages:{noPermissions:{title:"Policies",emptyState:{title:"You do not have access to Policies",content:"Contact your organization administrator(s) for more information."}},error:{title:"Policies",emptyState:{title:"Unhandled error",content:"There was a problem trying to process your request."}},listPage:{title:"Policies",emailOptIn:"One or more of your policies has a notification which may send an email. You can configure these notifications in the {0} for your organization. In order to receive emails from Insights, opt in to email notifications in your user preferences.",emptyState:{title:"No Policies",text:["No policies have been created.","Use self defined-policies to monitor your RHEL configurations with instant or daily alerts."]}},policyDetail:{errorChangingEnabledStatus:{notFound:{title:"Policy not found",text:"The policy does not exists on the server. It may have been removed by another user."},else:{title:"Enabled status change failed for policy",text:"There was an error setting the enabled status for this policy. Please try again."}},emptyState:{title:"Policy not found",text:"This policy with ID {0} cannot be found. It may have been removed by another user.",backText:"Back to previous page"},triggerEmptyState:{title:"No recent triggers",text:"This policy has not been triggered in the last 14 days.",sub:"Trigger history is held for 14 days. If this policy was triggered before this time, it cannot be shown."},errorState:{title:"Error when loading policy",text:"Error loading this policy.\nError {0}",actionText:"Try again"},triggerErrorState:{title:"Error when loading trigger history for policy",text:"Error loading trigger history for this policy.\nError {0}",actionText:"Try again"}}},components:{actions:{title:"Trigger actions",noActions:"No actions configured."},actionType:{[y.NOTIFICATION]:"Notification"},emailOptIn:{title:"Enable email alerts",switch:"Get emails when a policy runs",link:"Open email preferences"},lastTriggeredCell:{never:"Never",ago:"ago"},actionNotificationForm:{text:"This action sends a notification to process the message as configured in {0}.",link:"notification settings"}},tables:{policy:{title:"Policies",columns:{name:"Name",triggerActions:"Trigger actions",lastTriggered:"Last triggered"},emptyState:{neverRun:"Never",noConditions:"No conditions configured.",noDescription:"--",notFound:{title:"No matching policies found",content:"To continue, edit your filter settings and search again."}},actions:{notification:"Send a notification"}},trigger:{title:"Trigger",columns:{date:"Date",system:"System"},emptyState:{notFound:{title:"No matching triggers found",content:"No triggers match the selected search terms."}}}},wizards:{policy:{titleNew:"Create a policy",titleEdit:"Edit a policy",description:"Policies are processed on reception of system profile messages. If condition(s) are met, defined action(s) are triggered.",actions:{title:"Trigger actions",emailOptIn:"The notification for this policy sends an email from Red Hat Insights. To receive emails from Insights, opt in to email notifications in your user preferences."},conditions:{title:"Conditions",valid:"Valid condition",invalid:"Invalid condition",validating:"Validatingâ€¦",hint:'e.g. facts.arch = "x86_64"',summaryDesc:"Define conditions for your policy using any system facts."},hints:{hintTitle:"What conditions can I define?",hintParagraph1:"You can write a condition for any combination of system facts that apply to your Insights inventory systems.",hintLinkTitle:"Review available system facts",hintSyntaxExamplesSection:"Syntax examples",hintQuestion1:"Is wireshark RPM installed?",hintQuestion1Ans:"facts.installed_packages contains ['wireshark']",hintQuestion2:"Is the release older than RHEL 8.1?",hintQuestion2Ans:"facts.os_release < 8.1",hintQuestion3:"Which of my public cloud instances are missing a tag Owner value set?",hintQuestion3Ans:"facts.cloud_provider in ['alibaba',aws','azure','google'] and not tags.Owner",hintQuestion4:"Is time synchronization configured for RHEL7 and RHEL8?",hintQuestion4Ans:"(facts.os_release >=7 and facts.os_release <8 and not facts.enabled_services contains 'ntpd') or (facts.os_release >=8 and not facts.enabled_services contains 'chronyd')"},createPolicy:{title:"Create Policy"},details:{title:"Policy Details"},review:{title:"Review and enable",enableThisPolicy:"Enable this policy?",policyIsEnabled:"Policy is enabled",policyIsDisabled:"Policy is disabled",policy:{details:"Policy details",name:"Policy name",description:"Description"}}}},labels:{description:"Description"}},E=()=>r.createElement(r.Fragment,null,r.createElement(l.PageHeader,null,r.createElement(l.PageHeaderTitle,{title:h.pages.noPermissions.title})),r.createElement(l.Main,null,r.createElement(g,{icon:o.ZP,title:h.pages.noPermissions.emptyState.title,content:h.pages.noPermissions.emptyState.content})));var v=i(26990);const b=(0,v.EN)((e=>r.createElement(l.ErrorBoundary,{headerTitle:h.pages.error.title,errorTitle:h.pages.error.emptyState.title,errorDescription:h.pages.error.emptyState.content},e.children)));var f=i(22663),_=i(19694),T=i.n(_),C=i(64593),P=i(37176);const S=r.createContext({rbac:{canReadPolicies:!1,canWritePolicies:!1},userSettings:{settings:void 0,isSubscribedForNotifications:!1,refresh:()=>{console.error("Using default refresh function")}}});var x=i(94550),O=i(46242),N=i(98149),I=i(69455);const R=()=>r.createElement(I.ZP,null);var w=i(35451);const A=()=>r.createElement(w.ZP,{color:"green"});var k=i(36853);const L=()=>r.createElement(k.ZP,null),D=e=>{const{actionType:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}(e,["actionType"]);switch(t){case y.NOTIFICATION:return r.createElement(L,Object.assign({},i));case void 0:break;default:(0,O.vE)(t)}return null},F=(0,u.style)({borderRadius:3}),M=(0,u.style)({marginRight:5}),V=(0,u.style)({minWidth:145}),B=s.TooltipPosition.bottom,U=()=>r.createElement(s.Tooltip,{content:h.tables.policy.actions.notification,position:B},r.createElement(L,null)),j=e=>{const t=e.actions.slice(0,4),i=e.actions.slice(4),n=t.map(((e,t)=>{let i;switch(e.type){case y.NOTIFICATION:i=r.createElement(U,null);break;default:(0,O.vE)(e.type)}return r.createElement(s.SplitItem,{key:t,className:M},i)}));return i.length>0&&n.push(r.createElement(s.SplitItem,{key:"remaining",className:M},r.createElement(s.Badge,{className:F,isRead:!0},`${i.length} more`))),r.createElement(s.Split,Object.assign({},p("Policy/Table/Actions",e),{className:V}),n)};var G=i(86031),z=i(98207);const H=(0,u.style)({marginBottom:5}),Q=(0,u.style)({marginBottom:5,marginLeft:10,display:"inline"}),q=(0,u.style)({marginBottom:10,marginTop:10,marginLeft:10}),Z=(0,u.style)({marginLeft:25,marginBottom:8,marginTop:8}),W=e=>r.createElement(s.StackItem,{className:q},r.createElement(e.icon,null),r.createElement(s.Title,{headingLevel:"h2",className:Q,size:"md"},e.title),e.children&&r.createElement("div",{className:Z},e.children)),$=e=>r.createElement(r.Fragment,null,r.createElement(s.Stack,Object.assign({},p("Policy/Table/Expanded/Actions",e)),r.createElement(s.StackItem,null,r.createElement(s.Title,{headingLevel:"h2",className:H,size:"md"},h.components.actions.title)),0===e.actions.length?r.createElement(s.Text,null," ",h.components.actions.noActions," "):(e=>{const t=[];for(const i in e){const n=e[i];switch(n.type){case y.NOTIFICATION:t.push(r.createElement(r.Fragment,{key:i},r.createElement(W,{title:h.tables.policy.actions.notification,icon:L})));break;default:(0,O.vE)(n.type)}}return(0,a.join)(t,s.Divider)})(e.actions))),K=(0,u.style)({marginBottom:5}),Y=e=>r.createElement("div",Object.assign({},p("Policy/Table/Expanded/Conditions",e)),r.createElement(s.Title,{headingLevel:"h2",className:K,size:"md"},"Conditions"),r.createElement(s.Text,null,e.conditions||h.tables.policy.emptyState.noConditions));var X=i(93022);const J="dd MMM yyyy",ee=e=>r.createElement(r.Fragment,null,r.createElement(s.Text,Object.assign({},p("Policy/Table/Expanded/Dates",e)),"Last updated ",(0,X.Z)(e.updated,J)," | Created ",(0,X.Z)(e.created,J))),te=e=>r.createElement("div",Object.assign({},p("Policy/Table/Expanded/Description",e)),r.createElement(s.Form,null,r.createElement(s.FormGroup,{fieldId:"",label:h.labels.description})),r.createElement(s.Text,null," ",e.description," ")),ie=(0,u.style)({marginLeft:24}),ne=(0,u.style)({maxWidth:800,marginBottom:12,marginLeft:24,marginTop:24}),ae=(0,u.style)({marginLeft:24,marginBottom:12}),re=(0,u.style)(Object.assign(Object.assign({backgroundColor:G.ZP.var},(0,z.padding)(18,14)),{marginLeft:24,marginBottom:24})),oe=e=>r.createElement(s.Stack,Object.assign({},p("Policy/Table/Expanded",e),{className:ie}),e.description&&r.createElement(s.StackItem,{className:ne},r.createElement(te,{ouiaId:(0,a.ouiaIdConcat)(e.ouiaId,"description"),description:e.description})),r.createElement(s.StackItem,{className:ae},r.createElement(ee,{ouiaId:(0,a.ouiaIdConcat)(e.ouiaId,"dates"),updated:e.updated,created:e.created})),r.createElement(s.StackItem,null,r.createElement(s.Grid,null,r.createElement(s.GridItem,{className:re,span:6},r.createElement(Y,{ouiaId:(0,a.ouiaIdConcat)(e.ouiaId,"conditions"),conditions:e.conditions})),r.createElement(s.GridItem,{className:re,span:6},r.createElement($,{ouiaId:(0,a.ouiaIdConcat)(e.ouiaId,"actions"),actions:e.actions})))));var le=i(43321),se=i(42699),ce=i(17736);const de=(0,u.style)({marginLeft:10}),ue=e=>{let t;if(e.lastTriggered){const i=(0,le.Z)(e.lastTriggered,{months:1}),n=new Date(Date.now());t=(0,se.Z)(n,i)?(0,X.Z)(e.lastTriggered,"dd MMM yyyy"):`${(0,ce.Z)(e.lastTriggered)} ${h.components.lastTriggeredCell.ago}`}else t=h.components.lastTriggeredCell.never;return r.createElement("div",Object.assign({},p("Policy/Table/LastTriggered",e)),e.isEnabled?r.createElement(A,null):r.createElement(R,null),r.createElement("span",{className:de},t))},pe=(0,u.style)({backgroundColor:"white"}),me=["name","actions","is_enabled"],ge=(e,t,i,n)=>t.indexOf(i[e])+n,ye=e=>{const{onSort:t,error:i,policies:n,onCollapse:o,onSelect:c}=e,d=e.columnsToShow||me,u=d.includes("radioSelect");if(u&&!c)throw Error("RadioSelect requires an onSelect");const m=r.useMemo((()=>{const e=t?[x.sortable]:[];return{radioSelect:{title:"",transforms:[]},name:{title:h.tables.policy.columns.name,transforms:e,cellFormatters:[x.expandable],column:"name"},actions:{title:h.tables.policy.columns.triggerActions,transforms:[]},is_enabled:{title:h.tables.policy.columns.lastTriggered,transforms:e,column:"is_enabled"}}}),[t]),y=r.useMemo((()=>[o,d.includes("radioSelect")?void 0:c].filter((e=>e)).length),[o,c,d]),E=r.useMemo((()=>d.map((e=>m[e]))),[m,d]),v=r.useCallback(((e,i,n)=>{if(t){const e=((e,t,i)=>t[e-i].column)(i,E,y);e&&t(i,e,n===x.SortByDirection.asc?a.Direction.ASCENDING:a.Direction.DESCENDING)}}),[t,E,y]),b=r.useCallback(((e,t,i,a)=>{const r=n,l=null==r?void 0:r.findIndex((e=>e.id===a.id));if(o&&r&&void 0!==l&&-1!==l){const e=r[l];o(e,l,i)}}),[n,o]),f=r.useCallback(((e,t,i,a)=>{const r=n,o=null==r?void 0:r.findIndex((e=>e.id===a.id));if(c&&r&&void 0!==o&&-1!==o){const e=r[o];c(e,o,t)}}),[n,c]),_=r.useMemo((()=>{if(e.sortBy)return{index:ge(e.sortBy.column,E,m,y),direction:e.sortBy.direction===a.Direction.ASCENDING?"asc":"desc"}}),[e.sortBy,E,m,y]),T=r.useMemo((()=>e.error||e.loading?void 0:e.actionResolver||void 0),[e.error,e.loading,e.actionResolver]),C=r.useCallback((e=>{if(void 0===e.parent&&T&&e&&n){const t=n.find((t=>t.id===e.id));if(t)return T(t)}return[]}),[T,n]),P=r.useMemo((()=>i?[]:((e,t,i,n)=>e?e.reduce(((a,o,l)=>(a.push({id:o.id,key:o.id,isOpen:o.isOpen,selected:o.isSelected,cells:t.map((t=>{switch(t){case"actions":return r.createElement(r.Fragment,null,r.createElement(j,{ouiaId:o.id,actions:o.actions}));case"is_enabled":return r.createElement(r.Fragment,null,r.createElement(ue,{ouiaId:o.id,isEnabled:o.isEnabled,lastTriggered:o.lastTriggered}));case"name":return r.createElement(r.Fragment,null,i?r.createElement(N.Link,{to:Zn.policyDetail(o.id)},o.name):o.name);case"radioSelect":return r.createElement(r.Fragment,null,r.createElement(s.Radio,{id:`${o.id}-table-radio-id`,"aria-label":`Radio select for policy ${o.name}`,name:"policy-table-radio-select",isChecked:o.isSelected,onChange:n?()=>{const t=e.findIndex((e=>e.isSelected));-1!==t&&n(e[t],t,!1),n(o,l,!0)}:void 0}))}(0,O.vE)(t)}))}),a.push({parent:2*l,fullWidth:!0,showSelect:!1,cells:[{title:r.createElement(r.Fragment,null,r.createElement(oe,{ouiaId:o.id,key:o.id+"-content",description:o.description?o.description:h.tables.policy.emptyState.noDescription,conditions:o.conditions?o.conditions:h.tables.policy.emptyState.noConditions,actions:o.actions,created:o.ctime,updated:o.mtime}))}]}),a)),[]):[])(n,d,e.linkToDetailPolicy,c)),[i,n,d,c,e.linkToDetailPolicy]);return e.loading?r.createElement(l.SkeletonTable,{rowSize:e.loadingRowCount||10,columns:E,paddingColumnSize:y,sortBy:_}):i?r.createElement(g,Object.assign({},i,{className:pe})):r.createElement("div",Object.assign({},p("Policy/Table",e)),r.createElement(x.Table,{"aria-label":h.tables.policy.title,cells:E,rows:P,actionResolver:C,onSort:t?v:void 0,onCollapse:o?b:void 0,onSelect:e.error||!c||u?void 0:f,sortBy:_,canSelectAll:!1,isStickyHeader:!0},r.createElement(x.TableHeader,null),r.createElement(x.TableBody,null)))};var he,Ee;!function(e){e.NAME="name",e.IS_ACTIVE="is_enabled"}(he||(he={})),function(e){e[e.NONE=0]="NONE",e[e.PAGE=1]="PAGE",e[e.ALL=2]="ALL"}(Ee||(Ee={}));const ve=(0,u.style)({marginLeft:4}),be={[he.NAME]:{label:"Name",placeholder:"Filter by name"},[he.IS_ACTIVE]:{label:"Enabled",placeholder:"Filter by enabled status",options:{exclusive:!1,items:[{value:"Enabled",label:r.createElement(r.Fragment,null,r.createElement("span",{className:ve},"Enabled"))},{value:"Disabled",label:r.createElement(r.Fragment,null,r.createElement("span",{className:ve},"Disabled"))}]}}},fe=e=>{const{pageCount:t,count:i,page:n,perPage:o,showPerPageOptions:c,onPaginationChanged:d,onPaginationSizeChanged:u,onCreatePolicy:m,onDeletePolicy:g,hideActions:y,onSelectionChanged:h,selectedCount:E,hideBulkSelect:v,onEnablePolicy:b,onDisablePolicy:f,onExport:_}=e,T=(0,a.usePrimaryToolbarFilterConfig)(he,e.filters,e.setFilters,e.clearFilters,be),C=r.useMemo((()=>{if(v)return;const e=()=>h&&h(Ee.NONE),n=()=>h&&h(Ee.ALL);return{count:E||0,items:[{title:"Select none (0)",onClick:e},{title:`Select page (${t||0})`,onClick:()=>h&&h(Ee.PAGE)},{title:`Select all (${i||0})`,onClick:n}],checked:E===i,onSelect:t=>t?n():e()}}),[E,t,h,v,i]),P=r.useMemo((()=>({itemCount:i||0,page:n,perPage:o,perPageOptions:c?void 0:[],onSetPage:d,onFirstClick:d,onPreviousClick:d,onNextClick:d,onLastClick:d,onPageInput:d,onPerPageSelect:u,isCompact:!0,variant:s.PaginationVariant.top})),[c,i,n,o,d,u]),S=r.useMemo((()=>({itemCount:i||0,page:n,perPage:o,perPageOptions:c?void 0:[],onSetPage:d,onFirstClick:d,onPreviousClick:d,onNextClick:d,onLastClick:d,onPageInput:d,onPerPageSelect:u,isCompact:!1,variant:s.PaginationVariant.bottom})),[c,i,n,o,d,u]),x=r.useMemo((()=>{if(!y)return{actions:[{key:"create-policy",label:"Create policy",onClick:m,props:{isDisabled:!m}},{key:"delete-policy",label:"Remove",onClick:g,props:{isDisabled:!(E&&g)}},{key:"enable-policy",label:"Enable",onClick:b,props:{isDisabled:!(E&&b)}},{key:"disable-policy",label:"Disable",onClick:f,props:{isDisabled:!(E&&f)}}],kebabToggleProps:{isDisabled:!1}}}),[m,g,E,y,f,b]),O=r.useMemo((()=>{if(_)return{extraItems:[],onSelect:_}}),[_]);return r.createElement("div",Object.assign({},p("Policy/DualToolbar",e)),r.createElement(l.PrimaryToolbar,{bulkSelect:C,filterConfig:T.filterConfig,pagination:P,actionsConfig:x,activeFiltersConfig:T.activeFiltersConfig,exportConfig:O}),e.children,e.showBottomPagination&&r.createElement(l.PrimaryToolbar,{pagination:S}))},_e="/api/policies/v1.0";const Te={appId:"policies",defaultElementsPerPage:20,allowedActions:{normal:[y.NOTIFICATION],fedramp:[y.NOTIFICATION]},apis:{version:"v1.0",urls:{base:_e,userSettings:{email:("/user-config/preferences",`${_e}/user-config/preferences`)}}},pages:{emailPreferences:()=>(0,a.localUrl)("/user-preferences/notifications/insights",(0,a.getInsights)().chrome.isBeta()),notifications:()=>(0,a.localUrl)("/settings/notifications/rhel",(0,a.getInsights)().chrome.isBeta()),factsDocumentation:"https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/monitoring_and_reacting_to_configuration_changes_using_policies/policies-appendix_intro-policies#your-module-heading_policies-appendix"}},Ce=e=>(0,a.useUrlStateString)("name",e),Pe=e=>(0,a.useUrlStateMultipleOptions)("enabled",["Enabled","Disabled",""]),Se=e=>{switch(e){case he.NAME:return Ce;case he.IS_ACTIVE:return Pe;default:(0,O.vE)(e)}},xe=(e=250,t=!0)=>(0,a.useFilters)(he,e,t?Se:void 0),Oe=(e,t,i)=>{const[n,o]=r.useState(1),[l,s]=r.useState(t);return r.useEffect((()=>{o(1)}),[o,e]),{page:r.useMemo((()=>{const t=new a.Filter,r=(0,a.stringValue)(e[he.NAME]).trim(),o=(0,a.arrayValue)(e[he.IS_ACTIVE]);""!==r&&t.and(he.NAME,a.Operator.ILIKE,`%${r}%`),1===o.length&&t.and(he.IS_ACTIVE,a.Operator.BOOLEAN_IS,o.includes("Enabled")?"true":"false");const s=i?a.Sort.by("is_enabled"===i.column?"last_triggered":i.column,i.direction):void 0;return a.Page.of(n,l,t,s)}),[n,l,i,e]),changePage:r.useCallback(((e,t)=>{o(t)}),[o]),changeItemsPerPage:r.useCallback(((e,t)=>{o(1),s(t)}),[o,s])}};var Ne,Ie,Re=i(94782),we=i(70070),Ae=i(52890),ke=i(78558);!function(e){function t(){return ke.enum(["BOOLEAN","INT","LIST","STRING"])}function i(){return ke.object({ctime:ke.number().int().optional().nullable(),hostName:ke.string().optional().nullable(),id:ke.string().optional().nullable()}).nonstrict()}function n(){return ke.object({count:ke.number().int().optional().nullable()}).nonstrict()}function a(){return ke.object({actions:ke.string().optional().nullable(),conditions:ke.string(),ctime:ke.string().optional().nullable(),description:ke.string().optional().nullable(),id:r().optional().nullable(),isEnabled:ke.boolean().optional().nullable(),lastTriggered:ke.number().int().optional().nullable(),mtime:ke.string().optional().nullable(),name:ke.string()}).nonstrict()}function r(){return ke.string()}e.Fact=ke.object({id:ke.number().int().optional().nullable(),name:ke.string().optional().nullable(),type:t().optional().nullable()}).nonstrict(),e.FactType=t(),e.HistoryItem=i(),e.Meta=n(),e.Msg=ke.object({msg:ke.string().optional().nullable()}).nonstrict(),e.PagedResponseOfHistoryItem=ke.object({data:ke.array(i()).optional().nullable(),links:ke.record(ke.string()).optional().nullable(),meta:n().optional().nullable()}).nonstrict(),e.PagedResponseOfPolicy=ke.object({data:ke.array(a()).optional().nullable(),links:ke.record(ke.string()).optional().nullable(),meta:n().optional().nullable()}).nonstrict(),e.Policy=a(),e.UUID=r(),e.UserPreferences=ke.object({daily_email:ke.boolean().optional().nullable(),instant_email:ke.boolean().optional().nullable()}).nonstrict(),e.__Empty=ke.string().max(0).optional()}(Ne||(Ne={})),function(e){let t,i,n,a,r,o,l,s,c,d,u,p,m,g;!function(e){e.actionCreator=()=>(0,Ae.actionBuilder)("GET","/api/policies/v1.0/").queryParams({}).config({rules:[new we.ValidateRule(Ne.__Empty,"__Empty",404)]}).build()}(t=e.Get||(e.Get={})),function(e){const t=ke.array(Ne.Fact);e.actionCreator=()=>(0,Ae.actionBuilder)("GET","/api/policies/v1.0/facts").queryParams({}).config({rules:[new we.ValidateRule(t,"unknown",200)]}).build()}(i=e.GetFacts||(e.GetFacts={})),function(e){ke.enum(["equal","like","ilike","not_equal"]),ke.enum(["equal","like","ilike","not_equal"]),ke.string(),ke.enum(["true","false"]),ke.string(),ke.number().int(),ke.number().int(),ke.enum(["name","description","is_enabled","mtime"]),ke.enum(["asc","desc"]),e.actionCreator=e=>{const t={};return void 0!==e.filterOpDescription&&(t["filter:op[description]"]=e.filterOpDescription),void 0!==e.filterOpName&&(t["filter:op[name]"]=e.filterOpName),void 0!==e.filterDescription&&(t["filter[description]"]=e.filterDescription),void 0!==e.filterIsEnabled&&(t["filter[is_enabled]"]=e.filterIsEnabled),void 0!==e.filterName&&(t["filter[name]"]=e.filterName),void 0!==e.limit&&(t.limit=e.limit),void 0!==e.offset&&(t.offset=e.offset),void 0!==e.sortColumn&&(t.sortColumn=e.sortColumn),void 0!==e.sortDirection&&(t.sortDirection=e.sortDirection),(0,Ae.actionBuilder)("GET","/api/policies/v1.0/policies").queryParams(t).config({rules:[new we.ValidateRule(Ne.PagedResponseOfPolicy,"PagedResponseOfPolicy",200),new we.ValidateRule(Ne.__Empty,"__Empty",400),new we.ValidateRule(Ne.__Empty,"__Empty",403),new we.ValidateRule(Ne.__Empty,"__Empty",404)]}).build()}}(n=e.GetPolicies||(e.GetPolicies={})),function(e){ke.boolean(),e.actionCreator=e=>{const t={};return void 0!==e.alsoStore&&(t.alsoStore=e.alsoStore),(0,Ae.actionBuilder)("POST","/api/policies/v1.0/policies").queryParams(t).data(e.body).config({rules:[new we.ValidateRule(Ne.__Empty,"__Empty",200),new we.ValidateRule(Ne.Policy,"Policy",201),new we.ValidateRule(Ne.Msg,"Msg",400),new we.ValidateRule(Ne.__Empty,"__Empty",403),new we.ValidateRule(Ne.Msg,"Msg",409),new we.ValidateRule(Ne.__Empty,"__Empty",500)]}).build()}}(a=e.PostPolicies||(e.PostPolicies={})),function(e){ke.enum(["equal","like","ilike","not_equal"]),ke.enum(["equal","like","ilike","not_equal"]),ke.string(),ke.enum(["true","false"]),ke.string();const t=ke.array(Ne.UUID);e.actionCreator=e=>{const i={};return void 0!==e.filterOpDescription&&(i["filter:op[description]"]=e.filterOpDescription),void 0!==e.filterOpName&&(i["filter:op[name]"]=e.filterOpName),void 0!==e.filterDescription&&(i["filter[description]"]=e.filterDescription),void 0!==e.filterIsEnabled&&(i["filter[is_enabled]"]=e.filterIsEnabled),void 0!==e.filterName&&(i["filter[name]"]=e.filterName),(0,Ae.actionBuilder)("GET","/api/policies/v1.0/policies/ids").queryParams(i).config({rules:[new we.ValidateRule(t,"unknown",200),new we.ValidateRule(Ne.__Empty,"__Empty",400),new we.ValidateRule(Ne.__Empty,"__Empty",403),new we.ValidateRule(Ne.__Empty,"__Empty",404)]}).build()}}(r=e.GetPoliciesIds||(e.GetPoliciesIds={})),function(e){ke.array(ke.string());const t=ke.array(Ne.UUID);e.actionCreator=e=>(0,Ae.actionBuilder)("DELETE","/api/policies/v1.0/policies/ids").queryParams({}).data(e.body).config({rules:[new we.ValidateRule(t,"unknown",200),new we.ValidateRule(Ne.__Empty,"__Empty",403)]}).build()}(o=e.DeletePoliciesIds||(e.DeletePoliciesIds={})),function(e){ke.boolean(),ke.array(ke.string());const t=ke.array(Ne.UUID);e.actionCreator=e=>{const i={};return void 0!==e.enabled&&(i.enabled=e.enabled),(0,Ae.actionBuilder)("POST","/api/policies/v1.0/policies/ids/enabled").queryParams(i).data(e.body).config({rules:[new we.ValidateRule(t,"unknown",200),new we.ValidateRule(Ne.__Empty,"__Empty",403)]}).build()}}(l=e.PostPoliciesIdsEnabled||(e.PostPoliciesIdsEnabled={})),function(e){e.actionCreator=e=>(0,Ae.actionBuilder)("POST","/api/policies/v1.0/policies/validate").queryParams({}).data(e.body).config({rules:[new we.ValidateRule(Ne.Msg,"Msg",200),new we.ValidateRule(Ne.Msg,"Msg",400),new we.ValidateRule(Ne.__Empty,"__Empty",500)]}).build()}(s=e.PostPoliciesValidate||(e.PostPoliciesValidate={})),function(e){ke.string(),e.actionCreator=e=>{const t={};return void 0!==e.id&&(t.id=e.id),(0,Ae.actionBuilder)("POST","/api/policies/v1.0/policies/validate-name").queryParams(t).data(e.body).config({rules:[new we.ValidateRule(Ne.Msg,"Msg",200),new we.ValidateRule(Ne.Msg,"Msg",400),new we.ValidateRule(Ne.Msg,"Msg",403),new we.ValidateRule(Ne.__Empty,"__Empty",409),new we.ValidateRule(Ne.__Empty,"__Empty",500)]}).build()}}(c=e.PostPoliciesValidateName||(e.PostPoliciesValidateName={})),function(e){e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{id}".replace("{id}",e.id.toString());return(0,Ae.actionBuilder)("GET",t).queryParams({}).config({rules:[new we.ValidateRule(Ne.Policy,"Policy",200),new we.ValidateRule(Ne.Msg,"Msg",403),new we.ValidateRule(Ne.__Empty,"__Empty",404)]}).build()}}(d=e.GetPoliciesById||(e.GetPoliciesById={})),function(e){e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{id}".replace("{id}",e.id.toString());return(0,Ae.actionBuilder)("DELETE",t).queryParams({}).config({rules:[new we.ValidateRule(Ne.__Empty,"__Empty",200),new we.ValidateRule(Ne.__Empty,"__Empty",403),new we.ValidateRule(Ne.__Empty,"__Empty",404)]}).build()}}(u=e.DeletePoliciesById||(e.DeletePoliciesById={})),function(e){ke.boolean(),e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{id}/enabled".replace("{id}",e.id.toString()),i={};return void 0!==e.enabled&&(i.enabled=e.enabled),(0,Ae.actionBuilder)("POST",t).queryParams(i).config({rules:[new we.ValidateRule(Ne.__Empty,"__Empty",200),new we.ValidateRule(Ne.__Empty,"__Empty",403),new we.ValidateRule(Ne.__Empty,"__Empty",404),new we.ValidateRule(Ne.__Empty,"__Empty",500)]}).build()}}(p=e.PostPoliciesByIdEnabled||(e.PostPoliciesByIdEnabled={})),function(e){ke.enum(["equal","not_equal","like"]),ke.enum(["equal","like","not_equal"]),ke.string(),ke.string(),ke.number().int(),ke.number().int(),ke.enum(["hostName","ctime"]),ke.enum(["asc","desc"]),e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{id}/history/trigger".replace("{id}",e.id.toString()),i={};return void 0!==e.filterOpId&&(i["filter:op[id]"]=e.filterOpId),void 0!==e.filterOpName&&(i["filter:op[name]"]=e.filterOpName),void 0!==e.filterId&&(i["filter[id]"]=e.filterId),void 0!==e.filterName&&(i["filter[name]"]=e.filterName),void 0!==e.limit&&(i.limit=e.limit),void 0!==e.offset&&(i.offset=e.offset),void 0!==e.sortColumn&&(i.sortColumn=e.sortColumn),void 0!==e.sortDirection&&(i.sortDirection=e.sortDirection),(0,Ae.actionBuilder)("GET",t).queryParams(i).config({rules:[new we.ValidateRule(Ne.PagedResponseOfHistoryItem,"PagedResponseOfHistoryItem",200),new we.ValidateRule(Ne.__Empty,"__Empty",400),new we.ValidateRule(Ne.__Empty,"__Empty",403),new we.ValidateRule(Ne.__Empty,"__Empty",404),new we.ValidateRule(Ne.__Empty,"__Empty",500)]}).build()}}(m=e.GetPoliciesByIdHistoryTrigger||(e.GetPoliciesByIdHistoryTrigger={})),function(e){ke.boolean(),e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{policyId}".replace("{policyId}",e.policyId.toString()),i={};return void 0!==e.dry&&(i.dry=e.dry),(0,Ae.actionBuilder)("PUT",t).queryParams(i).data(e.body).config({rules:[new we.ValidateRule(Ne.Policy,"Policy",200),new we.ValidateRule(Ne.__Empty,"__Empty",400),new we.ValidateRule(Ne.__Empty,"__Empty",403),new we.ValidateRule(Ne.__Empty,"__Empty",404),new we.ValidateRule(Ne.Msg,"Msg",409)]}).build()}}(g=e.PutPoliciesByPolicyId||(e.PutPoliciesByPolicyId={}))}(Ie||(Ie={}));const Le=e=>Ie.GetPoliciesIds.actionCreator(e.toQuery()),De=new a.ImmutableContainerSet(void 0,a.ImmutableContainerSetMode.INCLUDE),Fe=new a.ImmutableContainerSet(void 0,a.ImmutableContainerSetMode.EXCLUDE),Me=(e,t,i,n)=>{const[o,l]=r.useState([]),[s,c]=r.useState(De),d=(0,P.Z)(e),{query:u,loading:p}=(0,Re.useParameterizedQuery)(Le),m=r.useCallback((()=>{c(De),l((e=>e.map((e=>Object.assign(Object.assign({},e),{isOpen:!1,isSelected:!1})))))}),[c]);r.useEffect((()=>{t||!e?l([]):e!==d&&l(null==e?void 0:e.map((e=>Object.assign(Object.assign({},e),{isOpen:!1,isSelected:s.contains(e.id)}))))}),[e,t,l,d,s]);const g=r.useCallback(((e,t,i)=>{l((n=>{const a=[...n];return a[t]=Object.assign(Object.assign({},e),{isOpen:i}),a}))}),[l]),y=r.useCallback((e=>{c((t=>t.remove(e)))}),[c]),h=r.useCallback(((e,t,i)=>{c((t=>i?t.add(e.id):t.remove(e.id))),l((n=>{const a=[...n];return a[t]=Object.assign(Object.assign({},e),{isSelected:i}),a}))}),[c]),E=r.useCallback((e=>{e===Ee.NONE?(c(De),l((e=>e.map((e=>Object.assign(Object.assign({},e),{isSelected:!1})))))):e===Ee.PAGE?(c((e=>e.addIterable(o.map((e=>e.id))))),l((e=>e.map((e=>Object.assign(Object.assign({},e),{isSelected:!0})))))):e===Ee.ALL?(c(Fe),l((e=>e.map((e=>Object.assign(Object.assign({},e),{isSelected:!0})))))):(0,O.vE)(e)}),[o]),v=r.useMemo((()=>s.size(i)),[s,i]),b=r.useCallback((()=>s.mode===a.ImmutableContainerSetMode.INCLUDE?Promise.resolve(s.values()):u(n).then((e=>{var t;if(e.error)throw e.errorObject;let i=[];if(200===(null===(t=e.payload)||void 0===t?void 0:t.status)){const t=new Set(e.payload.value);s.values().forEach((e=>{t.delete(e)})),i=t}return Array.from(i.values())}))),[u,n,s]);return{rows:o,onCollapse:g,onSelect:h,onSelectionChanged:E,selectionCount:v,clearSelection:m,getSelected:b,loadingSelected:p,selected:s,removeSelection:y}},Ve=()=>{const[e,t]=r.useState(),[i,n]=r.useState(0),a=r.useCallback((()=>{t(void 0),n(0)}),[n,t]);return{open:r.useCallback((e=>{"number"==typeof e?(t(void 0),n(e)):(t(e),n(1))}),[]),close:a,count:i,policy:e,isOpen:i>0}};var Be=i(42227),Ue=i(5717);const je=e=>e.map((e=>{if(!e||!e.type)return"";const t=`${e.type}`;switch(e.type){case y.NOTIFICATION:break;default:(0,O.vE)(e.type)}return t})).join(";"),Ge=e=>{if(!e||""===e)return[];const t=[];for(const i of e.split(";").map((e=>e.trim()))){if(""===i)continue;const[e]=i.split(" ",2);if("webhook"!==e&&"email"!==e)switch(e){case y.NOTIFICATION:t.push({type:y.NOTIFICATION});break;default:throw Error(`Unknown action.type=${e} found`)}}return t},ze=e=>{const{mtime:t,ctime:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}(e,["mtime","ctime"]);return Object.assign(Object.assign({},n),{name:e.name||"",conditions:e.conditions||"",isEnabled:void 0!==e.isEnabled&&e.isEnabled,actions:e.actions?je(e.actions):""})},He=e=>Object.assign(Object.assign({},e),{id:e.id?e.id:"",description:e.description?e.description:"",isEnabled:!!e.isEnabled&&e.isEnabled,actions:Ge(e.actions),mtime:e.mtime?(0,Ue.Z)(e.mtime):new Date(Date.now()),ctime:e.ctime?(0,Ue.Z)(e.ctime):new Date(Date.now()),lastTriggered:e.lastTriggered?(0,Be.Z)(e.lastTriggered/1e3):void 0}),Qe=e=>Object.assign(Object.assign({},e),{name:`Copy of ${e.name.slice(0,150-"Copy of ".length)}`,mtime:void 0,lastTriggered:void 0,ctime:void 0,id:void 0}),qe=(0,we.validationResponseTransformer)((e=>{var t,i;return"PagedResponseOfPolicy"===e.type?(0,we.validatedResponse)(e.type,e.status,{data:(i=e.value,i.data?i.data.map(He):[]),count:(null===(t=e.value.meta)||void 0===t?void 0:t.count)||0},e.errors):e})),Ze=(e,t)=>(0,a.useTransformQueryResponse)((0,Re.useQuery)((e=>{var t;return Ie.GetPolicies.actionCreator(null!==(t=null==e?void 0:e.toQuery())&&void 0!==t?t:{})})(e),t),qe),We=(0,we.validationResponseTransformer)((e=>{var t;let i=!0;return"PagedResponseOfPolicy"===e.type&&(i=!!(null===(t=e.value.data)||void 0===t?void 0:t.length)),(0,we.validatedResponse)("HasPolicies",e.status,i,e.errors)})),$e=e=>Ie.PostPoliciesIdsEnabled.actionCreator({body:e.policyIds,enabled:e.shouldBeEnabled}),Ke=()=>(0,Re.useMutation)($e);var Ye=i(74322),Xe=i(41054),Je=i(84956),et=i(87561);const tt=et.Ry().shape({type:et.nK().oneOf([y.NOTIFICATION]).required().defined()}),it=et.Ry().shape({type:et.nK().defined().required("Specify the action type").oneOf(Object.values(y))}),nt=et.Ry().shape({description:et.Z_().notRequired().trim(),isEnabled:et.O7().notRequired(),name:et.Z_().required("Write a name for this Policy").max(150).trim()}),at=et.Ry().shape({actions:et.IX(et.Vo((e=>{if((null==e?void 0:e.type)&&e.type===y.NOTIFICATION){const t=e.type;switch(t){case y.NOTIFICATION:return tt;default:(0,O.vE)(t)}}return it})))}),rt=et.Ry().shape({conditions:et.Z_().required("Enter a condition for the policy.").trim()}),ot=et.Ry().concat(nt).concat(at).concat(rt);var lt,st=i(84564),ct=i(7193);et.Ry(),function(e){e.SAVE="CREATE",e.VALIDATE_CONDITION="VALIDATE_CONDITION",e.VALIDATE_NAME="VALIDATE_NAME",e.NONE="NONE"}(lt||(lt={}));const dt=r.createContext({isLoading:!1,isFormValid:!1,triggerAction:()=>{throw Error("Action executed without WizardContext")},verifyResponse:{isValid:!1},createResponse:{created:!1},setVerifyResponse:()=>{throw Error("setVerifyResponse executed without WizardContext")},setMaxStep:()=>{throw Error("setMaxStep executed without a WizardContext")}}),ut=(0,u.style)({marginTop:"auto",marginBottom:14}),pt=(0,u.style)({marginRight:5}),mt=e=>{const t=(0,r.useContext)(dt);return r.createElement(s.WizardFooter,null,r.createElement(s.WizardContextConsumer,null,(i=>{const n=e.onNext&&(()=>{e.onNext&&e.onNext(t,i.onNext)});return r.createElement(r.Fragment,null,r.createElement(s.Button,{variant:s.ButtonVariant.primary,type:"submit",onClick:n||i.onNext,isDisabled:e.isLoading||!i.activeStep.enableNext},i.activeStep.nextButtonText||"Next"),!i.activeStep.hideBackButton&&r.createElement(s.Button,{variant:s.ButtonVariant.secondary,onClick:i.onBack,isDisabled:0===i.activeStep.id||e.isLoading},"Back"),!i.activeStep.hideCancelButton&&r.createElement(s.Button,{variant:s.ButtonVariant.link,onClick:i.onClose,isDisabled:e.isLoading},"Cancel"),e.isLoading&&r.createElement("div",{className:ut},e.loadingText," Â ",r.createElement(s.Spinner,{size:"md"})),!e.isLoading&&e.error&&r.createElement(s.Split,{className:ut},r.createElement(s.SplitItem,null,r.createElement(st.ZP,{className:pt,color:ct.ZP.value})),r.createElement(s.SplitItem,null,e.error)))})))};var gt=i(33606),yt=i(32412),ht=i(50744);const Et=e=>{const t=r.useMemo((()=>Te.pages.notifications()),[]),i=(0,r.useContext)(S);return r.createElement("div",Object.assign({},p("Policy/Action/Hook",e)),r.createElement(s.Text,null,(0,ht.WU)(h.components.actionNotificationForm.text,r.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},h.components.actionNotificationForm.link))),!i.userSettings.isSubscribedForNotifications&&r.createElement(a.InsightsEmailOptIn,{ouiaId:"action-email.wizard-email-required",content:h.wizards.policy.actions.emailOptIn,bundle:"rhel",insights:(0,a.getInsights)()}))},vt=e=>{var t,i;switch((null===(t=e.action)||void 0===t?void 0:t.type)||void 0){case y.NOTIFICATION:return r.createElement(Et,Object.assign({},e));case void 0:return null;default:throw new Error("Unexpected action type:["+(null===(i=e.action)||void 0===i?void 0:i.type)+"]")}},bt=(0,u.style)({gridGap:yt.ZP.var}),ft=(0,u.style)({backgroundColor:"white",border:"1px var(--pf-global--BorderColor--200) solid",boxShadow:"none"}),_t=(0,u.style)({marginLeft:10,display:"inline"}),Tt=e=>{var t;return r.createElement(s.Form,{className:bt},null===(t=e.actions)||void 0===t?void 0:t.map(((t,i)=>r.createElement(r.Fragment,{key:i},r.createElement(s.Card,{className:ft},r.createElement(s.CardHeader,{"data-codemods":"true"},r.createElement(s.CardActions,null,r.createElement(s.Button,{variant:"plain","aria-label":"Action",onClick:e.arrayHelpers.handleRemove(i)},r.createElement(gt.ZP,null))),r.createElement(s.CardTitle,null,r.createElement(r.Fragment,null,r.createElement(D,{actionType:null==t?void 0:t.type}),r.createElement(s.Title,{headingLevel:"h2",className:_t,size:"md"},(null==t?void 0:t.type)?(e=>{switch(e){case y.NOTIFICATION:return h.tables.policy.actions.notification;default:(0,O.vE)(e)}})(t.type):"")))),r.createElement(s.CardBody,{className:"pf-c-form"},r.createElement(vt,{ouiaId:`actions-form.${i.toString()}`,isReadOnly:e.isReadOnly,action:t,prefix:`actions.${i}`})))))))};var Ct=i(75902),Pt=i(81875);const St=(0,u.style)({marginBottom:16}),xt=e=>{const[t,i]=r.useState(!1),n=(r.useMemo((()=>{const e=(0,a.getInsightsEnvironment)((0,a.getInsights)());return a.Environments.govProd.includes(e)||a.Environments.govStage.includes(e)}),[])?Te.allowedActions.fedramp:Te.allowedActions.normal).map((t=>r.createElement(s.DropdownItem,{key:t,onClick:()=>(t=>{e.onTypeSelected(t),i(!1)})(t),isDisabled:!e.isTypeEnabled(t)},h.components.actionType[t])));return r.createElement(s.Dropdown,Object.assign({isOpen:t,dropdownItems:n,isPlain:!0,className:St,toggle:r.createElement(Ct.Z,{isPlain:!0,onToggle:e=>i(e),id:"add-action-toggle"},r.createElement(s.Button,{component:"a",variant:s.ButtonVariant.link,isInline:!0}," Add trigger actions ",r.createElement(Pt.ZP,null)," "))},p("Policy/Wizard/AddTrigger",e)))},Ot=()=>{var e;const{validateForm:t,values:i}=(0,Xe.useFormikContext)(),n=null===(e=i.actions)||void 0===e?void 0:e.length;return r.useEffect((()=>{t()}),[t,n]),r.createElement(r.Fragment,null,r.createElement(s.Title,{headingLevel:"h4",size:"xl"},h.wizards.policy.actions.title),r.createElement(Xe.FieldArray,{name:"actions"},(e=>r.createElement(r.Fragment,null,r.createElement(xt,{isTypeEnabled:t=>{var i;return 0===((null===(i=e.form.values.actions)||void 0===i?void 0:i.filter((e=>e.type===t)))||[]).length},onTypeSelected:t=>{e.push({type:t})}}),r.createElement(Tt,{id:"actions",name:"actions",actions:e.form.values.actions,arrayHelpers:e})))))};var Nt=i(47561),It=i(48286),Rt=i(18127),wt=i(50352),At=i(9963),kt=i(39557),Lt=i(62178),Dt=i(36763),Ft=i(15103);class Mt extends kt.Lexer{constructor(e){super(e),this._interp=new Lt.LexerATNSimulator(Mt._ATN,this)}get vocabulary(){return Mt.VOCABULARY}get grammarFileName(){return"Expression.g4"}get ruleNames(){return Mt.ruleNames}get serializedATN(){return Mt._serializedATN}get channelNames(){return Mt.channelNames}get modeNames(){return Mt.modeNames}static get _ATN(){return Mt.__ATN||(Mt.__ATN=(new At.ATNDeserializer).deserialize(Ft.toCharArray(Mt._serializedATN))),Mt.__ATN}}Mt.T__0=1,Mt.T__1=2,Mt.T__2=3,Mt.T__3=4,Mt.T__4=5,Mt.OR=6,Mt.AND=7,Mt.NOT=8,Mt.EQUAL=9,Mt.NOTEQUAL=10,Mt.CONTAINS=11,Mt.MATCHES=12,Mt.NEG=13,Mt.GT=14,Mt.GTE=15,Mt.LT=16,Mt.LTE=17,Mt.IN=18,Mt.QUOTED_NUMBER=19,Mt.NUMBER=20,Mt.FLOAT=21,Mt.INTEGER=22,Mt.SIMPLETEXT=23,Mt.STRING=24,Mt.WS=25,Mt.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"],Mt.modeNames=["DEFAULT_MODE"],Mt.ruleNames=["T__0","T__1","T__2","T__3","T__4","OR","AND","NOT","EQUAL","NOTEQUAL","CONTAINS","MATCHES","NEG","GT","GTE","LT","LTE","IN","QUOTED_NUMBER","NUMBER","FLOAT","INTEGER","SIMPLETEXT","STRING","WS","ESC","UNICODE","HEX","ESC_DOT","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","NEG_OP"],Mt._LITERAL_NAMES=[void 0,"'('","')'","'['","','","']'",void 0,void 0,void 0,"'='","'!='",void 0,void 0,void 0,"'>'","'>='","'<'","'<='"],Mt._SYMBOLIC_NAMES=[void 0,void 0,void 0,void 0,void 0,void 0,"OR","AND","NOT","EQUAL","NOTEQUAL","CONTAINS","MATCHES","NEG","GT","GTE","LT","LTE","IN","QUOTED_NUMBER","NUMBER","FLOAT","INTEGER","SIMPLETEXT","STRING","WS"],Mt.VOCABULARY=new Dt.VocabularyImpl(Mt._LITERAL_NAMES,Mt._SYMBOLIC_NAMES,[]),Mt._serializedATN="ì¤ìªºÖê¾ºä½“Ø‡îª‹ì‰Ä¯\b\t\t\t\t\t\t\b\t\b\t\t\t\n\t\n\v\t\v\f\t\f\r\t\r\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t !\t!\"\t\"#\t#$\t$%\t%&\t&'\t'(\t()\t)*\t*+\t+,\t,-\t-.\t./\t/0\t01\t12\t23\t34\t45\t56\t67\t78\t89\t9\b\b\b\b\t\t\t\t\n\n\v\v\v\f\f\f\f\f\f\f\f\f\r\r\r\r\r\r\r\rÂ¶\nÂ»\nÃ‚\n\rÃƒÃ‰\n\fÃŒ\vÃ‘\n\fÃ”\vÃš\n\fÃ\vÃ \nÃ£\n\rÃ¤Ã­\n  !!\"\"##$$%%&&''(())**++,,--..//00112233445566778899:\t\v\r\b\t\n\v\f\r!#%')+-/13579;=?ACEGIKMOQSUWY[]_acegikmoq$2;002;C\\aac|/02;C\\aac|))^^$$^^\v\f\"\"\n))11^^ddhhppttvv2;CHchCCccDDddEEeeFFffGGggHHhhIIiiJJjjKKkkLLllMMmmNNnnOOooPPppQQqqRRrrSSssTTttUUuuVVvvWWwwXXxxYYyyZZzz[[{{\\\\||Äœ\t\v\r!#%')+-/13suw\ty\v{\r}Â€Â„ÂˆÂŠÂÂ–ÂÂ Â¢!Â¥#Â§%Âª'Âµ)Â·+Â¼-Ã/Ã…1ÃŸ3Ã¢5Ã¨7Ã®9Ã´;Ã¶=Ã¹?Ã»AÃ½CÃ¿EÄGÄƒIÄ…KÄ‡MÄ‰OÄ‹QÄSÄUÄ‘WÄ“YÄ•[Ä—]Ä™_Ä›aÄcÄŸeÄ¡gÄ£iÄ¥kÄ§mÄ©oÄ«qÄ­st*tuv+vwx]x\byz.z\n{|_|\f}~Y-~_0Â€Â=ÂÂ‚W,Â‚ÂƒC\"ÂƒÂ„Â…W,Â…Â†Y-Â†Â‡c2Â‡ÂˆÂ‰?Â‰ÂŠÂ‹#Â‹ÂŒ?ÂŒÂÂA!ÂÂY-ÂÂW,ÂÂ‘c2Â‘Â’=Â’Â“M'Â“Â”W,Â”Â•a1Â•Â–Â—U+Â—Â˜=Â˜Â™c2Â™ÂšA!ÂšÂ›K&Â›ÂœE#ÂœÂa1ÂÂÂŸq9ÂŸÂ Â¡@Â¡Â¢Â£@Â£Â¤?Â¤ Â¥Â¦>Â¦\"Â§Â¨>Â¨Â©?Â©$ÂªÂ«M'Â«Â¬W,Â¬&Â­Â®)Â®Â¯)Â¯Â°)Â°Â¶Â±Â²$Â²Â³)Â³Â´$Â´Â¶ÂµÂ­ÂµÂ±Â¶(Â·Âº-Â¸Â¹0Â¹Â»-ÂºÂ¸ÂºÂ»Â»*Â¼Â½-Â½Â¾0Â¾Â¿-Â¿,Ã€Ã‚\tÃÃ€Ã‚ÃƒÃƒÃÃƒÃ„Ã„.Ã…ÃŠ\tÃ†Ã‰\tÃ‡Ã‰;ÃˆÃ†ÃˆÃ‡Ã‰ÃŒÃŠÃˆÃŠÃ‹Ã‹0ÃŒÃŠÃÃ’)ÃÃ‘5ÃÃ‘\nÃÃÃÃÃ‘Ã”Ã’ÃÃ’Ã“Ã“Ã•Ã”Ã’Ã•Ã )Ã–Ã›$Ã—Ãš5Ã˜Ãš\nÃ™Ã—Ã™Ã˜ÃšÃÃ›Ã™Ã›ÃœÃœÃÃÃ›ÃÃ $ÃŸÃÃŸÃ–Ã 2Ã¡Ã£\tÃ¢Ã¡Ã£Ã¤Ã¤Ã¢Ã¤Ã¥Ã¥Ã¦Ã¦Ã§\bÃ§4Ã¨Ã¬^Ã©Ã­\t\bÃªÃ­7Ã«Ã­q9Ã¬Ã©Ã¬ÃªÃ¬Ã«Ã­6Ã®Ã¯wÃ¯Ã°9Ã°Ã±9Ã±Ã²9Ã²Ã³9Ã³8Ã´Ãµ\t\tÃµ:Ã¶Ã·^Ã·Ã¸0Ã¸<Ã¹Ãº\t\nÃº>Ã»Ã¼\t\vÃ¼@Ã½Ã¾\t\fÃ¾BÃ¿Ä€\t\rÄ€DÄÄ‚\tÄ‚FÄƒÄ„\tÄ„HÄ…Ä†\tÄ†JÄ‡Äˆ\tÄˆLÄ‰ÄŠ\tÄŠNÄ‹ÄŒ\tÄŒPÄÄ\tÄRÄÄ\tÄTÄ‘Ä’\tÄ’VÄ“Ä”\tÄ”XÄ•Ä–\tÄ–ZÄ—Ä˜\tÄ˜\\Ä™Äš\tÄš^Ä›Äœ\tÄœ`ÄÄ\tÄbÄŸÄ \tÄ dÄ¡Ä¢\tÄ¢fÄ£Ä¤\tÄ¤hÄ¥Ä¦\t Ä¦jÄ§Ä¨\t!Ä¨lÄ©Äª\t\"ÄªnÄ«Ä¬\t#Ä¬pÄ­Ä®#Ä®rÂµÂºÃƒÃˆÃŠÃÃ’Ã™Ã›ÃŸÃ¤Ã¬\b";var Vt=i(87949),Bt=i(32915),Ut=i(94609),jt=i(2824),Gt=i(83208),zt=i(4584),Ht=i(3998),Qt=i(44966);class qt extends jt.Parser{constructor(e){super(e),this._interp=new zt.ParserATNSimulator(qt._ATN,this)}get vocabulary(){return qt.VOCABULARY}get grammarFileName(){return"Expression.g4"}get ruleNames(){return qt.ruleNames}get serializedATN(){return qt._serializedATN}expression(){let e=new Zt(this._ctx,this.state);this.enterRule(e,0,qt.RULE_expression);try{this.enterOuterAlt(e,1),this.state=26,this.object(0),this.state=27,this.match(qt.EOF)}catch(t){if(!(t instanceof Ht.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}object(e){void 0===e&&(e=0);let t=this._ctx,i=this.state,n=new Wt(this._ctx,i),a=n;this.enterRecursionRule(n,2,qt.RULE_object,e);try{let e;switch(this.enterOuterAlt(n,1),this.state=38,this._errHandler.sync(this),this._input.LA(1)){case qt.NOT:case qt.NEG:this.state=30,this.negative_expr(),this.state=31,this.object(4);break;case qt.SIMPLETEXT:case qt.STRING:this.state=33,this.expr();break;case qt.T__0:this.state=34,this.match(qt.T__0),this.state=35,this.object(0),this.state=36,this.match(qt.T__1);break;default:throw new Ut.NoViableAltException(this)}for(this._ctx._stop=this._input.tryLT(-1),this.state=46,this._errHandler.sync(this),e=this.interpreter.adaptivePredict(this._input,1,this._ctx);2!==e&&e!==Vt.ATN.INVALID_ALT_NUMBER;){if(1===e){if(null!=this._parseListeners&&this.triggerExitRuleEvent(),a=n,n=new Wt(t,i),this.pushNewRecursionContext(n,2,qt.RULE_object),this.state=40,!this.precpred(this._ctx,1))throw new Bt.FailedPredicateException(this,"this.precpred(this._ctx, 1)");this.state=41,this.logical_operator(),this.state=42,this.object(2)}this.state=48,this._errHandler.sync(this),e=this.interpreter.adaptivePredict(this._input,1,this._ctx)}}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;n.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.unrollRecursionContexts(t)}return n}expr(){let e=new $t(this._ctx,this.state);this.enterRule(e,4,qt.RULE_expr);try{switch(this.state=70,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,2,this._ctx)){case 1:this.enterOuterAlt(e,1),this.state=49,this.key();break;case 2:this.enterOuterAlt(e,2),this.state=50,this.key(),this.state=51,this.boolean_operator(),this.state=52,this.value();break;case 3:this.enterOuterAlt(e,3),this.state=54,this.key(),this.state=55,this.numeric_compare_operator(),this.state=56,this.numerical_value();break;case 4:this.enterOuterAlt(e,4),this.state=58,this.key(),this.state=59,this.string_compare_operator(),this.state=60,this.array();break;case 5:this.enterOuterAlt(e,5),this.state=62,this.key(),this.state=63,this.string_compare_operator(),this.state=64,this.value();break;case 6:this.enterOuterAlt(e,6),this.state=66,this.key(),this.state=67,this.array_operator(),this.state=68,this.array()}}catch(t){if(!(t instanceof Ht.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}logical_operator(){let e,t=new Kt(this._ctx,this.state);this.enterRule(t,6,qt.RULE_logical_operator);try{this.enterOuterAlt(t,1),this.state=72,e=this._input.LA(1),e!==qt.OR&&e!==qt.AND?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}boolean_operator(){let e,t=new Yt(this._ctx,this.state);this.enterRule(t,8,qt.RULE_boolean_operator);try{this.enterOuterAlt(t,1),this.state=74,e=this._input.LA(1),e!==qt.EQUAL&&e!==qt.NOTEQUAL?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}numeric_compare_operator(){let e,t=new Xt(this._ctx,this.state);this.enterRule(t,10,qt.RULE_numeric_compare_operator);try{this.enterOuterAlt(t,1),this.state=76,e=this._input.LA(1),0!=(-32&e)||0==(1<<e&(1<<qt.GT|1<<qt.GTE|1<<qt.LT|1<<qt.LTE))?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}string_compare_operator(){let e,t=new Jt(this._ctx,this.state);this.enterRule(t,12,qt.RULE_string_compare_operator);try{this.enterOuterAlt(t,1),this.state=78,e=this._input.LA(1),e!==qt.CONTAINS&&e!==qt.MATCHES?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}array_operator(){let e,t=new ei(this._ctx,this.state);this.enterRule(t,14,qt.RULE_array_operator);try{this.enterOuterAlt(t,1),this.state=80,e=this._input.LA(1),e!==qt.CONTAINS&&e!==qt.IN?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}array(){let e,t=new ti(this._ctx,this.state);this.enterRule(t,16,qt.RULE_array);try{switch(this.state=95,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,4,this._ctx)){case 1:for(this.enterOuterAlt(t,1),this.state=82,this.match(qt.T__2),this.state=83,this.value(),this.state=88,this._errHandler.sync(this),e=this._input.LA(1);e===qt.T__3;)this.state=84,this.match(qt.T__3),this.state=85,this.value(),this.state=90,this._errHandler.sync(this),e=this._input.LA(1);this.state=91,this.match(qt.T__4);break;case 2:this.enterOuterAlt(t,2),this.state=93,this.match(qt.T__2),this.state=94,this.match(qt.T__4)}}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}numerical_value(){let e,t=new ii(this._ctx,this.state);this.enterRule(t,18,qt.RULE_numerical_value);try{this.enterOuterAlt(t,1),this.state=97,e=this._input.LA(1),e!==qt.QUOTED_NUMBER&&e!==qt.NUMBER?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}value(){let e,t=new ni(this._ctx,this.state);this.enterRule(t,20,qt.RULE_value);try{this.enterOuterAlt(t,1),this.state=99,e=this._input.LA(1),0!=(-32&e)||0==(1<<e&(1<<qt.QUOTED_NUMBER|1<<qt.NUMBER|1<<qt.STRING))?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}negative_expr(){let e,t=new ai(this._ctx,this.state);this.enterRule(t,22,qt.RULE_negative_expr);try{this.enterOuterAlt(t,1),this.state=101,e=this._input.LA(1),e!==qt.NOT&&e!==qt.NEG?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}key(){let e,t=new ri(this._ctx,this.state);this.enterRule(t,24,qt.RULE_key);try{this.enterOuterAlt(t,1),this.state=103,e=this._input.LA(1),e!==qt.SIMPLETEXT&&e!==qt.STRING?this._errHandler.recoverInline(this):(this._input.LA(1)===Qt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof Ht.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}sempred(e,t,i){switch(t){case 1:return this.object_sempred(e,i)}return!0}object_sempred(e,t){switch(t){case 0:return this.precpred(this._ctx,1)}return!0}static get _ATN(){return qt.__ATN||(qt.__ATN=(new At.ATNDeserializer).deserialize(Ft.toCharArray(qt._serializedATN))),qt.__ATN}}qt.T__0=1,qt.T__1=2,qt.T__2=3,qt.T__3=4,qt.T__4=5,qt.OR=6,qt.AND=7,qt.NOT=8,qt.EQUAL=9,qt.NOTEQUAL=10,qt.CONTAINS=11,qt.MATCHES=12,qt.NEG=13,qt.GT=14,qt.GTE=15,qt.LT=16,qt.LTE=17,qt.IN=18,qt.QUOTED_NUMBER=19,qt.NUMBER=20,qt.FLOAT=21,qt.INTEGER=22,qt.SIMPLETEXT=23,qt.STRING=24,qt.WS=25,qt.RULE_expression=0,qt.RULE_object=1,qt.RULE_expr=2,qt.RULE_logical_operator=3,qt.RULE_boolean_operator=4,qt.RULE_numeric_compare_operator=5,qt.RULE_string_compare_operator=6,qt.RULE_array_operator=7,qt.RULE_array=8,qt.RULE_numerical_value=9,qt.RULE_value=10,qt.RULE_negative_expr=11,qt.RULE_key=12,qt.ruleNames=["expression","object","expr","logical_operator","boolean_operator","numeric_compare_operator","string_compare_operator","array_operator","array","numerical_value","value","negative_expr","key"],qt._LITERAL_NAMES=[void 0,"'('","')'","'['","','","']'",void 0,void 0,void 0,"'='","'!='",void 0,void 0,void 0,"'>'","'>='","'<'","'<='"],qt._SYMBOLIC_NAMES=[void 0,void 0,void 0,void 0,void 0,void 0,"OR","AND","NOT","EQUAL","NOTEQUAL","CONTAINS","MATCHES","NEG","GT","GTE","LT","LTE","IN","QUOTED_NUMBER","NUMBER","FLOAT","INTEGER","SIMPLETEXT","STRING","WS"],qt.VOCABULARY=new Dt.VocabularyImpl(qt._LITERAL_NAMES,qt._SYMBOLIC_NAMES,[]),qt._serializedATN="ì¤ìªºÖê¾ºä½“Ø‡îª‹ì‰l\t\t\t\t\t\t\b\t\b\t\t\t\n\t\n\v\t\v\f\t\f\r\t\r\t)\n/\n\f2\vI\n\b\b\t\t\n\n\n\n\nY\n\n\f\n\n\\\v\n\n\n\n\n\nb\n\n\v\v\f\f\r\r\b\n\f\v\b\t\v\f\r\r\r\n\nh(H\bJ\nL\fNPRacegi \b !\r!\"\")#)$%%&&'')((#($)0*+\f+,\b,--/.*/20.011203I4556\n67\f7I899:\f:;\v;I<==>\b>?\n?I@AAB\bBC\fCIDEEF\tFG\nGIH3H4H8H<H@HDIJK\tK\tLM\tM\vNO\tO\rPQ\tQRS\tSTUUZ\fVWWY\fXVY\\ZXZ[[]\\Z]^^b_``baTa_bcd\tdef\t\bfgh\t\thij\t\nj(0HZa";class Zt extends Gt.ParserRuleContext{object(){return this.getRuleContext(0,Wt)}EOF(){return this.getToken(qt.EOF,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_expression}enterRule(e){e.enterExpression&&e.enterExpression(this)}exitRule(e){e.exitExpression&&e.exitExpression(this)}accept(e){return e.visitExpression?e.visitExpression(this):e.visitChildren(this)}}class Wt extends Gt.ParserRuleContext{negative_expr(){return this.tryGetRuleContext(0,ai)}object(e){return void 0===e?this.getRuleContexts(Wt):this.getRuleContext(e,Wt)}expr(){return this.tryGetRuleContext(0,$t)}logical_operator(){return this.tryGetRuleContext(0,Kt)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_object}enterRule(e){e.enterObject&&e.enterObject(this)}exitRule(e){e.exitObject&&e.exitObject(this)}accept(e){return e.visitObject?e.visitObject(this):e.visitChildren(this)}}class $t extends Gt.ParserRuleContext{key(){return this.getRuleContext(0,ri)}boolean_operator(){return this.tryGetRuleContext(0,Yt)}value(){return this.tryGetRuleContext(0,ni)}numeric_compare_operator(){return this.tryGetRuleContext(0,Xt)}numerical_value(){return this.tryGetRuleContext(0,ii)}string_compare_operator(){return this.tryGetRuleContext(0,Jt)}array(){return this.tryGetRuleContext(0,ti)}array_operator(){return this.tryGetRuleContext(0,ei)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_expr}enterRule(e){e.enterExpr&&e.enterExpr(this)}exitRule(e){e.exitExpr&&e.exitExpr(this)}accept(e){return e.visitExpr?e.visitExpr(this):e.visitChildren(this)}}class Kt extends Gt.ParserRuleContext{AND(){return this.tryGetToken(qt.AND,0)}OR(){return this.tryGetToken(qt.OR,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_logical_operator}enterRule(e){e.enterLogical_operator&&e.enterLogical_operator(this)}exitRule(e){e.exitLogical_operator&&e.exitLogical_operator(this)}accept(e){return e.visitLogical_operator?e.visitLogical_operator(this):e.visitChildren(this)}}class Yt extends Gt.ParserRuleContext{EQUAL(){return this.tryGetToken(qt.EQUAL,0)}NOTEQUAL(){return this.tryGetToken(qt.NOTEQUAL,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_boolean_operator}enterRule(e){e.enterBoolean_operator&&e.enterBoolean_operator(this)}exitRule(e){e.exitBoolean_operator&&e.exitBoolean_operator(this)}accept(e){return e.visitBoolean_operator?e.visitBoolean_operator(this):e.visitChildren(this)}}class Xt extends Gt.ParserRuleContext{GT(){return this.tryGetToken(qt.GT,0)}GTE(){return this.tryGetToken(qt.GTE,0)}LT(){return this.tryGetToken(qt.LT,0)}LTE(){return this.tryGetToken(qt.LTE,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_numeric_compare_operator}enterRule(e){e.enterNumeric_compare_operator&&e.enterNumeric_compare_operator(this)}exitRule(e){e.exitNumeric_compare_operator&&e.exitNumeric_compare_operator(this)}accept(e){return e.visitNumeric_compare_operator?e.visitNumeric_compare_operator(this):e.visitChildren(this)}}class Jt extends Gt.ParserRuleContext{CONTAINS(){return this.tryGetToken(qt.CONTAINS,0)}MATCHES(){return this.tryGetToken(qt.MATCHES,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_string_compare_operator}enterRule(e){e.enterString_compare_operator&&e.enterString_compare_operator(this)}exitRule(e){e.exitString_compare_operator&&e.exitString_compare_operator(this)}accept(e){return e.visitString_compare_operator?e.visitString_compare_operator(this):e.visitChildren(this)}}class ei extends Gt.ParserRuleContext{IN(){return this.tryGetToken(qt.IN,0)}CONTAINS(){return this.tryGetToken(qt.CONTAINS,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_array_operator}enterRule(e){e.enterArray_operator&&e.enterArray_operator(this)}exitRule(e){e.exitArray_operator&&e.exitArray_operator(this)}accept(e){return e.visitArray_operator?e.visitArray_operator(this):e.visitChildren(this)}}class ti extends Gt.ParserRuleContext{value(e){return void 0===e?this.getRuleContexts(ni):this.getRuleContext(e,ni)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_array}enterRule(e){e.enterArray&&e.enterArray(this)}exitRule(e){e.exitArray&&e.exitArray(this)}accept(e){return e.visitArray?e.visitArray(this):e.visitChildren(this)}}class ii extends Gt.ParserRuleContext{NUMBER(){return this.tryGetToken(qt.NUMBER,0)}QUOTED_NUMBER(){return this.tryGetToken(qt.QUOTED_NUMBER,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_numerical_value}enterRule(e){e.enterNumerical_value&&e.enterNumerical_value(this)}exitRule(e){e.exitNumerical_value&&e.exitNumerical_value(this)}accept(e){return e.visitNumerical_value?e.visitNumerical_value(this):e.visitChildren(this)}}class ni extends Gt.ParserRuleContext{NUMBER(){return this.tryGetToken(qt.NUMBER,0)}QUOTED_NUMBER(){return this.tryGetToken(qt.QUOTED_NUMBER,0)}STRING(){return this.tryGetToken(qt.STRING,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_value}enterRule(e){e.enterValue&&e.enterValue(this)}exitRule(e){e.exitValue&&e.exitValue(this)}accept(e){return e.visitValue?e.visitValue(this):e.visitChildren(this)}}class ai extends Gt.ParserRuleContext{NEG(){return this.tryGetToken(qt.NEG,0)}NOT(){return this.tryGetToken(qt.NOT,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_negative_expr}enterRule(e){e.enterNegative_expr&&e.enterNegative_expr(this)}exitRule(e){e.exitNegative_expr&&e.exitNegative_expr(this)}accept(e){return e.visitNegative_expr?e.visitNegative_expr(this):e.visitChildren(this)}}class ri extends Gt.ParserRuleContext{SIMPLETEXT(){return this.tryGetToken(qt.SIMPLETEXT,0)}STRING(){return this.tryGetToken(qt.STRING,0)}constructor(e,t){super(e,t)}get ruleIndex(){return qt.RULE_key}enterRule(e){e.enterKey&&e.enterKey(this)}exitRule(e){e.exitKey&&e.exitKey(this)}accept(e){return e.visitKey?e.visitKey(this):e.visitChildren(this)}}var oi,li=i(15822);!function(e){e.FACT="FACT",e.VALUE="VALUE",e.LOGICAL_OPERATOR="LOGICAL_OPERATOR",e.BOOLEAN_OPERATOR="BOOLEAN_OPERATOR",e.NUMERIC_COMPARE_OPERATOR="NUMERIC_COMPARE_OPERATOR",e.OPEN_ROUND_BRACKET="OPEN_ROUND_BRACKET",e.CLOSE_ROUND_BRACKET="CLOSE_ROUND_BRACKET",e.UNKNOWN="UNKNOWN",e.ERROR="ERROR"}(oi||(oi={}));const si=e=>({type:oi.FACT,value:e}),ci=e=>({type:oi.VALUE,value:e}),di=e=>({type:oi.CLOSE_ROUND_BRACKET,value:e}),ui=e=>({type:oi.UNKNOWN,value:e});class pi extends li.AbstractParseTreeVisitor{defaultResult(){return[]}aggregateResult(e,t){const i=0===(n=e.filter((e=>e.type!==oi.ERROR))).length?void 0:n[n.length-1];var n;const a=(e=>0===e.length?void 0:e[0])(t.filter((e=>e.type!==oi.ERROR)));return i&&a&&i.type===oi.LOGICAL_OPERATOR&&a.type===oi.LOGICAL_OPERATOR&&(a.type=oi.ERROR),[...e,...t]}visitTerminal(e){return e.symbol.type===wt.Token.EOF?[]:"("===e.text?[("(",{type:oi.OPEN_ROUND_BRACKET,value:"("})]:")"===e.text?[di(")")]:[ui(e.text)]}visitErrorNode(e){return"<missing ')'>"===e.text?[di(")")]:[(t=e.text,{type:oi.ERROR,value:t})];var t}visitLogical_operator(e){return[(t=e.text,{type:oi.LOGICAL_OPERATOR,value:t})];var t}visitBoolean_operator(e){return[(t=e.text,{type:oi.BOOLEAN_OPERATOR,value:t})];var t}visitNumeric_compare_operator(e){return[(t=e.text,{type:oi.NUMERIC_COMPARE_OPERATOR,value:t})];var t}visitKey(e){var t;const i=e.SIMPLETEXT();if(i)return[si(i.text)];const n=null===(t=e.STRING())||void 0===t?void 0:t.text;return n&&n.length>=2?[si(n.substr(1,n.length-2))]:[si("")]}visitValue(e){const t=e.NUMBER()||e.STRING();if(!t){if(e.parent instanceof $t||e.parent,e.text)return e.childCount>1&&e.start.inputStream&&e.stop?[ci(`"${e.start.inputStream.toString().slice(e.start.startIndex,e.stop.stopIndex+1)}"`)]:[ci(`"${e.text}"`)];if(e.start.inputStream&&e.stop&&e.stop.text){let t=e.start.inputStream.toString().slice(e.stop.stopIndex+1,e.start.startIndex).trimLeft();return t.startsWith('"')&&!t.endsWith('"')?t+='"':t.startsWith("'")&&!t.endsWith("'")&&(t+="'"),[ci(t)]}return this.visitChildren(e)}return[ci(t.text)]}visitNumerical_value(e){return[ci(e.text)]}}const mi=e=>e.map((e=>e.value)).join(" "),gi=(0,u.style)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),yi=(e,t)=>{try{const o=((e,t)=>{const i=(e=>{const t=wt.CharStreams.fromString(e),i=new Mt(t);i.removeErrorListeners();const n=new wt.CommonTokenStream(i),a=new qt(n);return a.removeErrorListeners(),a})(e).expression(),n=(new pi).visit(i).filter((e=>e.type!==oi.ERROR));let a=n.pop();const r=[];if(void 0===a)return{prefix:"",options:t.slice(0,10).map((e=>e.name||"")),postfix:""};for(;a.type===oi.CLOSE_ROUND_BRACKET;){const e=n.pop();if(void 0===e)break;r.unshift(a),a=e}const o=mi(n),l=mi(r),s=a;return s.type===oi.FACT?{prefix:o,options:t.filter((e=>e.name&&e.name.toUpperCase().includes(s.value.toUpperCase()))).slice(0,10).map((e=>e.name||"")),postfix:l}:(r.unshift(s),{prefix:o,options:[],postfix:mi(r)})})(e,t);if(o)return i=o.prefix,n=o.options,a=o.postfix,(i=i.trim()).length>0&&n.length>0&&(i+=" "),a.length>0&&n.length>0&&(a=" "+a),(n||[" "]).map((e=>r.createElement(s.SelectOption,{className:gi,key:i+e+a,value:i+e+a},i,r.createElement("b",null,e),a)))}catch(t){console.log(`Exception when computing options for condition [${e}]`,t)}var i,n,a;return[]},hi=e=>{const{facts:t,onSelect:i,value:n}=e,[a,o]=r.useState(!1),[l,c]=r.useState(),d=r.useCallback((e=>yi(e,t)),[t]),u=r.useCallback((e=>{var t,i;const a=d(n);if(e){let e=a.length>0;1===a.length&&(null===(i=null===(t=a[0])||void 0===t?void 0:t.props)||void 0===i?void 0:i.value)===n&&(e=!1),o(e)}c(a)}),[n,d,c]);(0,It.Z)((()=>{u(!0)}),[u]),(0,Rt.Z)((()=>{u(!1)}));const m=r.useCallback(((e,t)=>{e&&i(t)}),[i]),g=r.useCallback(((e,t)=>{i(t.toString()),c((e=>(e&&1===e.length&&e[0].props.value===t&&o(!1),e)))}),[i]),y=r.useCallback((()=>{i("")}),[i]),h=r.useCallback((e=>{o(e)}),[]);return r.createElement(s.Select,Object.assign({},p("ConditionField",e),{label:e.label,toggleId:e.id,name:e.name,onToggle:h,isOpen:a,selections:n,variant:s.SelectVariant.typeahead,onSelect:g,onFilter:m,onClear:y,typeAheadAriaLabel:"Condition writer",style:{maxWidth:"100%"}}),l)};const Ei=e=>{const{hint:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}(e,["hint"]),[n,a,{setValue:o}]=(0,Xe.useField)(Object.assign({},i)),l=!a.error||!a.touched,c=r.useCallback((e=>{o(e)}),[o]);return r.createElement(s.FormGroup,{fieldId:e.id,helperTextInvalid:a.error,isRequired:e.isRequired,validated:l?"default":"error",label:e.label},r.createElement(hi,Object.assign({},i,n,{value:n.value?n.value.toString():"",onSelect:c})),t&&r.createElement(s.Text,{component:s.TextVariants.small},t))},vi=(0,u.style)({fontFamily:"monospace",fontSize:"14px",fontStyle:"default"}),bi=(0,u.style)({marginBottom:5}),fi=(0,u.style)({marginLeft:20});class _i extends r.Component{render(){return r.createElement(s.TextContent,{className:fi},r.createElement(s.Text,{component:s.TextVariants.p},h.wizards.policy.hints.hintParagraph1),r.createElement(s.Text,{component:s.TextVariants.a,className:bi,href:Te.pages.factsDocumentation,target:"_blank",rel:"noopener noreferrer"},h.wizards.policy.hints.hintLinkTitle),r.createElement(s.Text,{component:s.TextVariants.h5,className:"lg"},h.wizards.policy.hints.hintSyntaxExamplesSection),r.createElement(s.Text,null,h.wizards.policy.hints.hintQuestion1),r.createElement(s.Text,{component:s.TextVariants.p,className:vi},r.createElement("i",null,h.wizards.policy.hints.hintQuestion1Ans)),r.createElement(s.Text,null,h.wizards.policy.hints.hintQuestion2),r.createElement(s.Text,{component:s.TextVariants.p,className:vi},r.createElement("i",null,h.wizards.policy.hints.hintQuestion2Ans)),r.createElement(s.Text,null,h.wizards.policy.hints.hintQuestion3),r.createElement(s.Text,{component:s.TextVariants.p,className:vi},r.createElement("i",null,h.wizards.policy.hints.hintQuestion3Ans)),r.createElement(s.Text,null,h.wizards.policy.hints.hintQuestion4),r.createElement(s.Text,{component:s.TextVariants.p,className:vi},r.createElement("i",null,h.wizards.policy.hints.hintQuestion4Ans)))}}const Ti=e=>r.createElement(r.Fragment,null,r.createElement(s.StackItem,Object.assign({},p("Policy/Wizard/Usage",e)),r.createElement(s.ExpandableSection,{toggleText:h.wizards.policy.hints.hintTitle},r.createElement(_i,null)))),Ci=(0,u.style)({marginTop:"auto",marginBottom:"auto",marginLeft:8}),Pi=(0,u.style)({width:"100%"}),Si=(0,u.style)({marginTop:12}),xi=(0,u.style)({color:ct.ZP.var}),Oi=(0,u.style)({color:Nt.ZP.var}),Ni=(0,u.style)({fontWeight:"bold"}),Ii=(0,u.style)({marginBottom:5}),Ri=e=>e.loading?r.createElement(s.Split,null,r.createElement(s.SplitItem,null,r.createElement("span",{className:Ci},r.createElement(s.Spinner,{size:"md"})),r.createElement("span",{className:Ci}," ",h.wizards.policy.conditions.validating," "))):e.changed?null:e.isValid?r.createElement(s.Split,null,r.createElement(s.SplitItem,null,r.createElement(w.ZP,{className:Ci,color:Nt.ZP.value})),r.createElement(s.SplitItem,null,r.createElement("div",{className:(0,a.joinClasses)(Ci,Oi,Ni)},h.wizards.policy.conditions.valid))):e.error?r.createElement(s.Stack,null,r.createElement(s.StackItem,null,r.createElement(s.Split,null,r.createElement(s.SplitItem,null,r.createElement(st.ZP,{className:Ci,color:ct.ZP.value})),r.createElement(s.SplitItem,null,r.createElement("div",{className:(0,a.joinClasses)(Ci,xi,Ni)},h.wizards.policy.conditions.invalid)))),r.createElement(s.StackItem,null,r.createElement("div",{className:(0,a.joinClasses)(Ci,xi)}," ",e.error," "))):null,wi=()=>{var e;const t=r.useContext(dt),{values:i}=(0,Xe.useFormikContext)(),n=!i.conditions||""===i.conditions||t.isLoading;return r.createElement(a.Form,{ouiaId:"condition-step"},r.createElement(s.Title,{className:Ii,headingLevel:"h4",size:"xl"},h.wizards.policy.conditions.title),h.wizards.policy.conditions.summaryDesc,r.createElement(Ei,{ouiaId:"conditions",label:"Condition text",id:"conditions",name:"conditions",facts:t.facts||[],hint:h.wizards.policy.conditions.hint}),r.createElement(s.Stack,{className:Pi},r.createElement(s.StackItem,null,r.createElement(s.Button,{onClick:()=>{t.triggerAction(lt.VALIDATE_CONDITION)},isDisabled:n,variant:s.ButtonVariant.secondary},"Validate condition")),r.createElement(s.StackItem,{className:Si},r.createElement(Ri,Object.assign({loading:t.isLoading},t.verifyResponse,{changed:(null===(e=t.verifyResponse.policy)||void 0===e?void 0:e.conditions)!==i.conditions})))),r.createElement(Ti,null))},Ai=r.createContext(void 0),ki=e=>{var t;const[i,n]=r.useState(!1),[o,l]=r.useState({}),s=xe(void 0,!1),c=(0,a.useSort)(),d=Oe(s.debouncedFilters,5,c.sortBy),u=Ze(d.page,!1);let p,m=0;"PagedResponseOfPolicy"===(null===(t=u.payload)||void 0===t?void 0:t.type)&&(p=u.payload.value.data,m=u.payload.value.count);const g=Me(p,u.loading,m,d.page),{query:y}=u;return(0,It.Z)((()=>{e.showCreateStep&&y()}),[y,d.page,s.debouncedFilters,e.showCreateStep]),e.showCreateStep?r.createElement(Ai.Provider,{value:{copyPolicy:i,setCopyPolicy:n,copiedPolicy:o,setCopiedPolicy:l,policyFilter:s,policyPage:d,policySort:c,policyQuery:u,policyRows:g}},e.children):r.createElement(r.Fragment,null,e.children)},Li=e=>{var t;const{policyFilter:i,policyPage:n,policySort:a,policyQuery:o,policyRows:l}=e;(0,Rt.Z)((()=>{o.payload||o.query()}));const s=e.onSelect,c=o.payload,d=l.onSelect,u=r.useCallback(((e,t,i)=>{d(e,t,i),c&&"PagedResponseOfPolicy"===c.type&&i&&s(c.value.data[t])}),[s,d,c]),{pageCount:p,count:m}="PagedResponseOfPolicy"===(null===(t=o.payload)||void 0===t?void 0:t.type)?{count:o.payload.value.count,pageCount:o.payload.value.data.length}:{count:void 0,pageCount:void 0};return r.createElement(r.Fragment,null,r.createElement(fe,{ouiaId:"copy-from-policy-toolbar",onPaginationChanged:n.changePage,page:n.page.index,pageCount:p,perPage:n.page.size,showPerPageOptions:!1,hideActions:!0,hideBulkSelect:!0,filters:i.filters,setFilters:i.setFilters,clearFilters:i.clearFilter,count:m},r.createElement(ye,{ouiaId:"copy-from-policy-table",columnsToShow:["radioSelect","name","actions"],policies:l.rows,onSelect:u,loading:o.loading,loadingRowCount:5,onSort:a.onSort,sortBy:a.sortBy,linkToDetailPolicy:!1})))};const Di="pf-u-mb-sm",Fi="pf-c-radio",Mi=()=>{const{copyPolicy:e,createFromScratch:t,copyExisting:i,copyFromPolicyHandler:n,copyFromPolicyProps:o}=(()=>{const e=r.useContext(Ai);if(void 0===e)throw Error("Invalid usage of CreatePolicyStep without valid context");const{copyPolicy:t,setCopyPolicy:i,copiedPolicy:n,setCopiedPolicy:a}=e,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}(e,["copyPolicy","setCopyPolicy","copiedPolicy","setCopiedPolicy"]),{clearSelection:l}=o.policyRows,{validate:s,validateField:c,setValues:d,setFieldValue:u}=(0,Xe.useFormikContext)(),{setVerifyResponse:p,setMaxStep:m}=(0,r.useContext)(dt),g=r.useCallback((()=>{i(!1),a({})}),[i,a]),y=r.useCallback((()=>{i(!0),a(void 0)}),[i,a]);(0,It.Z)((()=>{n&&(d(n),t&&p({policy:n,isValid:!0})),m(0),u("isValid",!!n),s&&c("isValid")}),[t,n,s,c,u,d,p]),r.useEffect((()=>{t||l()}),[t,l]);const h=r.useCallback((e=>{a(Qe(e))}),[a]);return{copyPolicy:t,createFromScratch:g,copyExisting:y,copyFromPolicyHandler:h,copyFromPolicyProps:o}})();return r.createElement(r.Fragment,null,r.createElement(a.Form,{ouiaId:"create-policy-step",className:"pf-c-form"},r.createElement("div",{className:"pf-c-form__group"},r.createElement(s.Title,{headingLevel:"h4",size:"xl",className:Di},h.wizards.policy.createPolicy.title),r.createElement(s.Text,{className:(0,a.joinClasses)(Di,"pf-c-title pf-m-sm"),component:s.TextVariants.h6},"Define a new policy:"),r.createElement(s.Radio,{isChecked:!e,name:"new-policy",value:"from-scratch",id:"create-new-custom-policy-from-scratch",onChange:t,label:"From scratch",className:(0,a.joinClasses)(Di,Fi)}),r.createElement(s.Radio,{isChecked:e,name:"new-policy",value:"as-copy",id:"create-new-custom-policy-as-copy",onChange:i,label:"As a copy of existing Policy",className:(0,a.joinClasses)(Di,Fi)}),e&&r.createElement(r.Fragment,null,r.createElement(Li,Object.assign({onSelect:n},o))))))},Vi=()=>r.createElement(a.Form,{ouiaId:"detail-step"},r.createElement(s.Title,{headingLevel:"h4",size:"xl"},h.wizards.policy.details.title),r.createElement(a.FormTextInput,{ouiaId:"name",maxLength:150,isRequired:!0,label:"Name",type:"text",name:"name",id:"name"}),r.createElement(a.FormTextArea,{ouiaId:"description",label:"Description",type:"text",id:"description",name:"description",resizeOrientation:"vertical"})),Bi=(0,u.style)(Object.assign(Object.assign({backgroundColor:G.ZP.var},(0,z.padding)(18,14)),{margin:5})),Ui=()=>{const e=(0,r.useContext)(dt),{values:t}=(0,Xe.useFormikContext)();return r.createElement(r.Fragment,null,r.createElement(a.Form,{ouiaId:"review-step"},r.createElement(s.Title,{headingLevel:"h2",size:"xl"},h.wizards.policy.review.title),r.createElement(a.Switch,{ouiaId:"is-enabled",isDisabled:e.isLoading,id:"isEnabled",name:"isEnabled",labelOn:h.wizards.policy.review.policyIsEnabled,labelOff:h.wizards.policy.review.policyIsDisabled,label:h.wizards.policy.review.enableThisPolicy}),r.createElement(s.Title,{headingLevel:"h2",size:"md"},h.wizards.policy.review.policy.details),r.createElement(a.FormText,{ouiaId:"name",label:h.wizards.policy.review.policy.name,name:"name",id:"name"}),r.createElement(a.FormText,{ouiaId:"description",label:h.wizards.policy.review.policy.description,name:"description",id:"description"}),r.createElement("div",{className:Bi},r.createElement(Y,{ouiaId:"review-step.conditions",conditions:t.conditions})),r.createElement("div",{className:Bi},r.createElement($,{ouiaId:"review-step.actions",actions:t.actions||[]}))))},ji=(e,t,i,n,a)=>!a&&(e===i||(t?e<=n:e<=i)),Gi=(e,t)=>!t&&e,zi=e=>{const t=(0,Xe.useFormikContext)(),i=t.validateForm,n=t.handleSubmit;r.useEffect((()=>{i()}),[e.currentStep,i]),r.useEffect((()=>{e.triggeredAction!==lt.NONE&&n()}),[e.triggeredAction,n]);const a={isLoading:e.isLoading,isFormValid:t.isValid,triggerAction:e.triggerAction,verifyResponse:e.verifyResponse,createResponse:e.createResponse,setVerifyResponse:e.setVerifyResponse,facts:e.facts,setMaxStep:e.setMaxStep},o=e.steps[e.currentStep],l=((e,t,i)=>e.isValid?e.isValid(t,i):t.isFormValid)(o,a,t.values);a.isValid=l;const c=e.steps.map((t=>Object.assign(Object.assign({},t),{enableNext:Gi(l,e.isLoading),canJumpTo:ji(t.id,l,e.currentStep,e.maxStep,e.isLoading)})));return r.createElement(s.Form,null,r.createElement(dt.Provider,{value:a},r.createElement(s.Wizard,{isOpen:!0,onSave:()=>{e.triggerAction(lt.SAVE)},onClose:e.onClose,steps:c,startAtStep:e.currentStep+1,onNext:e.onMove,onBack:e.onMove,onGoToStep:e.onMove,title:e.isEditing?h.wizards.policy.titleEdit:h.wizards.policy.titleNew,description:h.wizards.policy.description,footer:r.createElement(mt,{onNext:o.onNext,loadingText:"Loading",isLoading:e.isLoading,error:e.createResponse.error})})))},Hi=e=>{const[t,i]=r.useState(0),[n,a]=r.useState(0),[o,l]=r.useState({type:lt.NONE}),[s,c]=r.useState({isValid:!1}),d=(0,Je.Z)(),[u,p]=r.useState({created:!1}),m=r.useCallback((e=>{let t,i;const n=new Promise(((e,n)=>{t=e,i=n}));return l((n=>(n.rejecter&&n.rejecter(),{type:e,resolver:t,rejecter:i}))),n}),[l]),g=r.useCallback((e=>{l((t=>(e&&t.resolver?t.resolver():t.rejecter&&t.rejecter(),{type:lt.NONE})))}),[l]);r.useEffect((()=>{var t;(null===(t=e.initialValue)||void 0===t?void 0:t.conditions)&&c({isValid:!0,policy:e.initialValue})}),[e.initialValue]);const y=(e=>{const t=[];return e&&t.push(Object.assign({name:h.wizards.policy.createPolicy.title,component:r.createElement(Mi,null),validationSchema:et.Ry().shape({isValid:et.O7().oneOf([!0])})},void 0)),t.push(Object.assign({name:h.wizards.policy.details.title,component:r.createElement(Vi,null),validationSchema:nt,onNext:(e,t)=>{e.triggerAction(lt.VALIDATE_NAME).then(t).catch((e=>{console.error("Error when validating:",e)}))}},void 0),Object.assign({name:h.wizards.policy.conditions.title,component:r.createElement(wi,null),validationSchema:rt,isValid:(e,t)=>{var i;return t.conditions===(null===(i=e.verifyResponse.policy)||void 0===i?void 0:i.conditions)&&e.verifyResponse.isValid}},void 0),Object.assign({name:h.wizards.policy.actions.title,component:r.createElement(Ot,null),validationSchema:at},void 0),Object.assign({name:h.wizards.policy.review.title,component:r.createElement(Ui,null),validationSchema:ot},{nextButtonText:"Finish"})),t.map(((e,t)=>Object.assign(Object.assign({},e),{id:t})))})(e.showCreateStep);return r.createElement(r.Fragment,null,r.createElement(ki,{showCreateStep:e.showCreateStep},r.createElement(Xe.Formik,{initialValues:e.initialValue,initialStatus:{},validateOnMount:!1,validationSchema:y[t].validationSchema,onSubmit:(t,i)=>{i.setSubmitting(!1),l((e=>Object.assign(Object.assign({},e),{type:lt.NONE})));const n=ot.cast(t);switch(i.setValues(n),o.type){case lt.SAVE:e.onSave(n).then((e=>{d()&&(p(e),g(e.created))}));break;case lt.VALIDATE_CONDITION:case lt.NONE:case lt.VALIDATE_NAME:break;default:(0,O.vE)(o.type)}},validate:t=>{const i=ot.cast(t);switch(o.type){case lt.SAVE:case lt.NONE:break;case lt.VALIDATE_CONDITION:e.onVerify(i).then((e=>{c(e),g(e.isValid)}));break;case lt.VALIDATE_NAME:e.onValidateName(i).then((e=>{p(e),g(!e.error)}));break;default:(0,O.vE)(o.type)}}},r.createElement(zi,{currentStep:t,maxStep:n,isLoading:e.isLoading,triggeredAction:o.type,triggerAction:m,steps:y,verifyResponse:s,createResponse:u,setVerifyResponse:c,onClose:e.onClose,onMove:(e,t)=>{const r=e.id;i(r),r>n&&a(r)},showCreateStep:e.showCreateStep,facts:e.facts,setMaxStep:a,isEditing:e.isEditing}))))},Qi=Ie.GetFacts.actionCreator,qi=e=>e.id?Ie.PutPoliciesByPolicyId.actionCreator({policyId:e.id,body:ze(e)}):Ie.PostPolicies.actionCreator({alsoStore:!0,body:ze(e)}),Zi=(0,we.validationResponseTransformer)((e=>"Policy"===e.type?(0,we.validatedResponse)("Policy",e.status,He(e.value),e.errors):e)),Wi=e=>{var t;return Ie.PostPoliciesValidateName.actionCreator({body:null!==(t=e.name)&&void 0!==t?t:"",id:e.id})},$i=e=>Ie.PostPoliciesValidate.actionCreator({body:ze(e)}),Ki=e=>{const t=(0,a.useTransformQueryResponse)((0,Re.useMutation)(qi),Zi),i=(0,Re.useMutation)($i),n=(0,Re.useParameterizedQuery)(Wi),o=(()=>{const[e,t]=(0,r.useState)(),{payload:i}=(0,Re.useQuery)(Qi(),!0);return(0,r.useEffect)((()=>{200===(null==i?void 0:i.status)&&t(i.value)}),[i,t]),e})(),l=r.useCallback((e=>(0,n.query)(e).then((e=>{var t;if(e.status===Ye.OK)return{created:!1};if(e.status===Ye.vS)return{created:!1,error:"This policy name already exists. Please input a unique policy name."};const i=(null===(t=e.payload)||void 0===t?void 0:t.value).msg;return i?{created:!1,error:i}:{created:!1,error:`Invalid name found (Code: ${e.status})`}}))),[n.query]),s=t.loading||i.loading||n.loading;return r.createElement(r.Fragment,null,e.isOpen&&r.createElement(Hi,{initialValue:e.initialValue||{},onClose:()=>{e.close(void 0)},onSave:i=>t.mutate(i).then((t=>{var n,o,l;if("Policy"===(null===(n=t.payload)||void 0===n?void 0:n.type))return void 0===i.id?(0,a.addSuccessNotification)(`Created policy "${i.name}"`,r.createElement("span",null," From the Policies list, open",r.createElement(N.Link,{to:Zn.policyDetail(t.payload.value.id)},i.name),".")):(0,a.addSuccessNotification)("Saved",`Updated policy "${i.name}"`),e.close&&e.close(t.payload.value),{created:!0};if(t.status===Ye.Hi&&void 0!==i.id)return{created:!1,error:"This policy cannot be found. It may have been deleted by another user. Your changes cannot be saved."};let s=`Unknown Error when trying to ${void 0===i.id?"create":"update"} the policy: (Code ${t.status})`;return"Msg"===(null===(o=t.payload)||void 0===o?void 0:o.type)&&(s=null!==(l=t.payload.value.msg)&&void 0!==l?l:s),{created:!1,error:s}})),onVerify:e=>i.mutate(e).then((t=>{var i;return t.status===Ye.OK?{isValid:!0,policy:e}:"Msg"===(null===(i=t.payload)||void 0===i?void 0:i.type)&&t.payload.value.msg?{isValid:!1,error:t.payload.value.msg,policy:e}:{isValid:!1,error:`Unknown Error when trying to validate: (Code ${t.status})`,policy:e}})),onValidateName:l,showCreateStep:!!e.policiesExist&&e.showCreateStep,isLoading:s,facts:o,isEditing:e.isEditing}))};const Yi=e=>{const t=r.useCallback((()=>{return t=void 0,i=void 0,r=function*(){const t=e.policy,i=e.onDelete,n=e.getPolicies;if(t)return i([t.id]);if(!n)throw new Error("Expected policy or getPolicies to bet set");try{return i(yield n())}catch(e){(0,a.addDangerNotification)("Error while removing","An error occurreds while trying to remove the selection, please try again."),console.error("Error while fetching selection",e)}return!1},new((n=void 0)||(n=Promise))((function(e,a){function o(e){try{s(r.next(e))}catch(e){a(e)}}function l(e){try{s(r.throw(e))}catch(e){a(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,l)}s((r=r.apply(t,i||[])).next())}));var t,i,n,r}),[e.onDelete,e.policy,e.getPolicies]),i=r.useMemo((()=>e.policy?r.createElement(r.Fragment,null,"Do you want to remove the policy ",r.createElement("b",null,e.policy.name),"?"):1===e.count?r.createElement(r.Fragment,null,"Do you want to remove the selected policy?"):r.createElement(r.Fragment,null,"Do you want to remove the ",r.createElement("b",null,e.count)," selected policies?")),[e.policy,e.count]);return e.policy||e.getPolicies?r.createElement(a.DeleteModal,{isOpen:!0,isDeleting:e.isDeleting,title:"Remove "+(1===e.count?"policy":"policies"),content:i,onClose:e.onClose,onDelete:t,error:e.error}):null},Xi=e=>Ie.DeletePoliciesIds.actionCreator({body:e}),Ji=e=>{const{onDeleted:t}=e,{mutate:i,loading:n}=(0,Re.useMutation)(Xi),o=n||e.loading,l=r.useCallback((e=>i(e).then((i=>{var n;let r=e.length;if(200===(null===(n=i.payload)||void 0===n?void 0:n.status)){const n=i.payload.value;r=e.filter((e=>!n.includes(e))).length,i.payload.value.forEach((e=>t&&t(e)))}return r>0&&(1===r?(0,a.addDangerNotification)("Error removing policy","There was an error when trying to remove a policy."):(0,a.addDangerNotification)("Error removing policies",`There was an error when trying to remove ${r} policies.`)),r!==e.length}))),[i,t]);return r.createElement(Yi,{policy:e.policy,count:e.count,getPolicies:e.getPolicies,isDeleting:o,onClose:e.onClose,onDelete:l})};var en=i(96733);const tn=()=>r.createElement("br",null),nn=e=>r.createElement(g,{icon:en.ZP,title:h.pages.listPage.emptyState.title,content:(0,a.join)(h.pages.listPage.emptyState.text,tn),action:e.createPolicy,actionLabel:"Create policy"});var an=i(89836),rn=i.n(an);class on extends a.ExporterCsv{serialize(e){return Object.assign(Object.assign({},e),{actions:je(e.actions)})}headers(){return[["id","id"],["name","name"],["description","description"],["isEnabled","isEnabled"],["conditions","conditions"],["actions","actions"],["lastTriggered","lastTriggered"],["mtime","mtime"],["ctime","ctime"]]}}class ln extends a.ExporterJson{}var sn=i(24094);const cn=(0,u.style)({paddingBottom:0}),dn=e=>Ie.GetPoliciesById.actionCreator({id:e}),un=(0,we.validationResponseTransformer)((e=>"Policy"===e.type?(0,we.validatedResponse)("Policy",e.status,He(e.value),e.errors):e)),pn=e=>{const[t,i]=r.useState(!1),n=r.useCallback((()=>{i(!1)}),[]),a=r.useMemo((()=>{const t=e.changeEnabled,i=[];return e.isEnabled?i.push(r.createElement(s.DropdownItem,{isDisabled:e.loadingEnabledChange,onClick:()=>t(!1),key:"disable"},"Disable")):i.push(r.createElement(s.DropdownItem,{isDisabled:e.loadingEnabledChange,onClick:()=>t(!0),key:"enable"},"Enable")),i.push(r.createElement(s.DropdownItem,{key:"edit",onClick:e.edit},"Edit"),r.createElement(s.DropdownItem,{key:"duplicate",onClick:e.duplicate},"Duplicate"),r.createElement(s.DropdownItem,{key:"delete",onClick:e.delete},"Remove")),i}),[e.isEnabled,e.changeEnabled,e.edit,e.duplicate,e.delete,e.loadingEnabledChange]);return r.createElement(s.Dropdown,{position:s.DropdownPosition.right,onSelect:n,toggle:r.createElement(s.KebabToggle,{"data-testid":"policy-detail-actions-button",isDisabled:e.disabled,onToggle:i,id:"policy-detail-actions-menu"}),isOpen:t,isPlain:!0,dropdownItems:a})};var mn=i(16730);const gn=e=>{const t=(0,v.k6)(),i=r.useCallback((()=>{t.push(Zn.listPage())}),[t]);return r.createElement(g,{icon:mn.ZP,title:h.pages.policyDetail.emptyState.title,content:(0,ht.WU)(h.pages.policyDetail.emptyState.text,e.policyId),actionLabel:h.pages.policyDetail.emptyState.backText,action:i})},yn=(e,t,i="br")=>r.useMemo((()=>{const n=(0,ht.WU)(e,...t);return i?(0,a.join)(n.split("\n"),i):n}),[i,...t]),hn=e=>{const t=yn(h.pages.policyDetail.errorState.text,[e.error]);return r.createElement(g,{icon:st.ZP,iconColor:ct.ZP.value,title:h.pages.policyDetail.errorState.title,content:t,action:e.action,actionLabel:h.pages.policyDetail.errorState.actionText})};var En,vn=i(3644);!function(e){e[e.EDIT=0]="EDIT",e[e.DUPLICATE=1]="DUPLICATE",e[e.CLOSE=2]="CLOSE"}(En||(En={}));const bn={isEditing:!1,initialValue:void 0,isOpen:!1},fn=(0,u.style)({marginLeft:yt.ZP.var}),_n=e=>{if(e.loading)return r.createElement(s.Stack,{"data-testid":"loading"},r.createElement(s.StackItem,null,r.createElement(s.Skeleton,{width:"140px"})));const{icon:t,text:i}=e.isEnabled?{icon:r.createElement(A,null),text:"Enabled"}:{icon:r.createElement(R,null),text:"Disabled"};return r.createElement(s.Stack,null,r.createElement(s.StackItem,null,t,r.createElement("span",{className:fn},i)))};var Tn=i(60472);const Cn=(0,u.style)({width:200}),Pn=()=>r.createElement(r.Fragment,null,r.createElement(l.PageHeader,{"data-testid":"policy-loading"},r.createElement(s.Stack,null,r.createElement(s.StackItem,null,r.createElement(s.Breadcrumb,null,r.createElement(a.BreadcrumbLinkItem,{ouiaId:"to-list-page",to:Zn.listPage()},"Policies"),r.createElement(s.BreadcrumbItem,null,r.createElement(s.Skeleton,{className:Cn})))),r.createElement(s.StackItem,null,r.createElement(s.Split,null,r.createElement(s.SplitItem,{isFilled:!0},r.createElement(l.PageHeaderTitle,{title:r.createElement(s.Skeleton,{width:"25%"})})),r.createElement(s.SplitItem,null,r.createElement(s.Button,{isDisabled:!0,variant:s.ButtonVariant.plain},r.createElement(Tn.ZP,null))))))),r.createElement(l.Main,null,r.createElement(a.Section,{ouiaId:"loading-spinner"},r.createElement(s.Bullseye,null,r.createElement(l.Spinner,{centered:!0}))))),Sn=()=>r.createElement(g,{title:h.tables.trigger.emptyState.notFound.title,content:h.tables.trigger.emptyState.notFound.content}),xn=[{title:h.tables.trigger.columns.date,transforms:[x.sortable],cellTransforms:[x.nowrap]},{title:h.tables.trigger.columns.system,transforms:[x.sortable],cellTransforms:[x.wrappable,x.breakWord]}],On=e=>{const t=r.useMemo((()=>{const t=e.rows;return t?t.map(((e,t)=>{return{id:`${e.id}-${t}`,key:`${e.id}-${t}`,cells:[{title:r.createElement(x.TableText,null,(0,X.Z)((0,a.toUtc)(e.created),"dd MMM yyyy HH:mm:ss")," UTC")},{title:e.id?r.createElement(x.TableText,null,r.createElement("a",{href:(i=e.id,(0,a.localUrl)(`/insights/inventory/${i}/`,(0,a.getInsights)().chrome.isBeta()))},e.hostName)):r.createElement(x.TableText,null,e.hostName)}]};var i})):[]}),[e.rows]),i=r.useCallback(((t,i,n)=>{const r=e.onSort;r&&r(i,0===i?"ctime":"name",n===x.SortByDirection.asc?a.Direction.ASCENDING:a.Direction.DESCENDING)}),[e.onSort]),n=r.useMemo((()=>{if(e.sortBy)return{index:"ctime"===e.sortBy.column?0:1,direction:e.sortBy.direction===a.Direction.ASCENDING?"asc":"desc"}}),[e.sortBy]);return e.loading?r.createElement(l.SkeletonTable,{testID:"trigger-table-loading",rowSize:10,columns:xn,sortBy:n}):0===t.length?r.createElement(Sn,null):r.createElement("div",Object.assign({},p("Trigger/Table",e)),r.createElement(x.Table,{"aria-label":h.tables.trigger.title,rows:t,cells:xn,onSort:i,sortBy:n,isStickyHeader:!0},r.createElement(x.TableHeader,null),r.createElement(x.TableBody,null)))};var Nn;!function(e){e.NAME="name"}(Nn||(Nn={}));const In={[Nn.NAME]:{label:"System",placeholder:"Filter by system name"}},Rn=e=>{const t=(0,a.usePrimaryToolbarFilterConfig)(Nn,e.filters,e.setFilters,e.clearFilters,In),i=r.useMemo((()=>({itemCount:e.count||0,page:e.page.index,perPage:e.page.size,perPageOptions:void 0,onSetPage:e.onPaginationChanged,onFirstClick:e.onPaginationChanged,onPreviousClick:e.onPaginationChanged,onNextClick:e.onPaginationChanged,onLastClick:e.onPaginationChanged,onPageInput:e.onPaginationChanged,onPerPageSelect:e.onPaginationSizeChanged,isCompact:!0,variant:s.PaginationVariant.top})),[e.onPaginationChanged,e.page,e.count,e.onPaginationSizeChanged]),n=r.useMemo((()=>({itemCount:e.count||0,page:e.page.index,perPage:e.page.size,perPageOptions:void 0,onSetPage:e.onPaginationChanged,onFirstClick:e.onPaginationChanged,onPreviousClick:e.onPaginationChanged,onNextClick:e.onPaginationChanged,onLastClick:e.onPaginationChanged,onPageInput:e.onPaginationChanged,onPerPageSelect:e.onPaginationSizeChanged,isCompact:!1,variant:s.PaginationVariant.bottom})),[e.onPaginationChanged,e.page,e.count,e.onPaginationSizeChanged]),o=r.useMemo((()=>{const t=e.onExport;return{extraItems:[],onSelect:(e,i)=>{t((0,a.exporterTypeFromString)(i))},"data-testid":"trigger-toolbar-export-container"}}),[e.onExport]);return r.createElement("div",Object.assign({},p("Trigger/TableDualToolbar",e)),r.createElement(l.PrimaryToolbar,{pagination:i,exportConfig:o,filterConfig:t.filterConfig,activeFiltersConfig:t.activeFiltersConfig}),e.children,r.createElement(l.PrimaryToolbar,{pagination:n}))};class wn extends a.ExporterCsv{serialize(e){return Object.assign({},e)}headers(){return[["created","ctime"],["hostName","system"],["id","id"]]}}class An extends a.ExporterJson{}const kn=e=>({id:e.id||"",hostName:e.hostName||"",created:e.ctime?(0,Be.Z)(e.ctime/1e3):new Date(Date.now())}),Ln=e=>Ie.GetPoliciesByIdHistoryTrigger.actionCreator(Object.assign({id:e.policyId},e.page.toQuery())),Dn=(0,we.validationResponseTransformer)((e=>{var t,i,n;if("PagedResponseOfHistoryItem"===e.type){const a=e.value;return Object.assign(Object.assign({},e),{type:"PagedTriggers",value:{count:(null===(t=a.meta)||void 0===t?void 0:t.count)||0,data:(n=null!==(i=a.data)&&void 0!==i?i:[],n?n.map(kn):[])}})}return e})),Fn=(0,we.validationResponseTransformer)((e=>"PagedResponseOfHistoryItem"===e.type?Object.assign(Object.assign({},e),{type:"boolean",value:e.value.data&&e.value.data.length}):e)),Mn=e=>Ie.GetPoliciesByIdHistoryTrigger.actionCreator(Object.assign({id:e},a.Page.of(1,1).toQuery()));const Vn=e=>(0,a.useUrlStateString)("system",e),Bn=e=>{switch(e){case Nn.NAME:return Vn;default:(0,O.vE)(e)}};var Un=i(14299);const jn=()=>r.createElement(g,{title:h.pages.policyDetail.triggerEmptyState.title,content:r.createElement(s.TextContent,null,r.createElement(s.Text,{style:{color:Un.ZP.value}},h.pages.policyDetail.triggerEmptyState.text),r.createElement(s.Text,{component:"small"},h.pages.policyDetail.triggerEmptyState.sub))}),Gn=e=>{const t=yn(h.pages.policyDetail.triggerErrorState.text,[e.error]);return r.createElement(g,{icon:st.ZP,iconColor:ct.ZP.value,title:h.pages.policyDetail.triggerErrorState.title,content:t,action:e.action,actionLabel:h.pages.policyDetail.triggerErrorState.actionText})},zn=a.Sort.by("ctime",a.Direction.DESCENDING),Hn=e=>{var t;return e.errorContent?r.createElement(r.Fragment,null," ",e.errorContent," "):e.payload&&e.payload.count>0||e.loading?r.createElement(On,{rows:null===(t=e.payload)||void 0===t?void 0:t.data,onSort:e.sort.onSort,sortBy:e.sort.sortBy,loading:e.loading}):r.createElement(Sn,null)},Qn=(0,r.forwardRef)(((e,t)=>{var i;const{policyId:n}=e,o=((e=250)=>(0,a.useFilters)(Nn,e,Bn))(),s=(()=>{const e=(0,a.useTransformQueryResponse)((0,Re.useParameterizedQuery)(Ln),Dn),t=(0,a.useTransformQueryResponse)((0,Re.useParameterizedQuery)(Mn),Fn),[i,n]=(0,r.useState)(),o=(0,r.useCallback)(((...i)=>{const[{policyId:a,page:r}]=i,o=e.query,l=t.query,s=!r.hasFilter()&&1===r.index;return o({policyId:a,page:r}).then((e=>{if(404===e.status){if(!s)return n(void 0),l(a).then((t=>(404===t.status?n(!1):200===t.status?n(!0):n(void 0),e)));n(!1)}else 200===e.status?n(!0):n(void 0);return e}))}),[e.query,t.query]),l=(0,r.useCallback)((()=>{const i=e.abort,n=t.abort;i(),n()}),[e.abort,t.abort]),s=(0,r.useCallback)((()=>{const i=e.reset,n=t.reset;i(),n()}),[e.reset,t.reset]);return Object.assign(Object.assign({},e),{query:o,abort:l,reset:s,status:e.status,loading:t.loading||e.loading,errorObject:t.errorObject||e.errorObject,error:t.error||e.error,hasTriggers:i})})(),c=r.useMemo((()=>{const e=s.payload;if("PagedTriggers"===(null==e?void 0:e.type))return e.value}),[s.payload]),[d,u]=r.useState(Te.defaultElementsPerPage),p=(0,a.useSort)(zn),{page:m,onPaginationChanged:g}=((e,t,i)=>{const n=r.useMemo((()=>{const e=new a.Filter,t=(0,a.stringValue)(i[Nn.NAME]);return t&&""!==t.trim()&&e.and("name",a.Operator.LIKE,t.trim()),e}),[i]),[o,l]=r.useState((()=>a.Page.of(1,e,n,t)));return(0,r.useEffect)((()=>{l((e=>e.sort!==t?a.Page.of(e.index,e.size,e.filter,t):e))}),[t]),(0,r.useEffect)((()=>{l((e=>e.filter!==n?a.Page.of(1,e.size,n,e.sort):e))}),[n]),(0,r.useEffect)((()=>{l((t=>t.size!==e?a.Page.of(1,e,t.filter,t.sort):t))}),[e]),{page:o,onPaginationChanged:r.useCallback(((e,t)=>{l((e=>e.withPage(t)))}),[l])}})(d,p.sortBy,o.debouncedFilters),y=(0,r.useCallback)((()=>{const e=s.query;n&&e({policyId:n,page:m})}),[n,s.query,m]);r.useEffect((()=>{y()}),[y]),r.useImperativeHandle(t,(()=>({refresh:y})),[y]);const h=((e,t)=>{const i=(0,Re.useClient)();return(0,r.useCallback)((()=>new Promise((n=>{return r=void 0,o=void 0,s=function*(){const r=[];let o=a.Page.of(1,200,t);for(;;){const t=yield i.query(Ln({policyId:e,page:o}));if(t.payload){const e=Dn(t.payload);if("PagedTriggers"===e.type&&e.value.data){if(r.push(...e.value.data),o=o.nextPage(),o.index>a.Page.lastPageForElements(e.value.count,o.size).index)break;continue}}break}n(r)},new((l=void 0)||(l=Promise))((function(e,t){function i(e){try{a(s.next(e))}catch(e){t(e)}}function n(e){try{a(s.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof l?a:new l((function(e){e(a)}))).then(i,n)}a((s=s.apply(r,o||[])).next())}));var r,o,l,s}))),[i,e,t])})(n,m.filter),E=r.useCallback((e=>{const t=(e=>{switch(e){case a.ExporterType.CSV:return new wn;case a.ExporterType.JSON:return new An}(0,O.vE)(e)})((0,a.exporterTypeFromString)(e));h().then((e=>{e.length>0&&rn()(t.export(e),`policy-${n}-triggers-${(0,X.Z)(new Date(Date.now()),"y-dd-MM")}.${t.type}`)}))}),[h,n]),v=r.useCallback(((e,t)=>{u(t)}),[u]);let b;return!s.loading&&s.error&&404!==s.status&&(b=r.createElement(Gn,{action:y,error:`code: ${s.status}`})),r.createElement(l.Section,null,!1===s.hasTriggers?r.createElement(jn,null):r.createElement(r.Fragment,null,r.createElement(Rn,{count:null==c?void 0:c.count,page:m,onPaginationChanged:g,onPaginationSizeChanged:v,pageCount:null===(i=null==c?void 0:c.data)||void 0===i?void 0:i.length,filters:o.filters,setFilters:o.setFilters,clearFilters:o.clearFilter,onExport:E},r.createElement(Hn,{loading:s.loading,payload:c,sort:p,errorContent:b}))))})),qn=(0,u.style)({paddingBottom:8,paddingTop:16}),Zn={listPage:()=>"/policies/list",policyDetail:e=>`/policies/policy/${e}`},Wn=[{path:Zn.listPage(),component:()=>{var e;const[t,i]=r.useState({isOpen:!1}),[n,o]=r.useState(!0);r.useEffect((()=>{try{T().get("/api/inventory/v1/hosts?page=1&per_page=1").then((({data:e})=>{o(e.total>0)}))}catch(e){console.log(e)}}),[o]);const c=Ke(),d=xe(),u=(0,a.useSort)(),p=Oe(d.debouncedFilters,Te.defaultElementsPerPage,u.sortBy),m=(e=>{const t=Ze(e,!1),i=(0,a.useTransformQueryResponse)((0,Re.useQuery)(Ie.GetPolicies.actionCreator(a.Page.of(1,1).toQuery()),!1),We),[n,o]=(0,r.useState)(),l=(0,r.useMemo)((()=>!e.hasFilter()&&1===e.index),[e]),s=(0,r.useCallback)((()=>{const e=t.query,n=i.query;return e().then((e=>{if(404===e.status){if(!l)return o(void 0),n().then((t=>(404===t.status?o(!1):200===t.status?o(!0):o(void 0),e)));o(!1)}else 200===e.status?o(!0):o(void 0);return e}))}),[t.query,i.query,l]),c=(0,r.useCallback)((()=>{const e=t.abort,n=i.abort;e(),n()}),[t.abort,i.abort]),d=(0,r.useCallback)((()=>{const e=t.reset,n=i.reset;e(),n()}),[t.reset,i.reset]);return Object.assign(Object.assign({},t),{query:s,abort:c,reset:d,status:t.status,loading:i.loading||t.loading,errorObject:i.errorObject||t.errorObject,error:i.error||t.error,hasPolicies:n})})(p.page),{query:g}=Ze(a.Page.of(0,a.Page.NO_SIZE,p.page.filter,p.page.sort),!1),E=Ve(),v=(0,r.useContext)(S);let b=m.loading||c.loading;const _="PagedResponseOfPolicy"===(null===(e=m.payload)||void 0===e?void 0:e.type)?m.payload.value.count:0,x=Me((e=>{if(200===(null==e?void 0:e.status))return e.value.data})(m.payload),b,_,p.page),{clearSelection:N,loadingSelected:I}=x;b=b||I;const{canReadPolicies:R,canWritePolicies:w}=v.rbac,{query:A}=m,{mutate:k,loading:L}=c,{open:D}=E,F=(0,P.Z)(L);r.useEffect((()=>{N()}),[d.debouncedFilters,N]),r.useEffect((()=>{!0!==F||L||A()}),[L,A,F]);const M=(e=>{const{rows:t,onSelect:i,removeSelection:n,clearSelection:o,selectionCount:l}=e.policyRows,{changePage:s}=e.policyPage,{index:c,size:d}=e.policyPage.page,{close:u,policy:p}=e.policyToDelete,{reload:m,count:g}=e;return{onDeleted:r.useCallback((e=>{const a=t.findIndex((t=>t.id===e));-1===a?n(e):i(t[a],a,!1)}),[t,i,n]),onCloseDeletePolicy:r.useCallback((e=>{if(e){m();const e=p?1:l,t=a.Page.lastPageForElements(g-e,d);t.index<c&&s(void 0,t.index),o()}u()}),[m,g,u,o,s,c,l,d,p])}})({policyPage:p,policyRows:x,policyToDelete:E,reload:A,count:_}),V=(e=>{const{canWrite:t,openPolicyToDelete:i,mutateChangePolicyEnabled:n,setPolicyWizardState:a}=e;return r.useCallback((e=>t?[{title:e.isEnabled?"Disable":"Enable",onClick:()=>{n({policyIds:[e.id],shouldBeEnabled:!e.isEnabled})}},{title:"Edit",onClick:()=>{a({isOpen:!0,template:e,showCreateStep:!1,isEditing:!0})}},{title:"Duplicate",onClick:()=>{a({isOpen:!0,template:Qe(e),showCreateStep:!1,isEditing:!1})}},{title:"Remove",onClick:()=>{i(e)}}]:[]),[t,i,n,a])})({canWrite:w,openPolicyToDelete:D,mutateChangePolicyEnabled:k,setPolicyWizardState:i}),B=(e=>{const{setPolicyWizardState:t,exportAllPoliciesQuery:i,mutateChangePolicyEnabled:n,openPolicyToDelete:o}=e,{selected:l,selectionCount:s,getSelected:c,rows:d}=e.policyRows;return{createCustomPolicy:r.useCallback((()=>{t({isOpen:!0,showCreateStep:!0,template:void 0,isEditing:!1})}),[t]),onDeletePolicies:r.useCallback((()=>{if(1===s){const e=d.find((e=>l.contains(e.id)));if(e)return void o(e)}o(s)}),[s,o,l,d]),onDisablePolicies:r.useCallback((()=>c().then((e=>n({shouldBeEnabled:!1,policyIds:e})))),[n,c]),onEnablePolicies:r.useCallback((()=>c().then((e=>n({shouldBeEnabled:!0,policyIds:e})))),[n,c]),onExport:r.useCallback(((e,t)=>{const n=(e=>{switch(e){case a.ExporterType.CSV:return new on;case a.ExporterType.JSON:return new ln}(0,O.vE)(e)})((0,a.exporterTypeFromString)(t));return i().then((e=>{var t;"PagedResponseOfPolicy"===(null===(t=e.payload)||void 0===t?void 0:t.type)?rn()(n.export(e.payload.value.data),`policies-${(0,X.Z)((0,a.toUtc)(new Date(Date.now())),"y-dd-MM")}.${n.type}`):(0,a.addDangerNotification)("Couldn't download export","Reinitiate this export to try again.")}))}),[i])}})({setPolicyWizardState:i,policyRows:x,openPolicyToDelete:D,mutateChangePolicyEnabled:k,exportAllPoliciesQuery:g});r.useEffect((()=>{R&&A()}),[R,A]);const U=r.useCallback((e=>{const t=v.userSettings.refresh;e&&(A(),t()),i({isOpen:!1})}),[v.userSettings.refresh,i,A]),j=r.useMemo((()=>((e,t,i)=>{if(t)switch(i){case 404:return{title:h.tables.policy.emptyState.notFound.title,content:h.tables.policy.emptyState.notFound.content};case 401:return{icon:st.ZP,title:"Refresh your browser",content:"Your session expired while using the application",action:e.refreshPage,actionLabel:"Reload page"};case 500:case 502:return{icon:st.ZP,iconColor:sn.ZP.value,title:"Internal server error",content:"The server was unable to process the request, please try again.",action:e.tryAgain,actionLabel:"Try again"};default:return{icon:st.ZP,iconColor:sn.ZP.value,title:"Unable to connect",content:"There was an error retrieving data. Check your connection and try again.",action:e.tryAgain,actionLabel:"Try again"}}})({refreshPage:()=>{window.location.reload()},tryAgain:()=>{A()}},m.error,m.status)),[m.error,m.status,A]);return r.createElement(r.Fragment,null,n?r.createElement(r.Fragment,null,r.createElement(C.q,null,r.createElement("title",null,"Policies | Red Hat Insights")),r.createElement(l.PageHeader,null,r.createElement(l.PageHeaderTitle,{title:h.pages.listPage.title})),!v.userSettings.isSubscribedForNotifications&&x.rows.find((e=>e.actions.find((e=>e.type===y.NOTIFICATION))))&&r.createElement(s.PageSection,{className:cn},r.createElement(a.InsightsEmailOptIn,{ouiaId:"list-email-required",content:h.pages.listPage.emailOptIn,insights:(0,a.getInsights)(),bundle:"rhel"})),r.createElement(l.Main,null,!1===m.hasPolicies?r.createElement(nn,{createPolicy:w?B.createCustomPolicy:void 0}):r.createElement(l.Section,null,r.createElement(fe,{ouiaId:"main-toolbar",onCreatePolicy:w?B.createCustomPolicy:void 0,onDeletePolicy:w?B.onDeletePolicies:void 0,onEnablePolicy:w?B.onEnablePolicies:void 0,onDisablePolicy:w?B.onDisablePolicies:void 0,onPaginationChanged:p.changePage,onPaginationSizeChanged:p.changeItemsPerPage,onSelectionChanged:x.onSelectionChanged,selectedCount:x.selectionCount,page:p.page.index,pageCount:x.rows.length,perPage:p.page.size,showPerPageOptions:!0,filters:d.filters,setFilters:d.setFilters,clearFilters:d.clearFilter,count:_,onExport:B.onExport,showBottomPagination:!0},r.createElement(ye,{ouiaId:"main-table",policies:x.rows,onCollapse:x.onCollapse,onSelect:x.onSelect,actionResolver:V,loading:b,error:j,onSort:u.onSort,sortBy:u.sortBy,linkToDetailPolicy:!0})))),t.isOpen&&r.createElement(Ki,{isOpen:t.isOpen,close:U,initialValue:t.template,showCreateStep:t.showCreateStep,policiesExist:!0===m.hasPolicies,isEditing:t.isEditing}),E.isOpen&&r.createElement(Ji,{onClose:M.onCloseDeletePolicy,onDeleted:M.onDeleted,loading:x.loadingSelected,count:E.count,getPolicies:x.getSelected,policy:E.policy})):r.createElement(f.Z,{appId:"policies_zero_state",appName:"dashboard",module:"./AppZeroState",scope:"dashboard",ErrorComponent:r.createElement(l.ErrorState,null),app:"Policies"}))}},{path:Zn.policyDetail(":policyId"),component:()=>{var e,t;const{policyId:i,policy:n,setPolicy:o}=(()=>{const{policyId:e}=(0,v.UO)(),t=(0,P.Z)(e),i=(0,v.k6)(),[n,a]=r.useState(),o=(null==n?void 0:n.id)||e,l=r.useCallback(((e,t)=>{(0,vn.unstable_batchedUpdates)((()=>{a(t),i.push(Zn.policyDetail(e))}))}),[i,a]),s=r.useCallback((t=>{e!==t.id?l(t.id,t):a(t)}),[l,e]);return(0,r.useEffect)((()=>{t!==e&&(n&&n.id===e||a(void 0))}),[e,t,l,i,n,o]),{policyId:o,policy:n,setPolicy:s}})(),c=(0,r.useContext)(S),{canReadPolicies:d,canWritePolicies:u}=c.rbac,p=(0,v.k6)(),m=Ve(),g=(0,a.useTransformQueryResponse)((0,Re.useParameterizedQuery)(dn),un),y=Ke(),b=(e=>{const[t,i]=r.useReducer(((t,i)=>{if(!e)return bn;switch(i){case En.CLOSE:return bn;case En.DUPLICATE:return{isEditing:!1,initialValue:Qe(e),isOpen:!0};case En.EDIT:return{isEditing:!0,initialValue:e,isOpen:!0};default:return(0,O.vE)(i)}}),bn);return{data:t,close:(0,r.useCallback)((()=>i(En.CLOSE)),[i]),duplicate:(0,r.useCallback)((()=>i(En.DUPLICATE)),[i]),edit:(0,r.useCallback)((()=>i(En.EDIT)),[i])}})(n),f=r.useRef(null),_=r.useCallback((e=>{var t;"Policy"===(null===(t=e.payload)||void 0===t?void 0:t.type)&&o(e.payload.value)}),[o]);r.useEffect((()=>{const e=g.query;i!==(null==n?void 0:n.id)&&e(i).then(_)}),[i,g.query,n,o,_]);const T=r.useCallback((e=>{const t=b.close;e&&o(e),t()}),[o,b.close]),x=r.useCallback((()=>{const e=m.open;n&&e(n)}),[n,m.open]),N=r.useCallback((e=>{const t=m.close;e?p.push(Zn.listPage()):t()}),[p,m.close]),I=r.useCallback((e=>{n&&o(Object.assign(Object.assign({},n),{isEnabled:e}))}),[n,o]),R=r.useCallback((e=>{(0,y.mutate)({policyIds:[i],shouldBeEnabled:e}).then((t=>{var n;200===(null===(n=t.payload)||void 0===n?void 0:n.status)?t.payload.value.includes(i)?I(e):(0,a.addDangerNotification)(h.pages.policyDetail.errorChangingEnabledStatus.notFound.title,h.pages.policyDetail.errorChangingEnabledStatus.notFound.text):(0,a.addDangerNotification)(h.pages.policyDetail.errorChangingEnabledStatus.else.title,h.pages.policyDetail.errorChangingEnabledStatus.else.text)}))}),[i,y.mutate,I]);if(!d)return r.createElement(E,null);if(void 0===n){if(404===g.status)return r.createElement(gn,{policyId:i||""});if(!g.loading&&"Policy"!==(null===(e=g.payload)||void 0===e?void 0:e.type)){let e=`code: ${g.status}`;return"Msg"===(null===(t=g.payload)||void 0===t?void 0:t.type)&&g.payload.value.msg&&(e=g.payload.value.msg),r.createElement(hn,{action:()=>{var e;null===(e=f.current)||void 0===e||e.refresh(),g.query(i).then(_)},error:e})}return r.createElement(Pn,null)}return r.createElement(r.Fragment,null,r.createElement(C.q,null,r.createElement("title",null,n.name," - Policies | Red Hat Insights")),r.createElement(l.PageHeader,null,r.createElement(s.Stack,null,r.createElement(s.StackItem,null,r.createElement(s.Breadcrumb,null,r.createElement(a.BreadcrumbLinkItem,{ouiaId:"to-list-page",to:Zn.listPage()},"Policies"),r.createElement(s.BreadcrumbItem,{to:"#",isActive:!0},n.name))),r.createElement(s.StackItem,null,r.createElement(s.Split,null,r.createElement(s.SplitItem,{isFilled:!0},r.createElement(l.PageHeaderTitle,{title:n.name})),r.createElement(s.SplitItem,null,r.createElement(pn,{isEnabled:n.isEnabled,disabled:!u,edit:b.edit,duplicate:b.duplicate,delete:x,changeEnabled:R,loadingEnabledChange:y.loading})))))),r.createElement(l.Main,null,r.createElement(a.Section,{ouiaId:"policy-detail",style:{paddingBottom:"4px"}},r.createElement(_n,{isEnabled:n.isEnabled,loading:y.loading}),r.createElement(oe,{actions:n.actions,description:n.description,created:n.ctime,updated:n.mtime,conditions:n.conditions})),r.createElement("div",{className:qn},r.createElement(s.Title,{headingLevel:"h2",size:"lg"},"Recent trigger history")),r.createElement(Qn,{policyId:i,ref:f})),b.data.isOpen&&r.createElement(Ki,{isOpen:!0,close:T,showCreateStep:!1,policiesExist:!1,initialValue:b.data.initialValue,isEditing:b.data.isEditing}),m.isOpen&&r.createElement(Ji,{onClose:N,loading:!1,count:m.count,policy:m.policy}))}}],$n=e=>r.createElement(b,null,r.createElement(v.AW,Object.assign({},e))),Kn=()=>{const e=(0,a.getInsights)(),t=(0,v.k6)();return(0,r.useEffect)((()=>{const i=e.chrome.on;if(i)return i("APP_NAVIGATION",(e=>{const i=e.domEvent.href,n=((e,t)=>{const i=t.substr(e.length).trim();return 0===i.length?Zn.listPage():i})((0,a.getBaseName)(i),i);for(const e of Wn)if((0,v.LX)(n,{path:e.path,exact:!0})){t.location.pathname!==n&&t.push(n);break}}))}),[e.chrome.on,t]),r.createElement(v.rs,null,Wn.map((e=>r.createElement($n,{key:e.path,component:e.component,path:e.path}))),r.createElement(v.l_,{to:Zn.listPage()}))},Yn=Te.apis.urls,Xn=e=>({dailyEmail:e.daily_email,immediateEmail:e.instant_email}),Jn=()=>{const{rbac:e,userSettings:t}=(()=>{const e=(0,v.k6)(),[t,i]=(0,r.useState)(void 0),n=(e=>{const t=(0,a.useTransformQueryResponse)((0,Re.useQuery)((0,Ae.actionBuilder)("GET",Yn.userSettings.email).build(),void 0),Xn),i=t.query;return(0,a.useSyncInterval)(e,(0,r.useCallback)((()=>{i()}),[i])),(0,r.useMemo)((()=>{let e=!1;const n=t.payload;return n&&(e=!!n.dailyEmail||!!n.immediateEmail),{settings:t.payload,refresh:i,isSubscribedForNotifications:e}}),[t.payload,i])})(9e5);return(0,r.useEffect)((()=>{(0,a.waitForInsights)().then((e=>{e.chrome.init(),e.chrome.identifyApp(Te.appId),e.chrome.hasOwnProperty("hideGlobalFilter")&&e.chrome.hideGlobalFilter&&e.chrome.hideGlobalFilter()}))}),[e]),(0,r.useEffect)((()=>{(0,a.waitForInsights)().then((e=>{e.chrome.auth.getUser().then((()=>{(0,a.fetchRBAC)(Te.appId).then(i)}))}))}),[]),{rbac:t?{canReadPolicies:t.hasPermission("policies","policies","read"),canWritePolicies:t.hasPermission("policies","policies","write")}:void 0,userSettings:n}})();return e?r.createElement(S.Provider,{value:{rbac:e,userSettings:t}},e.canReadPolicies?r.createElement(r.Fragment,null,r.createElement(n.NotificationsPortal,null),r.createElement(Kn,null)):r.createElement(E,null)):r.createElement(a.AppSkeleton,null)}},1833:(e,t,i)=>{"use strict";i.d(t,{M:()=>a,i:()=>r});var n=i(55128);const a=(...e)=>(0,n.initStore)({},{},...e),r=()=>(0,n.restoreStore)()},30187:()=>{}}]);
//# sourceMappingURL=../sourcemaps/396.82094fa7c1f6dbdb8fc3b9b17116a624.js.map