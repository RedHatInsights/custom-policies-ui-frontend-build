(self.webpackChunkpolicies_ui_frontend=self.webpackChunkpolicies_ui_frontend||[]).push([[162],{22391:(e,t,i)=>{"use strict";i.d(t,{Z:()=>Kn});var n=i(8650),a=i(55128),r=i(93264),o=i(5569),l=i(88274),s=i(58788),c=i(11331),d=i(47435),u=i(8813);const p=(0,a.getOuiaPropsFactory)("Policies"),m=(0,u.style)({paddingTop:(0,d.calc)(`${c.default.value} - var(--pf-c-page__main-section--PaddingTop)`)}),g=e=>r.createElement(s.EmptyState,Object.assign({variant:s.EmptyStateVariant.full,className:`${m} ${e.className?e.className:""} `},p("Policy/EmptyState",e)),e.icon&&r.createElement(s.EmptyStateIcon,{icon:e.icon,color:e.iconColor}),r.createElement(s.Title,{headingLevel:"h5",size:"lg"},e.title),r.createElement(s.EmptyStateBody,null,e.content),e.actionNode,e.actionLabel&&r.createElement(s.Button,{variant:"primary",onClick:e.action,isDisabled:!e.action},e.actionLabel));var y;!function(e){e.NOTIFICATION="notification"}(y||(y={}));const h={pages:{noPermissions:{title:"Policies",emptyState:{title:"You do not have access to Policies",content:"Contact your organization administrator(s) for more information."}},error:{title:"Policies",emptyState:{title:"Unhandled error",content:"There was a problem trying to process your request.",showDetails:"Show details",actions:{goToIndex:"Go to Policy list"}}},listPage:{title:"Policies",emailOptIn:"One or more of your policies has a notification which may send an email. You can configure these notifications in the {0} for your organization. In order to receive emails from Insights, opt in to email notifications in your user preferences.",emptyState:{title:"No Policies",text:["No policies have been created.","Use self defined-policies to monitor your RHEL configurations with instant or daily alerts."]}},policyDetail:{errorChangingEnabledStatus:{notFound:{title:"Policy not found",text:"The policy does not exists on the server. It may have been removed by another user."},else:{title:"Enabled status change failed for policy",text:"There was an error setting the enabled status for this policy. Please try again."}},emptyState:{title:"Policy not found",text:"This policy with ID {0} cannot be found. It may have been removed by another user.",backText:"Back to previous page"},triggerEmptyState:{title:"No recent triggers",text:"This policy has not been triggered in the last 14 days.",sub:"Trigger history is held for 14 days. If this policy was triggered before this time, it cannot be shown."},errorState:{title:"Error when loading policy",text:"Error loading this policy.\nError {0}",actionText:"Try again"},triggerErrorState:{title:"Error when loading trigger history for policy",text:"Error loading trigger history for this policy.\nError {0}",actionText:"Try again"}}},components:{actions:{title:"Trigger actions",noActions:"No actions configured."},actionType:{[y.NOTIFICATION]:"Notification"},emailOptIn:{title:"Enable email alerts",switch:"Get emails when a policy runs",link:"Open email preferences"},lastTriggeredCell:{never:"Never",ago:"ago"},actionNotificationForm:{text:"This action sends a notification to process the message as configured in {0}.",link:"notification settings"}},tables:{policy:{title:"Policies",columns:{name:"Name",triggerActions:"Trigger actions",lastTriggered:"Last triggered"},emptyState:{neverRun:"Never",noConditions:"No conditions configured.",noDescription:"--",notFound:{title:"No matching policies found",content:"No policies match the selected filter and search terms."}},actions:{notification:"Send a notification"}},trigger:{title:"Trigger",columns:{date:"Date",system:"System"},emptyState:{notFound:{title:"No matching triggers found",content:"No triggers match the selected search terms."}}}},wizards:{policy:{titleNew:"Create a policy",titleEdit:"Edit a policy",description:"Policies are processed on reception of system profile messages. If condition(s) are met, defined action(s) are triggered.",actions:{title:"Trigger actions",emailOptIn:"The notification for this policy sends an email from Red Hat Insights. To receive emails from Insights, opt in to email notifications in your user preferences."},conditions:{title:"Conditions",valid:"Valid condition",invalid:"Invalid condition",validating:"Validating…",hint:'e.g. facts.arch = "x86_64"',summaryDesc:"Define conditions for your policy using any system facts."},hints:{hintTitle:"What conditions can I define?",hintParagraph1:"You can write a condition for any combination of system facts that apply to your Insights inventory systems.",hintLinkTitle:"Review available system facts",hintSyntaxExamplesSection:"Syntax examples",hintQuestion1:"Is wireshark RPM installed?",hintQuestion1Ans:"facts.installed_packages contains ['wireshark']",hintQuestion2:"Is the release older than RHEL 8.1?",hintQuestion2Ans:"facts.os_release < 8.1",hintQuestion3:"Which of my public cloud instances are missing a tag Owner value set?",hintQuestion3Ans:"facts.cloud_provider in ['alibaba',aws','azure','google'] and not tags.Owner",hintQuestion4:"Is time synchronization configured for RHEL7 and RHEL8?",hintQuestion4Ans:"(facts.os_release >=7 and facts.os_release <8 and not facts.enabled_services contains 'ntpd') or (facts.os_release >=8 and not facts.enabled_services contains 'chronyd')"},createPolicy:{title:"Create Policy"},details:{title:"Policy Details"},review:{title:"Review and enable",enableThisPolicy:"Enable this policy?",policyIsEnabled:"Policy is enabled",policyIsDisabled:"Policy is disabled",policy:{details:"Policy details",name:"Policy name",description:"Description"}}}},labels:{description:"Description"}},E=()=>r.createElement(r.Fragment,null,r.createElement(l.PageHeader,null,r.createElement(l.PageHeaderTitle,{title:h.pages.noPermissions.title})),r.createElement(l.Main,null,r.createElement(g,{icon:o.ZP,title:h.pages.noPermissions.emptyState.title,content:h.pages.noPermissions.emptyState.content})));var v=i(85021);const b=(0,v.EN)((e=>{const t=r.useCallback((()=>{e.history.push(Hn.listPage())}),[e.history]);return r.createElement(a.ErrorBoundaryPage,{action:t,actionLabel:h.pages.error.emptyState.actions.goToIndex,pageHeader:h.pages.error.title,title:h.pages.error.emptyState.title,description:h.pages.error.emptyState.content},e.children)}));var f=i(64593),_=i(37176);const T=r.createContext({rbac:{canReadPolicies:!1,canWritePolicies:!1},userSettings:{settings:void 0,isSubscribedForNotifications:!1,refresh:()=>{console.error("Using default refresh function")}}});var C=i(94550),P=i(46242),S=i(98149),x=i(69455);const O=()=>r.createElement(x.ZP,null);var N=i(35451);const I=()=>r.createElement(N.ZP,{color:"green"});var R=i(36853);const w=()=>r.createElement(R.ZP,null),A=e=>{const{actionType:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}(e,["actionType"]);switch(t){case y.NOTIFICATION:return r.createElement(w,Object.assign({},i));case void 0:break;default:(0,P.vE)(t)}return null},k=(0,u.style)({borderRadius:3}),L=(0,u.style)({marginRight:5}),D=(0,u.style)({minWidth:145}),F=s.TooltipPosition.bottom,M=()=>r.createElement(s.Tooltip,{content:h.tables.policy.actions.notification,position:F},r.createElement(w,null)),V=e=>{const t=e.actions.slice(0,4),i=e.actions.slice(4),n=t.map(((e,t)=>{let i;switch(e.type){case y.NOTIFICATION:i=r.createElement(M,null);break;default:(0,P.vE)(e.type)}return r.createElement(s.SplitItem,{key:t,className:L},i)}));return i.length>0&&n.push(r.createElement(s.SplitItem,{key:"remaining",className:L},r.createElement(s.Badge,{className:k,isRead:!0},`${i.length} more`))),r.createElement(s.Split,Object.assign({},p("Policy/Table/Actions",e),{className:D}),n)};var B=i(86031),U=i(98207);const j=(0,u.style)({marginBottom:5}),G=(0,u.style)({marginBottom:5,marginLeft:10,display:"inline"}),z=(0,u.style)({marginBottom:10,marginTop:10,marginLeft:10}),H=(0,u.style)({marginLeft:25,marginBottom:8,marginTop:8}),Q=e=>r.createElement(s.StackItem,{className:z},r.createElement(e.icon,null),r.createElement(s.Title,{headingLevel:"h2",className:G,size:"md"},e.title),e.children&&r.createElement("div",{className:H},e.children)),q=e=>r.createElement(r.Fragment,null,r.createElement(s.Stack,Object.assign({},p("Policy/Table/Expanded/Actions",e)),r.createElement(s.StackItem,null,r.createElement(s.Title,{headingLevel:"h2",className:j,size:"md"},h.components.actions.title)),0===e.actions.length?r.createElement(s.Text,null," ",h.components.actions.noActions," "):(e=>{const t=[];for(const i in e){const n=e[i];switch(n.type){case y.NOTIFICATION:t.push(r.createElement(r.Fragment,{key:i},r.createElement(Q,{title:h.tables.policy.actions.notification,icon:w})));break;default:(0,P.vE)(n.type)}}return(0,a.join)(t,s.Divider)})(e.actions))),Z=(0,u.style)({marginBottom:5}),W=e=>r.createElement("div",Object.assign({},p("Policy/Table/Expanded/Conditions",e)),r.createElement(s.Title,{headingLevel:"h2",className:Z,size:"md"},"Conditions"),r.createElement(s.Text,null,e.conditions||h.tables.policy.emptyState.noConditions));var $=i(93022);const K="dd MMM yyyy",Y=e=>r.createElement(r.Fragment,null,r.createElement(s.Text,Object.assign({},p("Policy/Table/Expanded/Dates",e)),"Last updated ",(0,$.Z)(e.updated,K)," | Created ",(0,$.Z)(e.created,K))),X=e=>r.createElement("div",Object.assign({},p("Policy/Table/Expanded/Description",e)),r.createElement(s.Form,null,r.createElement(s.FormGroup,{fieldId:"",label:h.labels.description})),r.createElement(s.Text,null," ",e.description," ")),J=(0,u.style)({margin:12}),ee=(0,u.style)({maxWidth:800,marginBottom:12}),te=(0,u.style)({marginBottom:12}),ie=(0,u.style)(Object.assign(Object.assign({backgroundColor:B.ZP.var},(0,U.padding)(18,14)),{margin:5})),ne=e=>r.createElement(s.Stack,Object.assign({},p("Policy/Table/Expanded",e),{className:J}),e.description&&r.createElement(s.StackItem,{className:ee},r.createElement(X,{ouiaId:(0,a.ouiaIdConcat)(e.ouiaId,"description"),description:e.description})),r.createElement(s.StackItem,{className:te},r.createElement(Y,{ouiaId:(0,a.ouiaIdConcat)(e.ouiaId,"dates"),updated:e.updated,created:e.created})),r.createElement(s.StackItem,null,r.createElement(s.Grid,null,r.createElement(s.GridItem,{className:ie,span:6},r.createElement(W,{ouiaId:(0,a.ouiaIdConcat)(e.ouiaId,"conditions"),conditions:e.conditions})),r.createElement(s.GridItem,{className:ie,span:6},r.createElement(q,{ouiaId:(0,a.ouiaIdConcat)(e.ouiaId,"actions"),actions:e.actions})))));var ae=i(43321),re=i(42699),oe=i(17736);const le=(0,u.style)({marginLeft:10}),se=e=>{let t;if(e.lastTriggered){const i=(0,ae.Z)(e.lastTriggered,{months:1}),n=new Date(Date.now());t=(0,re.Z)(n,i)?(0,$.Z)(e.lastTriggered,"dd MMM yyyy"):`${(0,oe.Z)(e.lastTriggered)} ${h.components.lastTriggeredCell.ago}`}else t=h.components.lastTriggeredCell.never;return r.createElement("div",Object.assign({},p("Policy/Table/LastTriggered",e)),e.isEnabled?r.createElement(I,null):r.createElement(O,null),r.createElement("span",{className:le},t))},ce=(0,u.style)({backgroundColor:"white"}),de=["name","actions","is_enabled"],ue=(e,t,i,n)=>t.indexOf(i[e])+n,pe=e=>{const{onSort:t,error:i,policies:n,onCollapse:o,onSelect:c}=e,d=e.columnsToShow||de,u=d.includes("radioSelect");if(u&&!c)throw Error("RadioSelect requires an onSelect");const m=r.useMemo((()=>{const e=t?[C.sortable]:[];return{radioSelect:{title:"",transforms:[]},name:{title:h.tables.policy.columns.name,transforms:e,cellFormatters:[C.expandable],column:"name"},actions:{title:h.tables.policy.columns.triggerActions,transforms:[]},is_enabled:{title:h.tables.policy.columns.lastTriggered,transforms:[],column:"is_enabled"}}}),[t]),y=r.useMemo((()=>[o,d.includes("radioSelect")?void 0:c].filter((e=>e)).length),[o,c,d]),E=r.useMemo((()=>d.map((e=>m[e]))),[m,d]),v=r.useCallback(((e,i,n)=>{if(t){const e=((e,t,i)=>t[e-i].column)(i,E,y);e&&t(i,e,n===C.SortByDirection.asc?a.Direction.ASCENDING:a.Direction.DESCENDING)}}),[t,E,y]),b=r.useCallback(((e,t,i,a)=>{const r=n,l=null==r?void 0:r.findIndex((e=>e.id===a.id));if(o&&r&&void 0!==l&&-1!==l){const e=r[l];o(e,l,i)}}),[n,o]),f=r.useCallback(((e,t,i,a)=>{const r=n,o=null==r?void 0:r.findIndex((e=>e.id===a.id));if(c&&r&&void 0!==o&&-1!==o){const e=r[o];c(e,o,t)}}),[n,c]),_=r.useMemo((()=>{if(e.sortBy)return{index:ue(e.sortBy.column,E,m,y),direction:e.sortBy.direction===a.Direction.ASCENDING?"asc":"desc"}}),[e.sortBy,E,m,y]),T=r.useMemo((()=>e.error||e.loading?void 0:e.actionResolver||void 0),[e.error,e.loading,e.actionResolver]),x=r.useCallback((e=>{if(void 0===e.parent&&T&&e&&n){const t=n.find((t=>t.id===e.id));if(t)return T(t)}return[]}),[T,n]),O=r.useMemo((()=>i?[]:((e,t,i,n)=>e?e.reduce(((a,o,l)=>(a.push({id:o.id,key:o.id,isOpen:o.isOpen,selected:o.isSelected,cells:t.map((t=>{switch(t){case"actions":return r.createElement(r.Fragment,null,r.createElement(V,{ouiaId:o.id,actions:o.actions}));case"is_enabled":return r.createElement(r.Fragment,null,r.createElement(se,{ouiaId:o.id,isEnabled:o.isEnabled,lastTriggered:o.lastTriggered}));case"name":return r.createElement(r.Fragment,null,i?r.createElement(S.Link,{to:Hn.policyDetail(o.id)},o.name):o.name);case"radioSelect":return r.createElement(r.Fragment,null,r.createElement(s.Radio,{id:`${o.id}-table-radio-id`,"aria-label":`Radio select for policy ${o.name}`,name:"policy-table-radio-select",isChecked:o.isSelected,onChange:n?()=>{const t=e.findIndex((e=>e.isSelected));-1!==t&&n(e[t],t,!1),n(o,l,!0)}:void 0}))}(0,P.vE)(t)}))}),a.push({parent:2*l,fullWidth:!0,showSelect:!1,cells:[{title:r.createElement(r.Fragment,null,r.createElement(ne,{ouiaId:o.id,key:o.id+"-content",description:o.description?o.description:h.tables.policy.emptyState.noDescription,conditions:o.conditions?o.conditions:h.tables.policy.emptyState.noConditions,actions:o.actions,created:o.ctime,updated:o.mtime}))}]}),a)),[]):[])(n,d,e.linkToDetailPolicy,c)),[i,n,d,c,e.linkToDetailPolicy]);return e.loading?r.createElement(l.SkeletonTable,{rowSize:e.loadingRowCount||10,columns:E,paddingColumnSize:y,sortBy:_}):i?r.createElement(g,Object.assign({},i,{className:ce})):r.createElement("div",Object.assign({},p("Policy/Table",e)),r.createElement(C.Table,{"aria-label":h.tables.policy.title,cells:E,rows:O,actionResolver:x,onSort:t?v:void 0,onCollapse:o?b:void 0,onSelect:e.error||!c||u?void 0:f,sortBy:_,canSelectAll:!1},r.createElement(C.TableHeader,null),r.createElement(C.TableBody,null)))};var me,ge;!function(e){e.NAME="name",e.IS_ACTIVE="is_enabled"}(me||(me={})),function(e){e[e.NONE=0]="NONE",e[e.PAGE=1]="PAGE",e[e.ALL=2]="ALL"}(ge||(ge={}));const ye=(0,u.style)({marginLeft:4}),he={[me.NAME]:{label:"Name",placeholder:"Filter by name"},[me.IS_ACTIVE]:{label:"Enabled",placeholder:"Filter by enabled status",options:{exclusive:!1,items:[{value:"Enabled",label:r.createElement(r.Fragment,null,r.createElement("span",{className:ye},"Enabled"))},{value:"Disabled",label:r.createElement(r.Fragment,null,r.createElement("span",{className:ye},"Disabled"))}]}}},Ee=e=>{const{pageCount:t,count:i,page:n,perPage:o,showPerPageOptions:c,onPaginationChanged:d,onPaginationSizeChanged:u,onCreatePolicy:m,onDeletePolicy:g,hideActions:y,onSelectionChanged:h,selectedCount:E,hideBulkSelect:v,onEnablePolicy:b,onDisablePolicy:f,onExport:_}=e,T=(0,a.usePrimaryToolbarFilterConfig)(me,e.filters,e.setFilters,e.clearFilters,he),C=r.useMemo((()=>{if(v)return;const e=()=>h&&h(ge.NONE),n=()=>h&&h(ge.ALL);return{count:E||0,items:[{title:"Select none (0)",onClick:e},{title:`Select page (${t||0})`,onClick:()=>h&&h(ge.PAGE)},{title:`Select all (${i||0})`,onClick:n}],checked:E===i,onSelect:t=>t?n():e()}}),[E,t,h,v,i]),P=r.useMemo((()=>({itemCount:i||0,page:n,perPage:o,perPageOptions:c?void 0:[],onSetPage:d,onFirstClick:d,onPreviousClick:d,onNextClick:d,onLastClick:d,onPageInput:d,onPerPageSelect:u,isCompact:!0,variant:s.PaginationVariant.top})),[c,i,n,o,d,u]),S=r.useMemo((()=>({itemCount:i||0,page:n,perPage:o,perPageOptions:c?void 0:[],onSetPage:d,onFirstClick:d,onPreviousClick:d,onNextClick:d,onLastClick:d,onPageInput:d,onPerPageSelect:u,isCompact:!1,variant:s.PaginationVariant.bottom})),[c,i,n,o,d,u]),x=r.useMemo((()=>{if(!y)return{actions:[{key:"create-policy",label:"Create policy",onClick:m,props:{isDisabled:!m}},{key:"delete-policy",label:"Remove",onClick:g,props:{isDisabled:!(E&&g)}},{key:"enable-policy",label:"Enable",onClick:b,props:{isDisabled:!(E&&b)}},{key:"disable-policy",label:"Disable",onClick:f,props:{isDisabled:!(E&&f)}}],kebabToggleProps:{isDisabled:!1}}}),[m,g,E,y,f,b]),O=r.useMemo((()=>{if(_)return{extraItems:[],onSelect:_}}),[_]);return r.createElement("div",Object.assign({},p("Policy/DualToolbar",e)),r.createElement(l.PrimaryToolbar,{bulkSelect:C,filterConfig:T.filterConfig,pagination:P,actionsConfig:x,activeFiltersConfig:T.activeFiltersConfig,exportConfig:O}),e.children,e.showBottomPagination&&r.createElement(l.PrimaryToolbar,{pagination:S}))},ve="/api/policies/v1.0";const be={appId:"policies",defaultElementsPerPage:20,apis:{version:"v1.0",urls:{base:ve,userSettings:{email:("/user-config/preferences",`${ve}/user-config/preferences`)}}},pages:{emailPreferences:()=>(0,a.localUrl)("/user-preferences/notifications/insights",(0,a.getInsights)().chrome.isBeta()),notifications:()=>(0,a.localUrl)("/settings/notifications/rhel",(0,a.getInsights)().chrome.isBeta()),factsDocumentation:"https://access.redhat.com/documentation/en-us/red_hat_insights/2021/html/monitoring_and_reacting_to_configuration_changes_using_policies/assembly-policies-monitoring-appendix-ref-materials#ref-policies-monitoring-appendix-system-facts_policies-monitoring-appendix-ref-materials"}},fe=e=>(0,a.useUrlStateString)("name",e),_e=e=>(0,a.useUrlStateMultipleOptions)("enabled",["Enabled","Disabled",""]),Te=e=>{switch(e){case me.NAME:return fe;case me.IS_ACTIVE:return _e;default:(0,P.vE)(e)}},Ce=(e=250,t=!0)=>(0,a.useFilters)(me,e,t?Te:void 0),Pe=(e,t,i)=>{const[n,o]=r.useState(1),[l,s]=r.useState(t);return r.useEffect((()=>{o(1)}),[o,e]),{page:r.useMemo((()=>{const t=new a.Filter,r=(0,a.stringValue)(e[me.NAME]).trim(),o=(0,a.arrayValue)(e[me.IS_ACTIVE]);return""!==r&&t.and(me.NAME,a.Operator.ILIKE,`%${r}%`),1===o.length&&t.and(me.IS_ACTIVE,a.Operator.BOOLEAN_IS,o.includes("Enabled")?"true":"false"),a.Page.of(n,l,t,i)}),[n,l,i,e]),changePage:r.useCallback(((e,t)=>{o(t)}),[o]),changeItemsPerPage:r.useCallback(((e,t)=>{o(1),s(t)}),[o,s])}};var Se,xe,Oe=i(94782),Ne=i(70070),Ie=i(52890),Re=i(78558);!function(e){function t(){return Re.enum(["BOOLEAN","INT","LIST","STRING"])}function i(){return Re.object({ctime:Re.number().int().optional().nullable(),hostName:Re.string().optional().nullable(),id:Re.string().optional().nullable()}).nonstrict()}function n(){return Re.object({count:Re.number().int().optional().nullable()}).nonstrict()}function a(){return Re.object({actions:Re.string().optional().nullable(),conditions:Re.string(),ctime:Re.string().optional().nullable(),description:Re.string().optional().nullable(),id:r().optional().nullable(),isEnabled:Re.boolean().optional().nullable(),lastTriggered:Re.number().int().optional().nullable(),mtime:Re.string().optional().nullable(),name:Re.string()}).nonstrict()}function r(){return Re.string()}e.Fact=Re.object({id:Re.number().int().optional().nullable(),name:Re.string().optional().nullable(),type:t().optional().nullable()}).nonstrict(),e.FactType=t(),e.HistoryItem=i(),e.Meta=n(),e.Msg=Re.object({msg:Re.string().optional().nullable()}).nonstrict(),e.PagedResponseOfHistoryItem=Re.object({data:Re.array(i()).optional().nullable(),links:Re.record(Re.string()).optional().nullable(),meta:n().optional().nullable()}).nonstrict(),e.PagedResponseOfPolicy=Re.object({data:Re.array(a()).optional().nullable(),links:Re.record(Re.string()).optional().nullable(),meta:n().optional().nullable()}).nonstrict(),e.Policy=a(),e.UUID=r(),e.UserPreferences=Re.object({daily_email:Re.boolean().optional().nullable(),instant_email:Re.boolean().optional().nullable()}).nonstrict(),e.__Empty=Re.string().max(0).optional()}(Se||(Se={})),function(e){let t,i,n,a,r,o,l,s,c,d,u,p,m,g;!function(e){e.actionCreator=()=>(0,Ie.actionBuilder)("GET","/api/policies/v1.0/").queryParams({}).config({rules:[new Ne.ValidateRule(Se.__Empty,"__Empty",404)]}).build()}(t=e.Get||(e.Get={})),function(e){const t=Re.array(Se.Fact);e.actionCreator=()=>(0,Ie.actionBuilder)("GET","/api/policies/v1.0/facts").queryParams({}).config({rules:[new Ne.ValidateRule(t,"unknown",200)]}).build()}(i=e.GetFacts||(e.GetFacts={})),function(e){Re.enum(["equal","like","ilike","not_equal"]),Re.enum(["equal","like","ilike","not_equal"]),Re.string(),Re.enum(["true","false"]),Re.string(),Re.number().int(),Re.number().int(),Re.enum(["name","description","is_enabled","mtime"]),Re.enum(["asc","desc"]),e.actionCreator=e=>{const t={};return void 0!==e.filterOpDescription&&(t["filter:op[description]"]=e.filterOpDescription),void 0!==e.filterOpName&&(t["filter:op[name]"]=e.filterOpName),void 0!==e.filterDescription&&(t["filter[description]"]=e.filterDescription),void 0!==e.filterIsEnabled&&(t["filter[is_enabled]"]=e.filterIsEnabled),void 0!==e.filterName&&(t["filter[name]"]=e.filterName),void 0!==e.limit&&(t.limit=e.limit),void 0!==e.offset&&(t.offset=e.offset),void 0!==e.sortColumn&&(t.sortColumn=e.sortColumn),void 0!==e.sortDirection&&(t.sortDirection=e.sortDirection),(0,Ie.actionBuilder)("GET","/api/policies/v1.0/policies").queryParams(t).config({rules:[new Ne.ValidateRule(Se.PagedResponseOfPolicy,"PagedResponseOfPolicy",200),new Ne.ValidateRule(Se.__Empty,"__Empty",400),new Ne.ValidateRule(Se.__Empty,"__Empty",403),new Ne.ValidateRule(Se.__Empty,"__Empty",404)]}).build()}}(n=e.GetPolicies||(e.GetPolicies={})),function(e){Re.boolean(),e.actionCreator=e=>{const t={};return void 0!==e.alsoStore&&(t.alsoStore=e.alsoStore),(0,Ie.actionBuilder)("POST","/api/policies/v1.0/policies").queryParams(t).data(e.body).config({rules:[new Ne.ValidateRule(Se.__Empty,"__Empty",200),new Ne.ValidateRule(Se.Policy,"Policy",201),new Ne.ValidateRule(Se.Msg,"Msg",400),new Ne.ValidateRule(Se.__Empty,"__Empty",403),new Ne.ValidateRule(Se.Msg,"Msg",409),new Ne.ValidateRule(Se.__Empty,"__Empty",500)]}).build()}}(a=e.PostPolicies||(e.PostPolicies={})),function(e){Re.enum(["equal","like","ilike","not_equal"]),Re.enum(["equal","like","ilike","not_equal"]),Re.string(),Re.enum(["true","false"]),Re.string();const t=Re.array(Se.UUID);e.actionCreator=e=>{const i={};return void 0!==e.filterOpDescription&&(i["filter:op[description]"]=e.filterOpDescription),void 0!==e.filterOpName&&(i["filter:op[name]"]=e.filterOpName),void 0!==e.filterDescription&&(i["filter[description]"]=e.filterDescription),void 0!==e.filterIsEnabled&&(i["filter[is_enabled]"]=e.filterIsEnabled),void 0!==e.filterName&&(i["filter[name]"]=e.filterName),(0,Ie.actionBuilder)("GET","/api/policies/v1.0/policies/ids").queryParams(i).config({rules:[new Ne.ValidateRule(t,"unknown",200),new Ne.ValidateRule(Se.__Empty,"__Empty",400),new Ne.ValidateRule(Se.__Empty,"__Empty",403),new Ne.ValidateRule(Se.__Empty,"__Empty",404)]}).build()}}(r=e.GetPoliciesIds||(e.GetPoliciesIds={})),function(e){Re.array(Re.string());const t=Re.array(Se.UUID);e.actionCreator=e=>(0,Ie.actionBuilder)("DELETE","/api/policies/v1.0/policies/ids").queryParams({}).data(e.body).config({rules:[new Ne.ValidateRule(t,"unknown",200),new Ne.ValidateRule(Se.__Empty,"__Empty",403)]}).build()}(o=e.DeletePoliciesIds||(e.DeletePoliciesIds={})),function(e){Re.boolean(),Re.array(Re.string());const t=Re.array(Se.UUID);e.actionCreator=e=>{const i={};return void 0!==e.enabled&&(i.enabled=e.enabled),(0,Ie.actionBuilder)("POST","/api/policies/v1.0/policies/ids/enabled").queryParams(i).data(e.body).config({rules:[new Ne.ValidateRule(t,"unknown",200),new Ne.ValidateRule(Se.__Empty,"__Empty",403)]}).build()}}(l=e.PostPoliciesIdsEnabled||(e.PostPoliciesIdsEnabled={})),function(e){e.actionCreator=e=>(0,Ie.actionBuilder)("POST","/api/policies/v1.0/policies/validate").queryParams({}).data(e.body).config({rules:[new Ne.ValidateRule(Se.Msg,"Msg",200),new Ne.ValidateRule(Se.Msg,"Msg",400),new Ne.ValidateRule(Se.__Empty,"__Empty",500)]}).build()}(s=e.PostPoliciesValidate||(e.PostPoliciesValidate={})),function(e){Re.string(),e.actionCreator=e=>{const t={};return void 0!==e.id&&(t.id=e.id),(0,Ie.actionBuilder)("POST","/api/policies/v1.0/policies/validate-name").queryParams(t).data(e.body).config({rules:[new Ne.ValidateRule(Se.Msg,"Msg",200),new Ne.ValidateRule(Se.Msg,"Msg",400),new Ne.ValidateRule(Se.Msg,"Msg",403),new Ne.ValidateRule(Se.__Empty,"__Empty",409),new Ne.ValidateRule(Se.__Empty,"__Empty",500)]}).build()}}(c=e.PostPoliciesValidateName||(e.PostPoliciesValidateName={})),function(e){e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{id}".replace("{id}",e.id.toString());return(0,Ie.actionBuilder)("GET",t).queryParams({}).config({rules:[new Ne.ValidateRule(Se.Policy,"Policy",200),new Ne.ValidateRule(Se.Msg,"Msg",403),new Ne.ValidateRule(Se.__Empty,"__Empty",404)]}).build()}}(d=e.GetPoliciesById||(e.GetPoliciesById={})),function(e){e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{id}".replace("{id}",e.id.toString());return(0,Ie.actionBuilder)("DELETE",t).queryParams({}).config({rules:[new Ne.ValidateRule(Se.__Empty,"__Empty",200),new Ne.ValidateRule(Se.__Empty,"__Empty",403),new Ne.ValidateRule(Se.__Empty,"__Empty",404)]}).build()}}(u=e.DeletePoliciesById||(e.DeletePoliciesById={})),function(e){Re.boolean(),e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{id}/enabled".replace("{id}",e.id.toString()),i={};return void 0!==e.enabled&&(i.enabled=e.enabled),(0,Ie.actionBuilder)("POST",t).queryParams(i).config({rules:[new Ne.ValidateRule(Se.__Empty,"__Empty",200),new Ne.ValidateRule(Se.__Empty,"__Empty",403),new Ne.ValidateRule(Se.__Empty,"__Empty",404),new Ne.ValidateRule(Se.__Empty,"__Empty",500)]}).build()}}(p=e.PostPoliciesByIdEnabled||(e.PostPoliciesByIdEnabled={})),function(e){Re.enum(["equal","not_equal","like"]),Re.enum(["equal","like","not_equal"]),Re.string(),Re.string(),Re.number().int(),Re.number().int(),Re.enum(["hostName","ctime"]),Re.enum(["asc","desc"]),e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{id}/history/trigger".replace("{id}",e.id.toString()),i={};return void 0!==e.filterOpId&&(i["filter:op[id]"]=e.filterOpId),void 0!==e.filterOpName&&(i["filter:op[name]"]=e.filterOpName),void 0!==e.filterId&&(i["filter[id]"]=e.filterId),void 0!==e.filterName&&(i["filter[name]"]=e.filterName),void 0!==e.limit&&(i.limit=e.limit),void 0!==e.offset&&(i.offset=e.offset),void 0!==e.sortColumn&&(i.sortColumn=e.sortColumn),void 0!==e.sortDirection&&(i.sortDirection=e.sortDirection),(0,Ie.actionBuilder)("GET",t).queryParams(i).config({rules:[new Ne.ValidateRule(Se.PagedResponseOfHistoryItem,"PagedResponseOfHistoryItem",200),new Ne.ValidateRule(Se.__Empty,"__Empty",400),new Ne.ValidateRule(Se.__Empty,"__Empty",403),new Ne.ValidateRule(Se.__Empty,"__Empty",404),new Ne.ValidateRule(Se.__Empty,"__Empty",500)]}).build()}}(m=e.GetPoliciesByIdHistoryTrigger||(e.GetPoliciesByIdHistoryTrigger={})),function(e){Re.boolean(),e.actionCreator=e=>{const t="/api/policies/v1.0/policies/{policyId}".replace("{policyId}",e.policyId.toString()),i={};return void 0!==e.dry&&(i.dry=e.dry),(0,Ie.actionBuilder)("PUT",t).queryParams(i).data(e.body).config({rules:[new Ne.ValidateRule(Se.Policy,"Policy",200),new Ne.ValidateRule(Se.__Empty,"__Empty",400),new Ne.ValidateRule(Se.__Empty,"__Empty",403),new Ne.ValidateRule(Se.__Empty,"__Empty",404),new Ne.ValidateRule(Se.Msg,"Msg",409)]}).build()}}(g=e.PutPoliciesByPolicyId||(e.PutPoliciesByPolicyId={}))}(xe||(xe={}));const we=e=>xe.GetPoliciesIds.actionCreator(e.toQuery()),Ae=new a.ImmutableContainerSet(void 0,a.ImmutableContainerSetMode.INCLUDE),ke=new a.ImmutableContainerSet(void 0,a.ImmutableContainerSetMode.EXCLUDE),Le=(e,t,i,n)=>{const[o,l]=r.useState([]),[s,c]=r.useState(Ae),d=(0,_.Z)(e),{query:u,loading:p}=(0,Oe.useParameterizedQuery)(we),m=r.useCallback((()=>{c(Ae),l((e=>e.map((e=>Object.assign(Object.assign({},e),{isOpen:!1,isSelected:!1})))))}),[c]);r.useEffect((()=>{t||!e?l([]):e!==d&&l(null==e?void 0:e.map((e=>Object.assign(Object.assign({},e),{isOpen:!1,isSelected:s.contains(e.id)}))))}),[e,t,l,d,s]);const g=r.useCallback(((e,t,i)=>{l((n=>{const a=[...n];return a[t]=Object.assign(Object.assign({},e),{isOpen:i}),a}))}),[l]),y=r.useCallback((e=>{c((t=>t.remove(e)))}),[c]),h=r.useCallback(((e,t,i)=>{c((t=>i?t.add(e.id):t.remove(e.id))),l((n=>{const a=[...n];return a[t]=Object.assign(Object.assign({},e),{isSelected:i}),a}))}),[c]),E=r.useCallback((e=>{e===ge.NONE?(c(Ae),l((e=>e.map((e=>Object.assign(Object.assign({},e),{isSelected:!1})))))):e===ge.PAGE?(c((e=>e.addIterable(o.map((e=>e.id))))),l((e=>e.map((e=>Object.assign(Object.assign({},e),{isSelected:!0})))))):e===ge.ALL?(c(ke),l((e=>e.map((e=>Object.assign(Object.assign({},e),{isSelected:!0})))))):(0,P.vE)(e)}),[o]),v=r.useMemo((()=>s.size(i)),[s,i]),b=r.useCallback((()=>s.mode===a.ImmutableContainerSetMode.INCLUDE?Promise.resolve(s.values()):u(n).then((e=>{var t;if(e.error)throw e.errorObject;let i=[];if(200===(null===(t=e.payload)||void 0===t?void 0:t.status)){const t=new Set(e.payload.value);s.values().forEach((e=>{t.delete(e)})),i=t}return Array.from(i.values())}))),[u,n,s]);return{rows:o,onCollapse:g,onSelect:h,onSelectionChanged:E,selectionCount:v,clearSelection:m,getSelected:b,loadingSelected:p,selected:s,removeSelection:y}},De=()=>{const[e,t]=r.useState(),[i,n]=r.useState(0),a=r.useCallback((()=>{t(void 0),n(0)}),[n,t]);return{open:r.useCallback((e=>{"number"==typeof e?(t(void 0),n(e)):(t(e),n(1))}),[]),close:a,count:i,policy:e,isOpen:i>0}};var Fe=i(42227),Me=i(5717);const Ve=e=>e.map((e=>{if(!e||!e.type)return"";const t=`${e.type}`;switch(e.type){case y.NOTIFICATION:break;default:(0,P.vE)(e.type)}return t})).join(";"),Be=e=>{if(!e||""===e)return[];const t=[];for(const i of e.split(";").map((e=>e.trim()))){if(""===i)continue;const[e]=i.split(" ",2);if("webhook"!==e&&"email"!==e)switch(e){case y.NOTIFICATION:t.push({type:y.NOTIFICATION});break;default:throw Error(`Unknown action.type=${e} found`)}}return t},Ue=e=>{const{mtime:t,ctime:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}(e,["mtime","ctime"]);return Object.assign(Object.assign({},n),{name:e.name||"",conditions:e.conditions||"",isEnabled:void 0!==e.isEnabled&&e.isEnabled,actions:e.actions?Ve(e.actions):""})},je=e=>Object.assign(Object.assign({},e),{id:e.id?e.id:"",description:e.description?e.description:"",isEnabled:!!e.isEnabled&&e.isEnabled,actions:Be(e.actions),mtime:e.mtime?(0,Me.Z)(e.mtime):new Date(Date.now()),ctime:e.ctime?(0,Me.Z)(e.ctime):new Date(Date.now()),lastTriggered:e.lastTriggered?(0,Fe.Z)(e.lastTriggered/1e3):void 0}),Ge=e=>Object.assign(Object.assign({},e),{name:`Copy of ${e.name.slice(0,150-"Copy of ".length)}`,mtime:void 0,lastTriggered:void 0,ctime:void 0,id:void 0}),ze=(0,Ne.validationResponseTransformer)((e=>{var t,i;return"PagedResponseOfPolicy"===e.type?(0,Ne.validatedResponse)(e.type,e.status,{data:(i=e.value,i.data?i.data.map(je):[]),count:(null===(t=e.value.meta)||void 0===t?void 0:t.count)||0},e.errors):e})),He=(e,t)=>(0,a.useTransformQueryResponse)((0,Oe.useQuery)((e=>{var t;return xe.GetPolicies.actionCreator(null!==(t=null==e?void 0:e.toQuery())&&void 0!==t?t:{})})(e),t),ze),Qe=(0,Ne.validationResponseTransformer)((e=>{var t;let i=!0;return"PagedResponseOfPolicy"===e.type&&(i=!!(null===(t=e.value.data)||void 0===t?void 0:t.length)),(0,Ne.validatedResponse)("HasPolicies",e.status,i,e.errors)})),qe=e=>xe.PostPoliciesIdsEnabled.actionCreator({body:e.policyIds,enabled:e.shouldBeEnabled}),Ze=()=>(0,Oe.useMutation)(qe);var We=i(74322),$e=i(3564),Ke=i(84956),Ye=i(87561);const Xe=Ye.Ry().shape({type:Ye.nK().oneOf([y.NOTIFICATION]).required().defined()}),Je=Ye.Ry().shape({type:Ye.nK().defined().required("Specify the action type").oneOf(Object.values(y))}),et=Ye.Ry().shape({description:Ye.Z_().notRequired().trim(),isEnabled:Ye.O7().notRequired(),name:Ye.Z_().required("Write a name for this Policy").max(150).trim()}),tt=Ye.Ry().shape({actions:Ye.IX(Ye.Vo((e=>{if((null==e?void 0:e.type)&&e.type===y.NOTIFICATION){const t=e.type;switch(t){case y.NOTIFICATION:return Xe;default:(0,P.vE)(t)}}return Je})))}),it=Ye.Ry().shape({conditions:Ye.Z_().required("Enter a condition for the policy.").trim()}),nt=Ye.Ry().concat(et).concat(tt).concat(it);var at,rt=i(84564),ot=i(7193);Ye.Ry(),function(e){e.SAVE="CREATE",e.VALIDATE_CONDITION="VALIDATE_CONDITION",e.VALIDATE_NAME="VALIDATE_NAME",e.NONE="NONE"}(at||(at={}));const lt=r.createContext({isLoading:!1,isFormValid:!1,triggerAction:()=>{throw Error("Action executed without WizardContext")},verifyResponse:{isValid:!1},createResponse:{created:!1},setVerifyResponse:()=>{throw Error("setVerifyResponse executed without WizardContext")},setMaxStep:()=>{throw Error("setMaxStep executed without a WizardContext")}}),st=(0,u.style)({marginTop:"auto",marginBottom:14}),ct=(0,u.style)({marginRight:5}),dt=e=>{const t=(0,r.useContext)(lt);return r.createElement(s.WizardFooter,null,r.createElement(s.WizardContextConsumer,null,(i=>{const n=e.onNext&&(()=>{e.onNext&&e.onNext(t,i.onNext)});return r.createElement(r.Fragment,null,r.createElement(s.Button,{variant:s.ButtonVariant.primary,type:"submit",onClick:n||i.onNext,isDisabled:e.isLoading||!i.activeStep.enableNext},i.activeStep.nextButtonText||"Next"),!i.activeStep.hideBackButton&&r.createElement(s.Button,{variant:s.ButtonVariant.secondary,onClick:i.onBack,isDisabled:0===i.activeStep.id||e.isLoading},"Back"),!i.activeStep.hideCancelButton&&r.createElement(s.Button,{variant:s.ButtonVariant.link,onClick:i.onClose,isDisabled:e.isLoading},"Cancel"),e.isLoading&&r.createElement("div",{className:st},e.loadingText,"  ",r.createElement(s.Spinner,{size:"md"})),!e.isLoading&&e.error&&r.createElement(s.Split,{className:st},r.createElement(s.SplitItem,null,r.createElement(rt.ZP,{className:ct,color:ot.ZP.value})),r.createElement(s.SplitItem,null,e.error)))})))};var ut=i(33606),pt=i(32412),mt=i(50744);const gt=e=>{const t=r.useMemo((()=>be.pages.notifications()),[]),i=(0,r.useContext)(T);return r.createElement("div",Object.assign({},p("Policy/Action/Hook",e)),r.createElement(s.Text,null,(0,mt.WU)(h.components.actionNotificationForm.text,r.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},h.components.actionNotificationForm.link))),!i.userSettings.isSubscribedForNotifications&&r.createElement(a.InsightsEmailOptIn,{ouiaId:"action-email.wizard-email-required",content:h.wizards.policy.actions.emailOptIn,bundle:"rhel",insights:(0,a.getInsights)()}))},yt=e=>{var t,i;switch((null===(t=e.action)||void 0===t?void 0:t.type)||void 0){case y.NOTIFICATION:return r.createElement(gt,Object.assign({},e));case void 0:return null;default:throw new Error("Unexpected action type:["+(null===(i=e.action)||void 0===i?void 0:i.type)+"]")}},ht=(0,u.style)({gridGap:pt.ZP.var}),Et=(0,u.style)({backgroundColor:"white",border:"1px var(--pf-global--BorderColor--200) solid",boxShadow:"none"}),vt=(0,u.style)({marginLeft:10,display:"inline"}),bt=e=>{var t;return r.createElement(s.Form,{className:ht},null===(t=e.actions)||void 0===t?void 0:t.map(((t,i)=>r.createElement(r.Fragment,{key:i},r.createElement(s.Card,{className:Et},r.createElement(s.CardHeader,{"data-codemods":"true"},r.createElement(s.CardActions,null,r.createElement(s.Button,{variant:"plain","aria-label":"Action",onClick:e.arrayHelpers.handleRemove(i)},r.createElement(ut.ZP,null))),r.createElement(s.CardTitle,null,r.createElement(r.Fragment,null,r.createElement(A,{actionType:null==t?void 0:t.type}),r.createElement(s.Title,{headingLevel:"h2",className:vt,size:"md"},(null==t?void 0:t.type)?(e=>{switch(e){case y.NOTIFICATION:return h.tables.policy.actions.notification;default:(0,P.vE)(e)}})(t.type):"")))),r.createElement(s.CardBody,{className:"pf-c-form"},r.createElement(yt,{ouiaId:`actions-form.${i.toString()}`,isReadOnly:e.isReadOnly,action:t,prefix:`actions.${i}`})))))))};var ft=i(75902),_t=i(81875);const Tt=(0,u.style)({marginBottom:16}),Ct=e=>{const[t,i]=r.useState(!1),n=[y.NOTIFICATION].map((t=>r.createElement(s.DropdownItem,{key:t,onClick:()=>(t=>{e.onTypeSelected(t),i(!1)})(t),isDisabled:!e.isTypeEnabled(t)},h.components.actionType[t])));return r.createElement(s.Dropdown,Object.assign({isOpen:t,dropdownItems:n,isPlain:!0,className:Tt,toggle:r.createElement(ft.Z,{isPlain:!0,onToggle:e=>i(e),id:"add-action-toggle"},r.createElement(s.Button,{component:"a",variant:s.ButtonVariant.link,isInline:!0}," Add trigger actions ",r.createElement(_t.ZP,null)," "))},p("Policy/Wizard/AddTrigger",e)))},Pt=()=>{var e;const{validateForm:t,values:i}=(0,$e.useFormikContext)(),n=null===(e=i.actions)||void 0===e?void 0:e.length;return r.useEffect((()=>{t()}),[t,n]),r.createElement(r.Fragment,null,r.createElement(s.Title,{headingLevel:"h4",size:"xl"},h.wizards.policy.actions.title),r.createElement($e.FieldArray,{name:"actions"},(e=>r.createElement(r.Fragment,null,r.createElement(Ct,{isTypeEnabled:t=>{var i;return 0===((null===(i=e.form.values.actions)||void 0===i?void 0:i.filter((e=>e.type===t)))||[]).length},onTypeSelected:t=>{e.push({type:t})}}),r.createElement(bt,{id:"actions",name:"actions",actions:e.form.values.actions,arrayHelpers:e})))))};var St=i(47561),xt=i(48286),Ot=i(18127),Nt=i(50352),It=i(9963),Rt=i(39557),wt=i(62178),At=i(36763),kt=i(15103);class Lt extends Rt.Lexer{constructor(e){super(e),this._interp=new wt.LexerATNSimulator(Lt._ATN,this)}get vocabulary(){return Lt.VOCABULARY}get grammarFileName(){return"Expression.g4"}get ruleNames(){return Lt.ruleNames}get serializedATN(){return Lt._serializedATN}get channelNames(){return Lt.channelNames}get modeNames(){return Lt.modeNames}static get _ATN(){return Lt.__ATN||(Lt.__ATN=(new It.ATNDeserializer).deserialize(kt.toCharArray(Lt._serializedATN))),Lt.__ATN}}Lt.T__0=1,Lt.T__1=2,Lt.T__2=3,Lt.T__3=4,Lt.T__4=5,Lt.OR=6,Lt.AND=7,Lt.NOT=8,Lt.EQUAL=9,Lt.NOTEQUAL=10,Lt.CONTAINS=11,Lt.MATCHES=12,Lt.NEG=13,Lt.GT=14,Lt.GTE=15,Lt.LT=16,Lt.LTE=17,Lt.IN=18,Lt.QUOTED_NUMBER=19,Lt.NUMBER=20,Lt.FLOAT=21,Lt.INTEGER=22,Lt.SIMPLETEXT=23,Lt.STRING=24,Lt.WS=25,Lt.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"],Lt.modeNames=["DEFAULT_MODE"],Lt.ruleNames=["T__0","T__1","T__2","T__3","T__4","OR","AND","NOT","EQUAL","NOTEQUAL","CONTAINS","MATCHES","NEG","GT","GTE","LT","LTE","IN","QUOTED_NUMBER","NUMBER","FLOAT","INTEGER","SIMPLETEXT","STRING","WS","ESC","UNICODE","HEX","ESC_DOT","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","NEG_OP"],Lt._LITERAL_NAMES=[void 0,"'('","')'","'['","','","']'",void 0,void 0,void 0,"'='","'!='",void 0,void 0,void 0,"'>'","'>='","'<'","'<='"],Lt._SYMBOLIC_NAMES=[void 0,void 0,void 0,void 0,void 0,void 0,"OR","AND","NOT","EQUAL","NOTEQUAL","CONTAINS","MATCHES","NEG","GT","GTE","LT","LTE","IN","QUOTED_NUMBER","NUMBER","FLOAT","INTEGER","SIMPLETEXT","STRING","WS"],Lt.VOCABULARY=new At.VocabularyImpl(Lt._LITERAL_NAMES,Lt._SYMBOLIC_NAMES,[]),Lt._serializedATN="줝쪺֍꾺体؇쉁į\b\t\t\t\t\t\t\b\t\b\t\t\t\n\t\n\v\t\v\f\t\f\r\t\r\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t !\t!\"\t\"#\t#$\t$%\t%&\t&'\t'(\t()\t)*\t*+\t+,\t,-\t-.\t./\t/0\t01\t12\t23\t34\t45\t56\t67\t78\t89\t9\b\b\b\b\t\t\t\t\n\n\v\v\v\f\f\f\f\f\f\f\f\f\r\r\r\r\r\r\r\r¶\n»\nÂ\n\rÃÉ\n\fÌ\vÑ\n\fÔ\vÚ\n\fÝ\và\nã\n\räí\n  !!\"\"##$$%%&&''(())**++,,--..//00112233445566778899:\t\v\r\b\t\n\v\f\r!#%')+-/13579;=?ACEGIKMOQSUWY[]_acegikmoq$2;002;C\\aac|/02;C\\aac|))^^$$^^\v\f\"\"\n))11^^ddhhppttvv2;CHchCCccDDddEEeeFFffGGggHHhhIIiiJJjjKKkkLLllMMmmNNnnOOooPPppQQqqRRrrSSssTTttUUuuVVvvWWwwXXxxYYyyZZzz[[{{\\\\||Ĝ\t\v\r!#%')+-/13suw\ty\v{\r} ¢!¥#§%ª'µ)·+¼-Á/Å1ß3â5è7î9ô;ö=ù?ûAýCÿEāGăIąKćMĉOċQčSďUđWēYĕ[ė]ę_ěaĝcğeġgģiĥkħmĩoīqĭst*tuv+vwx]x\byz.z\n{|_|\f}~Y-~_0=W,C\"W,Y-c2?#?A!Y-W,c2=M'W,a1U+=c2A!K&E#a1q9 ¡@¡¢£@£¤?¤ ¥¦>¦\"§¨>¨©?©$ª«M'«¬W,¬&­®)®¯)¯°)°¶±²$²³)³´$´¶µ­µ±¶(·º-¸¹0¹»-º¸º»»*¼½-½¾0¾¿-¿,ÀÂ\tÁÀÂÃÃÁÃÄÄ.ÅÊ\tÆÉ\tÇÉ;ÈÆÈÇÉÌÊÈÊËË0ÌÊÍÒ)ÎÑ5ÏÑ\nÐÎÐÏÑÔÒÐÒÓÓÕÔÒÕà)ÖÛ$×Ú5ØÚ\nÙ×ÙØÚÝÛÙÛÜÜÞÝÛÞà$ßÍßÖà2áã\tâáãääâäååææç\bç4èì^éí\t\bêí7ëíq9ìéìêìëí6îïwïð9ðñ9ñò9òó9ó8ôõ\t\tõ:ö÷^÷ø0ø<ùú\t\nú>ûü\t\vü@ýþ\t\fþBÿĀ\t\rĀDāĂ\tĂFăĄ\tĄHąĆ\tĆJćĈ\tĈLĉĊ\tĊNċČ\tČPčĎ\tĎRďĐ\tĐTđĒ\tĒVēĔ\tĔXĕĖ\tĖZėĘ\tĘ\\ęĚ\tĚ^ěĜ\tĜ`ĝĞ\tĞbğĠ\tĠdġĢ\tĢfģĤ\tĤhĥĦ\t ĦjħĨ\t!ĨlĩĪ\t\"ĪnīĬ\t#ĬpĭĮ#ĮrµºÃÈÊÐÒÙÛßäì\b";var Dt=i(87949),Ft=i(32915),Mt=i(94609),Vt=i(2824),Bt=i(83208),Ut=i(4584),jt=i(3998),Gt=i(44966);class zt extends Vt.Parser{constructor(e){super(e),this._interp=new Ut.ParserATNSimulator(zt._ATN,this)}get vocabulary(){return zt.VOCABULARY}get grammarFileName(){return"Expression.g4"}get ruleNames(){return zt.ruleNames}get serializedATN(){return zt._serializedATN}expression(){let e=new Ht(this._ctx,this.state);this.enterRule(e,0,zt.RULE_expression);try{this.enterOuterAlt(e,1),this.state=26,this.object(0),this.state=27,this.match(zt.EOF)}catch(t){if(!(t instanceof jt.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}object(e){void 0===e&&(e=0);let t=this._ctx,i=this.state,n=new Qt(this._ctx,i),a=n;this.enterRecursionRule(n,2,zt.RULE_object,e);try{let e;switch(this.enterOuterAlt(n,1),this.state=38,this._errHandler.sync(this),this._input.LA(1)){case zt.NOT:case zt.NEG:this.state=30,this.negative_expr(),this.state=31,this.object(4);break;case zt.SIMPLETEXT:case zt.STRING:this.state=33,this.expr();break;case zt.T__0:this.state=34,this.match(zt.T__0),this.state=35,this.object(0),this.state=36,this.match(zt.T__1);break;default:throw new Mt.NoViableAltException(this)}for(this._ctx._stop=this._input.tryLT(-1),this.state=46,this._errHandler.sync(this),e=this.interpreter.adaptivePredict(this._input,1,this._ctx);2!==e&&e!==Dt.ATN.INVALID_ALT_NUMBER;){if(1===e){if(null!=this._parseListeners&&this.triggerExitRuleEvent(),a=n,n=new Qt(t,i),this.pushNewRecursionContext(n,2,zt.RULE_object),this.state=40,!this.precpred(this._ctx,1))throw new Ft.FailedPredicateException(this,"this.precpred(this._ctx, 1)");this.state=41,this.logical_operator(),this.state=42,this.object(2)}this.state=48,this._errHandler.sync(this),e=this.interpreter.adaptivePredict(this._input,1,this._ctx)}}catch(e){if(!(e instanceof jt.RecognitionException))throw e;n.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.unrollRecursionContexts(t)}return n}expr(){let e=new qt(this._ctx,this.state);this.enterRule(e,4,zt.RULE_expr);try{switch(this.state=70,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,2,this._ctx)){case 1:this.enterOuterAlt(e,1),this.state=49,this.key();break;case 2:this.enterOuterAlt(e,2),this.state=50,this.key(),this.state=51,this.boolean_operator(),this.state=52,this.value();break;case 3:this.enterOuterAlt(e,3),this.state=54,this.key(),this.state=55,this.numeric_compare_operator(),this.state=56,this.numerical_value();break;case 4:this.enterOuterAlt(e,4),this.state=58,this.key(),this.state=59,this.string_compare_operator(),this.state=60,this.array();break;case 5:this.enterOuterAlt(e,5),this.state=62,this.key(),this.state=63,this.string_compare_operator(),this.state=64,this.value();break;case 6:this.enterOuterAlt(e,6),this.state=66,this.key(),this.state=67,this.array_operator(),this.state=68,this.array()}}catch(t){if(!(t instanceof jt.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}logical_operator(){let e,t=new Zt(this._ctx,this.state);this.enterRule(t,6,zt.RULE_logical_operator);try{this.enterOuterAlt(t,1),this.state=72,e=this._input.LA(1),e!==zt.OR&&e!==zt.AND?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}boolean_operator(){let e,t=new Wt(this._ctx,this.state);this.enterRule(t,8,zt.RULE_boolean_operator);try{this.enterOuterAlt(t,1),this.state=74,e=this._input.LA(1),e!==zt.EQUAL&&e!==zt.NOTEQUAL?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}numeric_compare_operator(){let e,t=new $t(this._ctx,this.state);this.enterRule(t,10,zt.RULE_numeric_compare_operator);try{this.enterOuterAlt(t,1),this.state=76,e=this._input.LA(1),0!=(-32&e)||0==(1<<e&(1<<zt.GT|1<<zt.GTE|1<<zt.LT|1<<zt.LTE))?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}string_compare_operator(){let e,t=new Kt(this._ctx,this.state);this.enterRule(t,12,zt.RULE_string_compare_operator);try{this.enterOuterAlt(t,1),this.state=78,e=this._input.LA(1),e!==zt.CONTAINS&&e!==zt.MATCHES?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}array_operator(){let e,t=new Yt(this._ctx,this.state);this.enterRule(t,14,zt.RULE_array_operator);try{this.enterOuterAlt(t,1),this.state=80,e=this._input.LA(1),e!==zt.CONTAINS&&e!==zt.IN?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}array(){let e,t=new Xt(this._ctx,this.state);this.enterRule(t,16,zt.RULE_array);try{switch(this.state=95,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,4,this._ctx)){case 1:for(this.enterOuterAlt(t,1),this.state=82,this.match(zt.T__2),this.state=83,this.value(),this.state=88,this._errHandler.sync(this),e=this._input.LA(1);e===zt.T__3;)this.state=84,this.match(zt.T__3),this.state=85,this.value(),this.state=90,this._errHandler.sync(this),e=this._input.LA(1);this.state=91,this.match(zt.T__4);break;case 2:this.enterOuterAlt(t,2),this.state=93,this.match(zt.T__2),this.state=94,this.match(zt.T__4)}}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}numerical_value(){let e,t=new Jt(this._ctx,this.state);this.enterRule(t,18,zt.RULE_numerical_value);try{this.enterOuterAlt(t,1),this.state=97,e=this._input.LA(1),e!==zt.QUOTED_NUMBER&&e!==zt.NUMBER?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}value(){let e,t=new ei(this._ctx,this.state);this.enterRule(t,20,zt.RULE_value);try{this.enterOuterAlt(t,1),this.state=99,e=this._input.LA(1),0!=(-32&e)||0==(1<<e&(1<<zt.QUOTED_NUMBER|1<<zt.NUMBER|1<<zt.STRING))?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}negative_expr(){let e,t=new ti(this._ctx,this.state);this.enterRule(t,22,zt.RULE_negative_expr);try{this.enterOuterAlt(t,1),this.state=101,e=this._input.LA(1),e!==zt.NOT&&e!==zt.NEG?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}key(){let e,t=new ii(this._ctx,this.state);this.enterRule(t,24,zt.RULE_key);try{this.enterOuterAlt(t,1),this.state=103,e=this._input.LA(1),e!==zt.SIMPLETEXT&&e!==zt.STRING?this._errHandler.recoverInline(this):(this._input.LA(1)===Gt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(e){if(!(e instanceof jt.RecognitionException))throw e;t.exception=e,this._errHandler.reportError(this,e),this._errHandler.recover(this,e)}finally{this.exitRule()}return t}sempred(e,t,i){switch(t){case 1:return this.object_sempred(e,i)}return!0}object_sempred(e,t){switch(t){case 0:return this.precpred(this._ctx,1)}return!0}static get _ATN(){return zt.__ATN||(zt.__ATN=(new It.ATNDeserializer).deserialize(kt.toCharArray(zt._serializedATN))),zt.__ATN}}zt.T__0=1,zt.T__1=2,zt.T__2=3,zt.T__3=4,zt.T__4=5,zt.OR=6,zt.AND=7,zt.NOT=8,zt.EQUAL=9,zt.NOTEQUAL=10,zt.CONTAINS=11,zt.MATCHES=12,zt.NEG=13,zt.GT=14,zt.GTE=15,zt.LT=16,zt.LTE=17,zt.IN=18,zt.QUOTED_NUMBER=19,zt.NUMBER=20,zt.FLOAT=21,zt.INTEGER=22,zt.SIMPLETEXT=23,zt.STRING=24,zt.WS=25,zt.RULE_expression=0,zt.RULE_object=1,zt.RULE_expr=2,zt.RULE_logical_operator=3,zt.RULE_boolean_operator=4,zt.RULE_numeric_compare_operator=5,zt.RULE_string_compare_operator=6,zt.RULE_array_operator=7,zt.RULE_array=8,zt.RULE_numerical_value=9,zt.RULE_value=10,zt.RULE_negative_expr=11,zt.RULE_key=12,zt.ruleNames=["expression","object","expr","logical_operator","boolean_operator","numeric_compare_operator","string_compare_operator","array_operator","array","numerical_value","value","negative_expr","key"],zt._LITERAL_NAMES=[void 0,"'('","')'","'['","','","']'",void 0,void 0,void 0,"'='","'!='",void 0,void 0,void 0,"'>'","'>='","'<'","'<='"],zt._SYMBOLIC_NAMES=[void 0,void 0,void 0,void 0,void 0,void 0,"OR","AND","NOT","EQUAL","NOTEQUAL","CONTAINS","MATCHES","NEG","GT","GTE","LT","LTE","IN","QUOTED_NUMBER","NUMBER","FLOAT","INTEGER","SIMPLETEXT","STRING","WS"],zt.VOCABULARY=new At.VocabularyImpl(zt._LITERAL_NAMES,zt._SYMBOLIC_NAMES,[]),zt._serializedATN="줝쪺֍꾺体؇쉁l\t\t\t\t\t\t\b\t\b\t\t\t\n\t\n\v\t\v\f\t\f\r\t\r\t)\n/\n\f2\vI\n\b\b\t\t\n\n\n\n\nY\n\n\f\n\n\\\v\n\n\n\n\n\nb\n\n\v\v\f\f\r\r\b\n\f\v\b\t\v\f\r\r\r\n\nh(H\bJ\nL\fNPRacegi \b !\r!\"\")#)$%%&&'')((#($)0*+\f+,\b,--/.*/20.011203I4556\n67\f7I899:\f:;\v;I<==>\b>?\n?I@AAB\bBC\fCIDEEF\tFG\nGIH3H4H8H<H@HDIJK\tK\tLM\tM\vNO\tO\rPQ\tQRS\tSTUUZ\fVWWY\fXVY\\ZXZ[[]\\Z]^^b_``baTa_bcd\tdef\t\bfgh\t\thij\t\nj(0HZa";class Ht extends Bt.ParserRuleContext{object(){return this.getRuleContext(0,Qt)}EOF(){return this.getToken(zt.EOF,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_expression}enterRule(e){e.enterExpression&&e.enterExpression(this)}exitRule(e){e.exitExpression&&e.exitExpression(this)}accept(e){return e.visitExpression?e.visitExpression(this):e.visitChildren(this)}}class Qt extends Bt.ParserRuleContext{negative_expr(){return this.tryGetRuleContext(0,ti)}object(e){return void 0===e?this.getRuleContexts(Qt):this.getRuleContext(e,Qt)}expr(){return this.tryGetRuleContext(0,qt)}logical_operator(){return this.tryGetRuleContext(0,Zt)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_object}enterRule(e){e.enterObject&&e.enterObject(this)}exitRule(e){e.exitObject&&e.exitObject(this)}accept(e){return e.visitObject?e.visitObject(this):e.visitChildren(this)}}class qt extends Bt.ParserRuleContext{key(){return this.getRuleContext(0,ii)}boolean_operator(){return this.tryGetRuleContext(0,Wt)}value(){return this.tryGetRuleContext(0,ei)}numeric_compare_operator(){return this.tryGetRuleContext(0,$t)}numerical_value(){return this.tryGetRuleContext(0,Jt)}string_compare_operator(){return this.tryGetRuleContext(0,Kt)}array(){return this.tryGetRuleContext(0,Xt)}array_operator(){return this.tryGetRuleContext(0,Yt)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_expr}enterRule(e){e.enterExpr&&e.enterExpr(this)}exitRule(e){e.exitExpr&&e.exitExpr(this)}accept(e){return e.visitExpr?e.visitExpr(this):e.visitChildren(this)}}class Zt extends Bt.ParserRuleContext{AND(){return this.tryGetToken(zt.AND,0)}OR(){return this.tryGetToken(zt.OR,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_logical_operator}enterRule(e){e.enterLogical_operator&&e.enterLogical_operator(this)}exitRule(e){e.exitLogical_operator&&e.exitLogical_operator(this)}accept(e){return e.visitLogical_operator?e.visitLogical_operator(this):e.visitChildren(this)}}class Wt extends Bt.ParserRuleContext{EQUAL(){return this.tryGetToken(zt.EQUAL,0)}NOTEQUAL(){return this.tryGetToken(zt.NOTEQUAL,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_boolean_operator}enterRule(e){e.enterBoolean_operator&&e.enterBoolean_operator(this)}exitRule(e){e.exitBoolean_operator&&e.exitBoolean_operator(this)}accept(e){return e.visitBoolean_operator?e.visitBoolean_operator(this):e.visitChildren(this)}}class $t extends Bt.ParserRuleContext{GT(){return this.tryGetToken(zt.GT,0)}GTE(){return this.tryGetToken(zt.GTE,0)}LT(){return this.tryGetToken(zt.LT,0)}LTE(){return this.tryGetToken(zt.LTE,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_numeric_compare_operator}enterRule(e){e.enterNumeric_compare_operator&&e.enterNumeric_compare_operator(this)}exitRule(e){e.exitNumeric_compare_operator&&e.exitNumeric_compare_operator(this)}accept(e){return e.visitNumeric_compare_operator?e.visitNumeric_compare_operator(this):e.visitChildren(this)}}class Kt extends Bt.ParserRuleContext{CONTAINS(){return this.tryGetToken(zt.CONTAINS,0)}MATCHES(){return this.tryGetToken(zt.MATCHES,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_string_compare_operator}enterRule(e){e.enterString_compare_operator&&e.enterString_compare_operator(this)}exitRule(e){e.exitString_compare_operator&&e.exitString_compare_operator(this)}accept(e){return e.visitString_compare_operator?e.visitString_compare_operator(this):e.visitChildren(this)}}class Yt extends Bt.ParserRuleContext{IN(){return this.tryGetToken(zt.IN,0)}CONTAINS(){return this.tryGetToken(zt.CONTAINS,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_array_operator}enterRule(e){e.enterArray_operator&&e.enterArray_operator(this)}exitRule(e){e.exitArray_operator&&e.exitArray_operator(this)}accept(e){return e.visitArray_operator?e.visitArray_operator(this):e.visitChildren(this)}}class Xt extends Bt.ParserRuleContext{value(e){return void 0===e?this.getRuleContexts(ei):this.getRuleContext(e,ei)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_array}enterRule(e){e.enterArray&&e.enterArray(this)}exitRule(e){e.exitArray&&e.exitArray(this)}accept(e){return e.visitArray?e.visitArray(this):e.visitChildren(this)}}class Jt extends Bt.ParserRuleContext{NUMBER(){return this.tryGetToken(zt.NUMBER,0)}QUOTED_NUMBER(){return this.tryGetToken(zt.QUOTED_NUMBER,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_numerical_value}enterRule(e){e.enterNumerical_value&&e.enterNumerical_value(this)}exitRule(e){e.exitNumerical_value&&e.exitNumerical_value(this)}accept(e){return e.visitNumerical_value?e.visitNumerical_value(this):e.visitChildren(this)}}class ei extends Bt.ParserRuleContext{NUMBER(){return this.tryGetToken(zt.NUMBER,0)}QUOTED_NUMBER(){return this.tryGetToken(zt.QUOTED_NUMBER,0)}STRING(){return this.tryGetToken(zt.STRING,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_value}enterRule(e){e.enterValue&&e.enterValue(this)}exitRule(e){e.exitValue&&e.exitValue(this)}accept(e){return e.visitValue?e.visitValue(this):e.visitChildren(this)}}class ti extends Bt.ParserRuleContext{NEG(){return this.tryGetToken(zt.NEG,0)}NOT(){return this.tryGetToken(zt.NOT,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_negative_expr}enterRule(e){e.enterNegative_expr&&e.enterNegative_expr(this)}exitRule(e){e.exitNegative_expr&&e.exitNegative_expr(this)}accept(e){return e.visitNegative_expr?e.visitNegative_expr(this):e.visitChildren(this)}}class ii extends Bt.ParserRuleContext{SIMPLETEXT(){return this.tryGetToken(zt.SIMPLETEXT,0)}STRING(){return this.tryGetToken(zt.STRING,0)}constructor(e,t){super(e,t)}get ruleIndex(){return zt.RULE_key}enterRule(e){e.enterKey&&e.enterKey(this)}exitRule(e){e.exitKey&&e.exitKey(this)}accept(e){return e.visitKey?e.visitKey(this):e.visitChildren(this)}}var ni,ai=i(15822);!function(e){e.FACT="FACT",e.VALUE="VALUE",e.LOGICAL_OPERATOR="LOGICAL_OPERATOR",e.BOOLEAN_OPERATOR="BOOLEAN_OPERATOR",e.NUMERIC_COMPARE_OPERATOR="NUMERIC_COMPARE_OPERATOR",e.OPEN_ROUND_BRACKET="OPEN_ROUND_BRACKET",e.CLOSE_ROUND_BRACKET="CLOSE_ROUND_BRACKET",e.UNKNOWN="UNKNOWN",e.ERROR="ERROR"}(ni||(ni={}));const ri=e=>({type:ni.FACT,value:e}),oi=e=>({type:ni.VALUE,value:e}),li=e=>({type:ni.CLOSE_ROUND_BRACKET,value:e}),si=e=>({type:ni.UNKNOWN,value:e});class ci extends ai.AbstractParseTreeVisitor{defaultResult(){return[]}aggregateResult(e,t){const i=0===(n=e.filter((e=>e.type!==ni.ERROR))).length?void 0:n[n.length-1];var n;const a=(e=>0===e.length?void 0:e[0])(t.filter((e=>e.type!==ni.ERROR)));return i&&a&&i.type===ni.LOGICAL_OPERATOR&&a.type===ni.LOGICAL_OPERATOR&&(a.type=ni.ERROR),[...e,...t]}visitTerminal(e){return e.symbol.type===Nt.Token.EOF?[]:"("===e.text?[("(",{type:ni.OPEN_ROUND_BRACKET,value:"("})]:")"===e.text?[li(")")]:[si(e.text)]}visitErrorNode(e){return"<missing ')'>"===e.text?[li(")")]:[(t=e.text,{type:ni.ERROR,value:t})];var t}visitLogical_operator(e){return[(t=e.text,{type:ni.LOGICAL_OPERATOR,value:t})];var t}visitBoolean_operator(e){return[(t=e.text,{type:ni.BOOLEAN_OPERATOR,value:t})];var t}visitNumeric_compare_operator(e){return[(t=e.text,{type:ni.NUMERIC_COMPARE_OPERATOR,value:t})];var t}visitKey(e){var t;const i=e.SIMPLETEXT();if(i)return[ri(i.text)];const n=null===(t=e.STRING())||void 0===t?void 0:t.text;return n&&n.length>=2?[ri(n.substr(1,n.length-2))]:[ri("")]}visitValue(e){const t=e.NUMBER()||e.STRING();if(!t){if(e.parent instanceof qt||e.parent,e.text)return e.childCount>1&&e.start.inputStream&&e.stop?[oi(`"${e.start.inputStream.toString().slice(e.start.startIndex,e.stop.stopIndex+1)}"`)]:[oi(`"${e.text}"`)];if(e.start.inputStream&&e.stop&&e.stop.text){let t=e.start.inputStream.toString().slice(e.stop.stopIndex+1,e.start.startIndex).trimLeft();return t.startsWith('"')&&!t.endsWith('"')?t+='"':t.startsWith("'")&&!t.endsWith("'")&&(t+="'"),[oi(t)]}return this.visitChildren(e)}return[oi(t.text)]}visitNumerical_value(e){return[oi(e.text)]}}const di=e=>e.map((e=>e.value)).join(" "),ui=(0,u.style)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),pi=(e,t)=>{try{const o=((e,t)=>{const i=(e=>{const t=Nt.CharStreams.fromString(e),i=new Lt(t);i.removeErrorListeners();const n=new Nt.CommonTokenStream(i),a=new zt(n);return a.removeErrorListeners(),a})(e).expression(),n=(new ci).visit(i).filter((e=>e.type!==ni.ERROR));let a=n.pop();const r=[];if(void 0===a)return{prefix:"",options:t.slice(0,10).map((e=>e.name||"")),postfix:""};for(;a.type===ni.CLOSE_ROUND_BRACKET;){const e=n.pop();if(void 0===e)break;r.unshift(a),a=e}const o=di(n),l=di(r),s=a;return s.type===ni.FACT?{prefix:o,options:t.filter((e=>e.name&&e.name.toUpperCase().includes(s.value.toUpperCase()))).slice(0,10).map((e=>e.name||"")),postfix:l}:(r.unshift(s),{prefix:o,options:[],postfix:di(r)})})(e,t);if(o)return i=o.prefix,n=o.options,a=o.postfix,(i=i.trim()).length>0&&n.length>0&&(i+=" "),a.length>0&&n.length>0&&(a=" "+a),(n||[" "]).map((e=>r.createElement(s.SelectOption,{className:ui,key:i+e+a,value:i+e+a},i,r.createElement("b",null,e),a)))}catch(t){console.log(`Exception when computing options for condition [${e}]`,t)}var i,n,a;return[]},mi=e=>{const{facts:t,onSelect:i,value:n}=e,[a,o]=r.useState(!1),[l,c]=r.useState(),d=r.useCallback((e=>pi(e,t)),[t]),u=r.useCallback((e=>{var t,i;const a=d(n);if(e){let e=a.length>0;1===a.length&&(null===(i=null===(t=a[0])||void 0===t?void 0:t.props)||void 0===i?void 0:i.value)===n&&(e=!1),o(e)}c(a)}),[n,d,c]);(0,xt.Z)((()=>{u(!0)}),[u]),(0,Ot.Z)((()=>{u(!1)}));const m=r.useCallback(((e,t)=>{e&&i(t)}),[i]),g=r.useCallback(((e,t)=>{i(t.toString()),c((e=>(e&&1===e.length&&e[0].props.value===t&&o(!1),e)))}),[i]),y=r.useCallback((()=>{i("")}),[i]),h=r.useCallback((e=>{o(e)}),[]);return r.createElement(s.Select,Object.assign({},p("ConditionField",e),{label:e.label,toggleId:e.id,name:e.name,onToggle:h,isOpen:a,selections:n,variant:s.SelectVariant.typeahead,onSelect:g,onFilter:m,onClear:y,typeAheadAriaLabel:"Condition writer",style:{maxWidth:"100%"}}),l)};const gi=e=>{const{hint:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}(e,["hint"]),[n,a,{setValue:o}]=(0,$e.useField)(Object.assign({},i)),l=!a.error||!a.touched,c=r.useCallback((e=>{o(e)}),[o]);return r.createElement(s.FormGroup,{fieldId:e.id,helperTextInvalid:a.error,isRequired:e.isRequired,validated:l?"default":"error",label:e.label},r.createElement(mi,Object.assign({},i,n,{value:n.value?n.value.toString():"",onSelect:c})),t&&r.createElement(s.Text,{component:s.TextVariants.small},t))},yi=(0,u.style)({fontFamily:"monospace",fontSize:"14px",fontStyle:"default"}),hi=(0,u.style)({marginBottom:5}),Ei=(0,u.style)({marginLeft:20});class vi extends r.Component{render(){return r.createElement(s.TextContent,{className:Ei},r.createElement(s.Text,{component:s.TextVariants.p},h.wizards.policy.hints.hintParagraph1),r.createElement(s.Text,{component:s.TextVariants.a,className:hi,href:be.pages.factsDocumentation,target:"_blank",rel:"noopener noreferrer"},h.wizards.policy.hints.hintLinkTitle),r.createElement(s.Text,{component:s.TextVariants.h5,className:"lg"},h.wizards.policy.hints.hintSyntaxExamplesSection),r.createElement(s.Text,null,h.wizards.policy.hints.hintQuestion1),r.createElement(s.Text,{component:s.TextVariants.p,className:yi},r.createElement("i",null,h.wizards.policy.hints.hintQuestion1Ans)),r.createElement(s.Text,null,h.wizards.policy.hints.hintQuestion2),r.createElement(s.Text,{component:s.TextVariants.p,className:yi},r.createElement("i",null,h.wizards.policy.hints.hintQuestion2Ans)),r.createElement(s.Text,null,h.wizards.policy.hints.hintQuestion3),r.createElement(s.Text,{component:s.TextVariants.p,className:yi},r.createElement("i",null,h.wizards.policy.hints.hintQuestion3Ans)),r.createElement(s.Text,null,h.wizards.policy.hints.hintQuestion4),r.createElement(s.Text,{component:s.TextVariants.p,className:yi},r.createElement("i",null,h.wizards.policy.hints.hintQuestion4Ans)))}}const bi=e=>r.createElement(r.Fragment,null,r.createElement(s.StackItem,Object.assign({},p("Policy/Wizard/Usage",e)),r.createElement(s.ExpandableSection,{toggleText:h.wizards.policy.hints.hintTitle},r.createElement(vi,null)))),fi=(0,u.style)({marginTop:"auto",marginBottom:"auto",marginLeft:8}),_i=(0,u.style)({width:"100%"}),Ti=(0,u.style)({marginTop:12}),Ci=(0,u.style)({color:ot.ZP.var}),Pi=(0,u.style)({color:St.ZP.var}),Si=(0,u.style)({fontWeight:"bold"}),xi=(0,u.style)({marginBottom:5}),Oi=e=>e.loading?r.createElement(s.Split,null,r.createElement(s.SplitItem,null,r.createElement("span",{className:fi},r.createElement(s.Spinner,{size:"md"})),r.createElement("span",{className:fi}," ",h.wizards.policy.conditions.validating," "))):e.changed?null:e.isValid?r.createElement(s.Split,null,r.createElement(s.SplitItem,null,r.createElement(N.ZP,{className:fi,color:St.ZP.value})),r.createElement(s.SplitItem,null,r.createElement("div",{className:(0,a.joinClasses)(fi,Pi,Si)},h.wizards.policy.conditions.valid))):e.error?r.createElement(s.Stack,null,r.createElement(s.StackItem,null,r.createElement(s.Split,null,r.createElement(s.SplitItem,null,r.createElement(rt.ZP,{className:fi,color:ot.ZP.value})),r.createElement(s.SplitItem,null,r.createElement("div",{className:(0,a.joinClasses)(fi,Ci,Si)},h.wizards.policy.conditions.invalid)))),r.createElement(s.StackItem,null,r.createElement("div",{className:(0,a.joinClasses)(fi,Ci)}," ",e.error," "))):null,Ni=()=>{var e;const t=r.useContext(lt),{values:i}=(0,$e.useFormikContext)(),n=!i.conditions||""===i.conditions||t.isLoading;return r.createElement(a.Form,{ouiaId:"condition-step"},r.createElement(s.Title,{className:xi,headingLevel:"h4",size:"xl"},h.wizards.policy.conditions.title),h.wizards.policy.conditions.summaryDesc,r.createElement(gi,{ouiaId:"conditions",label:"Condition text",id:"conditions",name:"conditions",facts:t.facts||[],hint:h.wizards.policy.conditions.hint}),r.createElement(s.Stack,{className:_i},r.createElement(s.StackItem,null,r.createElement(s.Button,{onClick:()=>{t.triggerAction(at.VALIDATE_CONDITION)},isDisabled:n,variant:s.ButtonVariant.secondary},"Validate condition")),r.createElement(s.StackItem,{className:Ti},r.createElement(Oi,Object.assign({loading:t.isLoading},t.verifyResponse,{changed:(null===(e=t.verifyResponse.policy)||void 0===e?void 0:e.conditions)!==i.conditions})))),r.createElement(bi,null))},Ii=r.createContext(void 0),Ri=e=>{var t;const[i,n]=r.useState(!1),[o,l]=r.useState({}),s=Ce(void 0,!1),c=(0,a.useSort)(),d=Pe(s.debouncedFilters,5,c.sortBy),u=He(d.page,!1);let p,m=0;"PagedResponseOfPolicy"===(null===(t=u.payload)||void 0===t?void 0:t.type)&&(p=u.payload.value.data,m=u.payload.value.count);const g=Le(p,u.loading,m,d.page),{query:y}=u;return(0,xt.Z)((()=>{e.showCreateStep&&y()}),[y,d.page,s.debouncedFilters,e.showCreateStep]),e.showCreateStep?r.createElement(Ii.Provider,{value:{copyPolicy:i,setCopyPolicy:n,copiedPolicy:o,setCopiedPolicy:l,policyFilter:s,policyPage:d,policySort:c,policyQuery:u,policyRows:g}},e.children):r.createElement(r.Fragment,null,e.children)},wi=e=>{var t;const{policyFilter:i,policyPage:n,policySort:a,policyQuery:o,policyRows:l}=e;(0,Ot.Z)((()=>{o.payload||o.query()}));const s=e.onSelect,c=o.payload,d=l.onSelect,u=r.useCallback(((e,t,i)=>{d(e,t,i),c&&"PagedResponseOfPolicy"===c.type&&i&&s(c.value.data[t])}),[s,d,c]),{pageCount:p,count:m}="PagedResponseOfPolicy"===(null===(t=o.payload)||void 0===t?void 0:t.type)?{count:o.payload.value.count,pageCount:o.payload.value.data.length}:{count:void 0,pageCount:void 0};return r.createElement(r.Fragment,null,r.createElement(Ee,{ouiaId:"copy-from-policy-toolbar",onPaginationChanged:n.changePage,page:n.page.index,pageCount:p,perPage:n.page.size,showPerPageOptions:!1,hideActions:!0,hideBulkSelect:!0,filters:i.filters,setFilters:i.setFilters,clearFilters:i.clearFilter,count:m},r.createElement(pe,{ouiaId:"copy-from-policy-table",columnsToShow:["radioSelect","name","actions"],policies:l.rows,onSelect:u,loading:o.loading,loadingRowCount:5,onSort:a.onSort,sortBy:a.sortBy,linkToDetailPolicy:!1})))};const Ai="pf-u-mb-sm",ki="pf-c-radio",Li=()=>{const{copyPolicy:e,createFromScratch:t,copyExisting:i,copyFromPolicyHandler:n,copyFromPolicyProps:o}=(()=>{const e=r.useContext(Ii);if(void 0===e)throw Error("Invalid usage of CreatePolicyStep without valid context");const{copyPolicy:t,setCopyPolicy:i,copiedPolicy:n,setCopiedPolicy:a}=e,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}(e,["copyPolicy","setCopyPolicy","copiedPolicy","setCopiedPolicy"]),{clearSelection:l}=o.policyRows,{validate:s,validateField:c,setValues:d,setFieldValue:u}=(0,$e.useFormikContext)(),{setVerifyResponse:p,setMaxStep:m}=(0,r.useContext)(lt),g=r.useCallback((()=>{i(!1),a({})}),[i,a]),y=r.useCallback((()=>{i(!0),a(void 0)}),[i,a]);(0,xt.Z)((()=>{n&&(d(n),t&&p({policy:n,isValid:!0})),m(0),u("isValid",!!n),s&&c("isValid")}),[t,n,s,c,u,d,p]),r.useEffect((()=>{t||l()}),[t,l]);const h=r.useCallback((e=>{a(Ge(e))}),[a]);return{copyPolicy:t,createFromScratch:g,copyExisting:y,copyFromPolicyHandler:h,copyFromPolicyProps:o}})();return r.createElement(r.Fragment,null,r.createElement(a.Form,{ouiaId:"create-policy-step",className:"pf-c-form"},r.createElement("div",{className:"pf-c-form__group"},r.createElement(s.Title,{headingLevel:"h4",size:"xl",className:Ai},h.wizards.policy.createPolicy.title),r.createElement(s.Text,{className:(0,a.joinClasses)(Ai,"pf-c-title pf-m-sm"),component:s.TextVariants.h6},"Define a new policy:"),r.createElement(s.Radio,{isChecked:!e,name:"new-policy",value:"from-scratch",id:"create-new-custom-policy-from-scratch",onChange:t,label:"From scratch",className:(0,a.joinClasses)(Ai,ki)}),r.createElement(s.Radio,{isChecked:e,name:"new-policy",value:"as-copy",id:"create-new-custom-policy-as-copy",onChange:i,label:"As a copy of existing Policy",className:(0,a.joinClasses)(Ai,ki)}),e&&r.createElement(r.Fragment,null,r.createElement(wi,Object.assign({onSelect:n},o))))))},Di=()=>r.createElement(a.Form,{ouiaId:"detail-step"},r.createElement(s.Title,{headingLevel:"h4",size:"xl"},h.wizards.policy.details.title),r.createElement(a.FormTextInput,{ouiaId:"name",maxLength:150,isRequired:!0,label:"Name",type:"text",name:"name",id:"name"}),r.createElement(a.FormTextArea,{ouiaId:"description",label:"Description",type:"text",id:"description",name:"description",resizeOrientation:"vertical"})),Fi=(0,u.style)(Object.assign(Object.assign({backgroundColor:B.ZP.var},(0,U.padding)(18,14)),{margin:5})),Mi=()=>{const e=(0,r.useContext)(lt),{values:t}=(0,$e.useFormikContext)();return r.createElement(r.Fragment,null,r.createElement(a.Form,{ouiaId:"review-step"},r.createElement(s.Title,{headingLevel:"h2",size:"xl"},h.wizards.policy.review.title),r.createElement(a.Switch,{ouiaId:"is-enabled",isDisabled:e.isLoading,id:"isEnabled",name:"isEnabled",labelOn:h.wizards.policy.review.policyIsEnabled,labelOff:h.wizards.policy.review.policyIsDisabled,label:h.wizards.policy.review.enableThisPolicy}),r.createElement(s.Title,{headingLevel:"h2",size:"md"},h.wizards.policy.review.policy.details),r.createElement(a.FormText,{ouiaId:"name",label:h.wizards.policy.review.policy.name,name:"name",id:"name"}),r.createElement(a.FormText,{ouiaId:"description",label:h.wizards.policy.review.policy.description,name:"description",id:"description"}),r.createElement("div",{className:Fi},r.createElement(W,{ouiaId:"review-step.conditions",conditions:t.conditions})),r.createElement("div",{className:Fi},r.createElement(q,{ouiaId:"review-step.actions",actions:t.actions||[]}))))},Vi=(e,t,i,n,a)=>!a&&(e===i||(t?e<=n:e<=i)),Bi=(e,t)=>!t&&e,Ui=e=>{const t=(0,$e.useFormikContext)(),i=t.validateForm,n=t.handleSubmit;r.useEffect((()=>{i()}),[e.currentStep,i]),r.useEffect((()=>{e.triggeredAction!==at.NONE&&n()}),[e.triggeredAction,n]);const a={isLoading:e.isLoading,isFormValid:t.isValid,triggerAction:e.triggerAction,verifyResponse:e.verifyResponse,createResponse:e.createResponse,setVerifyResponse:e.setVerifyResponse,facts:e.facts,setMaxStep:e.setMaxStep},o=e.steps[e.currentStep],l=((e,t,i)=>e.isValid?e.isValid(t,i):t.isFormValid)(o,a,t.values);a.isValid=l;const c=e.steps.map((t=>Object.assign(Object.assign({},t),{enableNext:Bi(l,e.isLoading),canJumpTo:Vi(t.id,l,e.currentStep,e.maxStep,e.isLoading)})));return r.createElement(s.Form,null,r.createElement(lt.Provider,{value:a},r.createElement(s.Wizard,{isOpen:!0,onSave:()=>{e.triggerAction(at.SAVE)},onClose:e.onClose,steps:c,startAtStep:e.currentStep+1,onNext:e.onMove,onBack:e.onMove,onGoToStep:e.onMove,title:e.isEditing?h.wizards.policy.titleEdit:h.wizards.policy.titleNew,description:h.wizards.policy.description,footer:r.createElement(dt,{onNext:o.onNext,loadingText:"Loading",isLoading:e.isLoading,error:e.createResponse.error})})))},ji=e=>{const[t,i]=r.useState(0),[n,a]=r.useState(0),[o,l]=r.useState({type:at.NONE}),[s,c]=r.useState({isValid:!1}),d=(0,Ke.Z)(),[u,p]=r.useState({created:!1}),m=r.useCallback((e=>{let t,i;const n=new Promise(((e,n)=>{t=e,i=n}));return l((n=>(n.rejecter&&n.rejecter(),{type:e,resolver:t,rejecter:i}))),n}),[l]),g=r.useCallback((e=>{l((t=>(e&&t.resolver?t.resolver():t.rejecter&&t.rejecter(),{type:at.NONE})))}),[l]);r.useEffect((()=>{var t;(null===(t=e.initialValue)||void 0===t?void 0:t.conditions)&&c({isValid:!0,policy:e.initialValue})}),[e.initialValue]);const y=(e=>{const t=[];return e&&t.push(Object.assign({name:h.wizards.policy.createPolicy.title,component:r.createElement(Li,null),validationSchema:Ye.Ry().shape({isValid:Ye.O7().oneOf([!0])})},void 0)),t.push(Object.assign({name:h.wizards.policy.details.title,component:r.createElement(Di,null),validationSchema:et,onNext:(e,t)=>{e.triggerAction(at.VALIDATE_NAME).then(t).catch((e=>{console.error("Error when validating:",e)}))}},void 0),Object.assign({name:h.wizards.policy.conditions.title,component:r.createElement(Ni,null),validationSchema:it,isValid:(e,t)=>{var i;return t.conditions===(null===(i=e.verifyResponse.policy)||void 0===i?void 0:i.conditions)&&e.verifyResponse.isValid}},void 0),Object.assign({name:h.wizards.policy.actions.title,component:r.createElement(Pt,null),validationSchema:tt},void 0),Object.assign({name:h.wizards.policy.review.title,component:r.createElement(Mi,null),validationSchema:nt},{nextButtonText:"Finish"})),t.map(((e,t)=>Object.assign(Object.assign({},e),{id:t})))})(e.showCreateStep);return r.createElement(r.Fragment,null,r.createElement(Ri,{showCreateStep:e.showCreateStep},r.createElement($e.Formik,{initialValues:e.initialValue,initialStatus:{},validateOnMount:!1,validationSchema:y[t].validationSchema,onSubmit:(t,i)=>{i.setSubmitting(!1),l((e=>Object.assign(Object.assign({},e),{type:at.NONE})));const n=nt.cast(t);switch(i.setValues(n),o.type){case at.SAVE:e.onSave(n).then((e=>{d()&&(p(e),g(e.created))}));break;case at.VALIDATE_CONDITION:case at.NONE:case at.VALIDATE_NAME:break;default:(0,P.vE)(o.type)}},validate:t=>{const i=nt.cast(t);switch(o.type){case at.SAVE:case at.NONE:break;case at.VALIDATE_CONDITION:e.onVerify(i).then((e=>{c(e),g(e.isValid)}));break;case at.VALIDATE_NAME:e.onValidateName(i).then((e=>{p(e),g(!e.error)}));break;default:(0,P.vE)(o.type)}}},r.createElement(Ui,{currentStep:t,maxStep:n,isLoading:e.isLoading,triggeredAction:o.type,triggerAction:m,steps:y,verifyResponse:s,createResponse:u,setVerifyResponse:c,onClose:e.onClose,onMove:(e,t)=>{const r=e.id;i(r),r>n&&a(r)},showCreateStep:e.showCreateStep,facts:e.facts,setMaxStep:a,isEditing:e.isEditing}))))},Gi=xe.GetFacts.actionCreator,zi=e=>e.id?xe.PutPoliciesByPolicyId.actionCreator({policyId:e.id,body:Ue(e)}):xe.PostPolicies.actionCreator({alsoStore:!0,body:Ue(e)}),Hi=(0,Ne.validationResponseTransformer)((e=>"Policy"===e.type?(0,Ne.validatedResponse)("Policy",e.status,je(e.value),e.errors):e)),Qi=e=>{var t;return xe.PostPoliciesValidateName.actionCreator({body:null!==(t=e.name)&&void 0!==t?t:"",id:e.id})},qi=e=>xe.PostPoliciesValidate.actionCreator({body:Ue(e)}),Zi=e=>{const t=(0,a.useTransformQueryResponse)((0,Oe.useMutation)(zi),Hi),i=(0,Oe.useMutation)(qi),n=(0,Oe.useParameterizedQuery)(Qi),o=(()=>{const[e,t]=(0,r.useState)(),{payload:i}=(0,Oe.useQuery)(Gi(),!0);return(0,r.useEffect)((()=>{200===(null==i?void 0:i.status)&&t(i.value)}),[i,t]),e})(),l=r.useCallback((e=>(0,n.query)(e).then((e=>e.status===We.OK?{created:!1}:{created:!1,error:`Invalid name (Code: ${e.status})`}))),[n.query]),s=t.loading||i.loading||n.loading;return r.createElement(r.Fragment,null,e.isOpen&&r.createElement(ji,{initialValue:e.initialValue||{},onClose:()=>{e.close(void 0)},onSave:i=>t.mutate(i).then((t=>{var n,r,o;if("Policy"===(null===(n=t.payload)||void 0===n?void 0:n.type))return void 0===i.id?(0,a.addSuccessNotification)("Created",`Policy "${i.name}" created`):(0,a.addSuccessNotification)("Saved",`Policy "${i.name}" has been updated`),e.close&&e.close(t.payload.value),{created:!0};if(t.status===We.Hi&&void 0!==i.id)return{created:!1,error:"This policy cannot be found. It may have been deleted by another user. Your changes cannot be saved."};let l=`Unknown Error when trying to ${void 0===i.id?"create":"update"} the policy: (Code ${t.status})`;return"Msg"===(null===(r=t.payload)||void 0===r?void 0:r.type)&&(l=null!==(o=t.payload.value.msg)&&void 0!==o?o:l),{created:!1,error:l}})),onVerify:e=>i.mutate(e).then((t=>{var i;return t.status===We.OK?{isValid:!0,policy:e}:"Msg"===(null===(i=t.payload)||void 0===i?void 0:i.type)&&t.payload.value.msg?{isValid:!1,error:t.payload.value.msg,policy:e}:{isValid:!1,error:`Unknown Error when trying to validate: (Code ${t.status})`,policy:e}})),onValidateName:l,showCreateStep:!!e.policiesExist&&e.showCreateStep,isLoading:s,facts:o,isEditing:e.isEditing}))};const Wi=e=>{const t=r.useCallback((()=>{return t=void 0,i=void 0,r=function*(){const t=e.policy,i=e.onDelete,n=e.getPolicies;if(t)return i([t.id]);if(!n)throw new Error("Expected policy or getPolicies to bet set");try{return i(yield n())}catch(e){(0,a.addDangerNotification)("Error while removing","An error occurreds while trying to remove the selection, please try again."),console.error("Error while fetching selection",e)}return!1},new((n=void 0)||(n=Promise))((function(e,a){function o(e){try{s(r.next(e))}catch(e){a(e)}}function l(e){try{s(r.throw(e))}catch(e){a(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,l)}s((r=r.apply(t,i||[])).next())}));var t,i,n,r}),[e.onDelete,e.policy,e.getPolicies]),i=r.useMemo((()=>e.policy?r.createElement(r.Fragment,null,"Do you want to remove the policy ",r.createElement("b",null,e.policy.name),"?"):1===e.count?r.createElement(r.Fragment,null,"Do you want to remove the selected policy?"):r.createElement(r.Fragment,null,"Do you want to remove the ",r.createElement("b",null,e.count)," selected policies?")),[e.policy,e.count]);return e.policy||e.getPolicies?r.createElement(a.DeleteModal,{isOpen:!0,isDeleting:e.isDeleting,title:"Remove "+(1===e.count?"policy":"policies"),content:i,onClose:e.onClose,onDelete:t,error:e.error}):null},$i=e=>xe.DeletePoliciesIds.actionCreator({body:e}),Ki=e=>{const{onDeleted:t}=e,{mutate:i,loading:n}=(0,Oe.useMutation)($i),o=n||e.loading,l=r.useCallback((e=>i(e).then((i=>{var n;let r=e.length;if(200===(null===(n=i.payload)||void 0===n?void 0:n.status)){const n=i.payload.value;r=e.filter((e=>!n.includes(e))).length,i.payload.value.forEach((e=>t&&t(e)))}return r>0&&(1===r?(0,a.addDangerNotification)("Error removing policy","There was an error when trying to remove a policy."):(0,a.addDangerNotification)("Error removing policies",`There was an error when trying to remove ${r} policies.`)),r!==e.length}))),[i,t]);return r.createElement(Wi,{policy:e.policy,count:e.count,getPolicies:e.getPolicies,isDeleting:o,onClose:e.onClose,onDelete:l})};var Yi=i(96733);const Xi=()=>r.createElement("br",null),Ji=e=>r.createElement(g,{icon:Yi.ZP,title:h.pages.listPage.emptyState.title,content:(0,a.join)(h.pages.listPage.emptyState.text,Xi),action:e.createPolicy,actionLabel:"Create policy"});var en=i(89836),tn=i.n(en);class nn extends a.ExporterCsv{serialize(e){return Object.assign(Object.assign({},e),{actions:Ve(e.actions)})}headers(){return[["id","id"],["name","name"],["description","description"],["isEnabled","isEnabled"],["conditions","conditions"],["actions","actions"],["lastTriggered","lastTriggered"],["mtime","mtime"],["ctime","ctime"]]}}class an extends a.ExporterJson{}var rn=i(24094);const on=(0,u.style)({paddingBottom:0}),ln=e=>xe.GetPoliciesById.actionCreator({id:e}),sn=(0,Ne.validationResponseTransformer)((e=>"Policy"===e.type?(0,Ne.validatedResponse)("Policy",e.status,je(e.value),e.errors):e)),cn=e=>{const[t,i]=r.useState(!1),n=r.useCallback((()=>{i(!1)}),[]),a=r.useMemo((()=>{const t=e.changeEnabled,i=[];return e.isEnabled?i.push(r.createElement(s.DropdownItem,{isDisabled:e.loadingEnabledChange,onClick:()=>t(!1),key:"disable"},"Disable")):i.push(r.createElement(s.DropdownItem,{isDisabled:e.loadingEnabledChange,onClick:()=>t(!0),key:"enable"},"Enable")),i.push(r.createElement(s.DropdownItem,{key:"edit",onClick:e.edit},"Edit"),r.createElement(s.DropdownItem,{key:"duplicate",onClick:e.duplicate},"Duplicate"),r.createElement(s.DropdownItem,{key:"delete",onClick:e.delete},"Remove")),i}),[e.isEnabled,e.changeEnabled,e.edit,e.duplicate,e.delete,e.loadingEnabledChange]);return r.createElement(s.Dropdown,{position:s.DropdownPosition.right,onSelect:n,toggle:r.createElement(s.KebabToggle,{"data-testid":"policy-detail-actions-button",isDisabled:e.disabled,onToggle:i,id:"policy-detail-actions-menu"}),isOpen:t,isPlain:!0,dropdownItems:a})};var dn=i(16730);const un=e=>{const t=(0,v.k6)(),i=r.useCallback((()=>{t.push(Hn.listPage())}),[t]);return r.createElement(g,{icon:dn.ZP,title:h.pages.policyDetail.emptyState.title,content:(0,mt.WU)(h.pages.policyDetail.emptyState.text,e.policyId),actionLabel:h.pages.policyDetail.emptyState.backText,action:i})},pn=(e,t,i="br")=>r.useMemo((()=>{const n=(0,mt.WU)(e,...t);return i?(0,a.join)(n.split("\n"),i):n}),[i,...t]),mn=e=>{const t=pn(h.pages.policyDetail.errorState.text,[e.error]);return r.createElement(g,{icon:rt.ZP,iconColor:ot.ZP.value,title:h.pages.policyDetail.errorState.title,content:t,action:e.action,actionLabel:h.pages.policyDetail.errorState.actionText})};var gn,yn=i(3644);!function(e){e[e.EDIT=0]="EDIT",e[e.DUPLICATE=1]="DUPLICATE",e[e.CLOSE=2]="CLOSE"}(gn||(gn={}));const hn={isEditing:!1,initialValue:void 0,isOpen:!1},En=(0,u.style)({marginLeft:pt.ZP.var}),vn=e=>{if(e.loading)return r.createElement(s.Stack,{"data-testid":"loading"},r.createElement(s.StackItem,null,r.createElement(s.Skeleton,{width:"140px"})));const{icon:t,text:i}=e.isEnabled?{icon:r.createElement(I,null),text:"Enabled"}:{icon:r.createElement(O,null),text:"Disabled"};return r.createElement(s.Stack,null,r.createElement(s.StackItem,null,t,r.createElement("span",{className:En},i)))};var bn=i(60472);const fn=(0,u.style)({width:200}),_n=()=>r.createElement(r.Fragment,null,r.createElement(l.PageHeader,{"data-testid":"policy-loading"},r.createElement(s.Stack,null,r.createElement(s.StackItem,null,r.createElement(s.Breadcrumb,null,r.createElement(a.BreadcrumbLinkItem,{ouiaId:"to-list-page",to:Hn.listPage()},"Policies"),r.createElement(s.BreadcrumbItem,null,r.createElement(s.Skeleton,{className:fn})))),r.createElement(s.StackItem,null,r.createElement(s.Split,null,r.createElement(s.SplitItem,{isFilled:!0},r.createElement(l.PageHeaderTitle,{title:r.createElement(s.Skeleton,{width:"25%"})})),r.createElement(s.SplitItem,null,r.createElement(s.Button,{isDisabled:!0,variant:s.ButtonVariant.plain},r.createElement(bn.ZP,null))))))),r.createElement(l.Main,null,r.createElement(a.Section,{ouiaId:"loading-spinner"},r.createElement(s.Bullseye,null,r.createElement(l.Spinner,{centered:!0}))))),Tn=()=>r.createElement(g,{title:h.tables.trigger.emptyState.notFound.title,content:h.tables.trigger.emptyState.notFound.content}),Cn=[{title:h.tables.trigger.columns.date,transforms:[C.sortable],cellTransforms:[C.nowrap]},{title:h.tables.trigger.columns.system,transforms:[C.sortable],cellTransforms:[C.wrappable,C.breakWord]}],Pn=e=>{const t=r.useMemo((()=>{const t=e.rows;return t?t.map(((e,t)=>{return{id:`${e.id}-${t}`,key:`${e.id}-${t}`,cells:[{title:r.createElement(C.TableText,null,(0,$.Z)((0,a.toUtc)(e.created),"dd MMM yyyy HH:mm:ss")," UTC")},{title:e.id?r.createElement(C.TableText,null,r.createElement("a",{href:(i=e.id,(0,a.localUrl)(`/insights/inventory/${i}/`,(0,a.getInsights)().chrome.isBeta()))},e.hostName)):r.createElement(C.TableText,null,e.hostName)}]};var i})):[]}),[e.rows]),i=r.useCallback(((t,i,n)=>{const r=e.onSort;r&&r(i,0===i?"ctime":"name",n===C.SortByDirection.asc?a.Direction.ASCENDING:a.Direction.DESCENDING)}),[e.onSort]),n=r.useMemo((()=>{if(e.sortBy)return{index:"ctime"===e.sortBy.column?0:1,direction:e.sortBy.direction===a.Direction.ASCENDING?"asc":"desc"}}),[e.sortBy]);return e.loading?r.createElement(l.SkeletonTable,{testID:"trigger-table-loading",rowSize:10,columns:Cn,sortBy:n}):0===t.length?r.createElement(Tn,null):r.createElement("div",Object.assign({},p("Trigger/Table",e)),r.createElement(C.Table,{"aria-label":h.tables.trigger.title,rows:t,cells:Cn,onSort:i,sortBy:n},r.createElement(C.TableHeader,null),r.createElement(C.TableBody,null)))};var Sn;!function(e){e.NAME="name"}(Sn||(Sn={}));const xn={[Sn.NAME]:{label:"System",placeholder:"Filter by system name"}},On=e=>{const t=(0,a.usePrimaryToolbarFilterConfig)(Sn,e.filters,e.setFilters,e.clearFilters,xn),i=r.useMemo((()=>({itemCount:e.count||0,page:e.page.index,perPage:e.page.size,perPageOptions:void 0,onSetPage:e.onPaginationChanged,onFirstClick:e.onPaginationChanged,onPreviousClick:e.onPaginationChanged,onNextClick:e.onPaginationChanged,onLastClick:e.onPaginationChanged,onPageInput:e.onPaginationChanged,onPerPageSelect:e.onPaginationSizeChanged,isCompact:!0,variant:s.PaginationVariant.top})),[e.onPaginationChanged,e.page,e.count,e.onPaginationSizeChanged]),n=r.useMemo((()=>({itemCount:e.count||0,page:e.page.index,perPage:e.page.size,perPageOptions:void 0,onSetPage:e.onPaginationChanged,onFirstClick:e.onPaginationChanged,onPreviousClick:e.onPaginationChanged,onNextClick:e.onPaginationChanged,onLastClick:e.onPaginationChanged,onPageInput:e.onPaginationChanged,onPerPageSelect:e.onPaginationSizeChanged,isCompact:!1,variant:s.PaginationVariant.bottom})),[e.onPaginationChanged,e.page,e.count,e.onPaginationSizeChanged]),o=r.useMemo((()=>{const t=e.onExport;return{extraItems:[],onSelect:(e,i)=>{t((0,a.exporterTypeFromString)(i))},"data-testid":"trigger-toolbar-export-container"}}),[e.onExport]);return r.createElement("div",Object.assign({},p("Trigger/TableDualToolbar",e)),r.createElement(l.PrimaryToolbar,{pagination:i,exportConfig:o,filterConfig:t.filterConfig,activeFiltersConfig:t.activeFiltersConfig}),e.children,r.createElement(l.PrimaryToolbar,{pagination:n}))};class Nn extends a.ExporterCsv{serialize(e){return Object.assign({},e)}headers(){return[["created","ctime"],["hostName","system"],["id","id"]]}}class In extends a.ExporterJson{}const Rn=e=>({id:e.id||"",hostName:e.hostName||"",created:e.ctime?(0,Fe.Z)(e.ctime/1e3):new Date(Date.now())}),wn=e=>xe.GetPoliciesByIdHistoryTrigger.actionCreator(Object.assign({id:e.policyId},e.page.toQuery())),An=(0,Ne.validationResponseTransformer)((e=>{var t,i,n;if("PagedResponseOfHistoryItem"===e.type){const a=e.value;return Object.assign(Object.assign({},e),{type:"PagedTriggers",value:{count:(null===(t=a.meta)||void 0===t?void 0:t.count)||0,data:(n=null!==(i=a.data)&&void 0!==i?i:[],n?n.map(Rn):[])}})}return e})),kn=(0,Ne.validationResponseTransformer)((e=>"PagedResponseOfHistoryItem"===e.type?Object.assign(Object.assign({},e),{type:"boolean",value:e.value.data&&e.value.data.length}):e)),Ln=e=>xe.GetPoliciesByIdHistoryTrigger.actionCreator(Object.assign({id:e},a.Page.of(1,1).toQuery()));const Dn=e=>(0,a.useUrlStateString)("system",e),Fn=e=>{switch(e){case Sn.NAME:return Dn;default:(0,P.vE)(e)}};var Mn=i(14299);const Vn=()=>r.createElement(g,{title:h.pages.policyDetail.triggerEmptyState.title,content:r.createElement(s.TextContent,null,r.createElement(s.Text,{style:{color:Mn.ZP.value}},h.pages.policyDetail.triggerEmptyState.text),r.createElement(s.Text,{component:"small"},h.pages.policyDetail.triggerEmptyState.sub))}),Bn=e=>{const t=pn(h.pages.policyDetail.triggerErrorState.text,[e.error]);return r.createElement(g,{icon:rt.ZP,iconColor:ot.ZP.value,title:h.pages.policyDetail.triggerErrorState.title,content:t,action:e.action,actionLabel:h.pages.policyDetail.triggerErrorState.actionText})},Un=a.Sort.by("ctime",a.Direction.DESCENDING),jn=e=>{var t;return e.errorContent?r.createElement(r.Fragment,null," ",e.errorContent," "):e.payload&&e.payload.count>0||e.loading?r.createElement(Pn,{rows:null===(t=e.payload)||void 0===t?void 0:t.data,onSort:e.sort.onSort,sortBy:e.sort.sortBy,loading:e.loading}):r.createElement(Tn,null)},Gn=(0,r.forwardRef)(((e,t)=>{var i;const{policyId:n}=e,o=((e=250)=>(0,a.useFilters)(Sn,e,Fn))(),s=(()=>{const e=(0,a.useTransformQueryResponse)((0,Oe.useParameterizedQuery)(wn),An),t=(0,a.useTransformQueryResponse)((0,Oe.useParameterizedQuery)(Ln),kn),[i,n]=(0,r.useState)(),o=(0,r.useCallback)(((...i)=>{const[{policyId:a,page:r}]=i,o=e.query,l=t.query,s=!r.hasFilter()&&1===r.index;return o({policyId:a,page:r}).then((e=>{if(404===e.status){if(!s)return n(void 0),l(a).then((t=>(404===t.status?n(!1):200===t.status?n(!0):n(void 0),e)));n(!1)}else 200===e.status?n(!0):n(void 0);return e}))}),[e.query,t.query]),l=(0,r.useCallback)((()=>{const i=e.abort,n=t.abort;i(),n()}),[e.abort,t.abort]),s=(0,r.useCallback)((()=>{const i=e.reset,n=t.reset;i(),n()}),[e.reset,t.reset]);return Object.assign(Object.assign({},e),{query:o,abort:l,reset:s,status:e.status,loading:t.loading||e.loading,errorObject:t.errorObject||e.errorObject,error:t.error||e.error,hasTriggers:i})})(),c=r.useMemo((()=>{const e=s.payload;if("PagedTriggers"===(null==e?void 0:e.type))return e.value}),[s.payload]),[d,u]=r.useState(be.defaultElementsPerPage),p=(0,a.useSort)(Un),{page:m,onPaginationChanged:g}=((e,t,i)=>{const n=r.useMemo((()=>{const e=new a.Filter,t=(0,a.stringValue)(i[Sn.NAME]);return t&&""!==t.trim()&&e.and("name",a.Operator.LIKE,t.trim()),e}),[i]),[o,l]=r.useState((()=>a.Page.of(1,e,n,t)));return(0,r.useEffect)((()=>{l((e=>e.sort!==t?a.Page.of(e.index,e.size,e.filter,t):e))}),[t]),(0,r.useEffect)((()=>{l((e=>e.filter!==n?a.Page.of(1,e.size,n,e.sort):e))}),[n]),(0,r.useEffect)((()=>{l((t=>t.size!==e?a.Page.of(1,e,t.filter,t.sort):t))}),[e]),{page:o,onPaginationChanged:r.useCallback(((e,t)=>{l((e=>e.withPage(t)))}),[l])}})(d,p.sortBy,o.debouncedFilters),y=(0,r.useCallback)((()=>{const e=s.query;n&&e({policyId:n,page:m})}),[n,s.query,m]);r.useEffect((()=>{y()}),[y]),r.useImperativeHandle(t,(()=>({refresh:y})),[y]);const h=((e,t)=>{const i=(0,Oe.useClient)();return(0,r.useCallback)((()=>new Promise((n=>{return r=void 0,o=void 0,s=function*(){const r=[];let o=a.Page.of(1,200,t);for(;;){const t=yield i.query(wn({policyId:e,page:o}));if(t.payload){const e=An(t.payload);if("PagedTriggers"===e.type&&e.value.data){if(r.push(...e.value.data),o=o.nextPage(),o.index>a.Page.lastPageForElements(e.value.count,o.size).index)break;continue}}break}n(r)},new((l=void 0)||(l=Promise))((function(e,t){function i(e){try{a(s.next(e))}catch(e){t(e)}}function n(e){try{a(s.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof l?a:new l((function(e){e(a)}))).then(i,n)}a((s=s.apply(r,o||[])).next())}));var r,o,l,s}))),[i,e,t])})(n,m.filter),E=r.useCallback((e=>{const t=(e=>{switch(e){case a.ExporterType.CSV:return new Nn;case a.ExporterType.JSON:return new In}(0,P.vE)(e)})((0,a.exporterTypeFromString)(e));h().then((e=>{e.length>0&&tn()(t.export(e),`policy-${n}-triggers-${(0,$.Z)(new Date(Date.now()),"y-dd-MM")}.${t.type}`)}))}),[h,n]),v=r.useCallback(((e,t)=>{u(t)}),[u]);let b;return!s.loading&&s.error&&404!==s.status&&(b=r.createElement(Bn,{action:y,error:`code: ${s.status}`})),r.createElement(l.Section,{ouiaId:"trigger-detail-section"},!1===s.hasTriggers?r.createElement(Vn,null):r.createElement(r.Fragment,null,r.createElement(On,{count:null==c?void 0:c.count,page:m,onPaginationChanged:g,onPaginationSizeChanged:v,pageCount:null===(i=null==c?void 0:c.data)||void 0===i?void 0:i.length,filters:o.filters,setFilters:o.setFilters,clearFilters:o.clearFilter,onExport:E},r.createElement(jn,{loading:s.loading,payload:c,sort:p,errorContent:b}))))})),zn=(0,u.style)({paddingBottom:8,paddingTop:16}),Hn={listPage:()=>"/list",policyDetail:e=>`/policy/${e}`},Qn=[{path:Hn.listPage(),component:()=>{var e;const[t,i]=r.useState({isOpen:!1}),n=Ze(),o=Ce(),c=(0,a.useSort)(),d=Pe(o.debouncedFilters,be.defaultElementsPerPage,c.sortBy),u=(e=>{const t=He(e,!1),i=(0,a.useTransformQueryResponse)((0,Oe.useQuery)(xe.GetPolicies.actionCreator(a.Page.of(1,1).toQuery()),!1),Qe),[n,o]=(0,r.useState)(),l=(0,r.useMemo)((()=>!e.hasFilter()&&1===e.index),[e]),s=(0,r.useCallback)((()=>{const e=t.query,n=i.query;return e().then((e=>{if(404===e.status){if(!l)return o(void 0),n().then((t=>(404===t.status?o(!1):200===t.status?o(!0):o(void 0),e)));o(!1)}else 200===e.status?o(!0):o(void 0);return e}))}),[t.query,i.query,l]),c=(0,r.useCallback)((()=>{const e=t.abort,n=i.abort;e(),n()}),[t.abort,i.abort]),d=(0,r.useCallback)((()=>{const e=t.reset,n=i.reset;e(),n()}),[t.reset,i.reset]);return Object.assign(Object.assign({},t),{query:s,abort:c,reset:d,status:t.status,loading:i.loading||t.loading,errorObject:i.errorObject||t.errorObject,error:i.error||t.error,hasPolicies:n})})(d.page),{query:p}=He(a.Page.of(0,a.Page.NO_SIZE,d.page.filter,d.page.sort),!1),m=De(),g=(0,r.useContext)(T);let E=u.loading||n.loading;const v="PagedResponseOfPolicy"===(null===(e=u.payload)||void 0===e?void 0:e.type)?u.payload.value.count:0,b=Le((e=>{if(200===(null==e?void 0:e.status))return e.value.data})(u.payload),E,v,d.page),{clearSelection:C,loadingSelected:S}=b;E=E||S;const{canReadPolicies:x,canWritePolicies:O}=g.rbac,{query:N}=u,{mutate:I,loading:R}=n,{open:w}=m,A=(0,_.Z)(R);r.useEffect((()=>{C()}),[o.debouncedFilters,C]),r.useEffect((()=>{!0!==A||R||N()}),[R,N,A]);const k=(e=>{const{rows:t,onSelect:i,removeSelection:n,clearSelection:o,selectionCount:l}=e.policyRows,{changePage:s}=e.policyPage,{index:c,size:d}=e.policyPage.page,{close:u,policy:p}=e.policyToDelete,{reload:m,count:g}=e;return{onDeleted:r.useCallback((e=>{const a=t.findIndex((t=>t.id===e));-1===a?n(e):i(t[a],a,!1)}),[t,i,n]),onCloseDeletePolicy:r.useCallback((e=>{if(e){m();const e=p?1:l,t=a.Page.lastPageForElements(g-e,d);t.index<c&&s(void 0,t.index),o()}u()}),[m,g,u,o,s,c,l,d,p])}})({policyPage:d,policyRows:b,policyToDelete:m,reload:N,count:v}),L=(e=>{const{canWrite:t,openPolicyToDelete:i,mutateChangePolicyEnabled:n,setPolicyWizardState:a}=e;return r.useCallback((e=>t?[{title:e.isEnabled?"Disable":"Enable",onClick:()=>{n({policyIds:[e.id],shouldBeEnabled:!e.isEnabled})}},{title:"Edit",onClick:()=>{a({isOpen:!0,template:e,showCreateStep:!1,isEditing:!0})}},{title:"Duplicate",onClick:()=>{a({isOpen:!0,template:Ge(e),showCreateStep:!1,isEditing:!1})}},{title:"Remove",onClick:()=>{i(e)}}]:[]),[t,i,n,a])})({canWrite:O,openPolicyToDelete:w,mutateChangePolicyEnabled:I,setPolicyWizardState:i}),D=(e=>{const{setPolicyWizardState:t,exportAllPoliciesQuery:i,mutateChangePolicyEnabled:n,openPolicyToDelete:o}=e,{selected:l,selectionCount:s,getSelected:c,rows:d}=e.policyRows;return{createCustomPolicy:r.useCallback((()=>{t({isOpen:!0,showCreateStep:!0,template:void 0,isEditing:!1})}),[t]),onDeletePolicies:r.useCallback((()=>{if(1===s){const e=d.find((e=>l.contains(e.id)));if(e)return void o(e)}o(s)}),[s,o,l,d]),onDisablePolicies:r.useCallback((()=>c().then((e=>n({shouldBeEnabled:!1,policyIds:e})))),[n,c]),onEnablePolicies:r.useCallback((()=>c().then((e=>n({shouldBeEnabled:!0,policyIds:e})))),[n,c]),onExport:r.useCallback(((e,t)=>{const n=(e=>{switch(e){case a.ExporterType.CSV:return new nn;case a.ExporterType.JSON:return new an}(0,P.vE)(e)})((0,a.exporterTypeFromString)(t));return i().then((e=>{var t;"PagedResponseOfPolicy"===(null===(t=e.payload)||void 0===t?void 0:t.type)?tn()(n.export(e.payload.value.data),`policies-${(0,$.Z)(new Date(Date.now()),"y-dd-MM")}.${n.type}`):(0,a.addDangerNotification)("Unable to download policies","We were unable to download the policies for exporting")}))}),[i])}})({setPolicyWizardState:i,policyRows:b,openPolicyToDelete:w,mutateChangePolicyEnabled:I,exportAllPoliciesQuery:p});r.useEffect((()=>{x&&N()}),[x,N]);const F=r.useCallback((e=>{const t=g.userSettings.refresh;e&&(N(),t()),i({isOpen:!1})}),[g.userSettings.refresh,i,N]),M=r.useMemo((()=>((e,t,i)=>{if(t)switch(i){case 404:return{title:h.tables.policy.emptyState.notFound.title,content:h.tables.policy.emptyState.notFound.content};case 401:return{icon:rt.ZP,title:"Refresh your browser",content:"Your session expired while using the application",action:e.refreshPage,actionLabel:"Reload page"};case 500:case 502:return{icon:rt.ZP,iconColor:rn.ZP.value,title:"Internal server error",content:"The server was unable to process the request, please try again.",action:e.tryAgain,actionLabel:"Try again"};default:return{icon:rt.ZP,iconColor:rn.ZP.value,title:"Unable to connect",content:"There was an error retrieving data. Check your connection and try again.",action:e.tryAgain,actionLabel:"Try again"}}})({refreshPage:()=>{window.location.reload()},tryAgain:()=>{N()}},u.error,u.status)),[u.error,u.status,N]);return r.createElement(r.Fragment,null,r.createElement(f.q,null,r.createElement("title",null,"Policies | Red Hat Insights")),r.createElement(l.PageHeader,null,r.createElement(l.PageHeaderTitle,{title:h.pages.listPage.title})),!g.userSettings.isSubscribedForNotifications&&b.rows.find((e=>e.actions.find((e=>e.type===y.NOTIFICATION))))&&r.createElement(s.PageSection,{className:on},r.createElement(a.InsightsEmailOptIn,{ouiaId:"list-email-required",content:h.pages.listPage.emailOptIn,insights:(0,a.getInsights)(),bundle:"rhel"})),r.createElement(l.Main,null,!1===u.hasPolicies?r.createElement(Ji,{createPolicy:O?D.createCustomPolicy:void 0}):r.createElement(l.Section,null,r.createElement(Ee,{ouiaId:"main-toolbar",onCreatePolicy:O?D.createCustomPolicy:void 0,onDeletePolicy:O?D.onDeletePolicies:void 0,onEnablePolicy:O?D.onEnablePolicies:void 0,onDisablePolicy:O?D.onDisablePolicies:void 0,onPaginationChanged:d.changePage,onPaginationSizeChanged:d.changeItemsPerPage,onSelectionChanged:b.onSelectionChanged,selectedCount:b.selectionCount,page:d.page.index,pageCount:b.rows.length,perPage:d.page.size,showPerPageOptions:!0,filters:o.filters,setFilters:o.setFilters,clearFilters:o.clearFilter,count:v,onExport:D.onExport,showBottomPagination:!0},r.createElement(pe,{ouiaId:"main-table",policies:b.rows,onCollapse:b.onCollapse,onSelect:b.onSelect,actionResolver:L,loading:E,error:M,onSort:c.onSort,sortBy:c.sortBy,linkToDetailPolicy:!0})))),t.isOpen&&r.createElement(Zi,{isOpen:t.isOpen,close:F,initialValue:t.template,showCreateStep:t.showCreateStep,policiesExist:!0===u.hasPolicies,isEditing:t.isEditing}),m.isOpen&&r.createElement(Ki,{onClose:k.onCloseDeletePolicy,onDeleted:k.onDeleted,loading:b.loadingSelected,count:m.count,getPolicies:b.getSelected,policy:m.policy}))}},{path:Hn.policyDetail(":policyId"),component:()=>{var e,t;const{policyId:i,policy:n,setPolicy:o}=(()=>{const{policyId:e}=(0,v.UO)(),t=(0,_.Z)(e),i=(0,v.k6)(),[n,a]=r.useState(),o=(null==n?void 0:n.id)||e,l=r.useCallback(((e,t)=>{(0,yn.unstable_batchedUpdates)((()=>{a(t),i.push(Hn.policyDetail(e))}))}),[i,a]),s=r.useCallback((t=>{e!==t.id?l(t.id,t):a(t)}),[l,e]);return(0,r.useEffect)((()=>{t!==e&&(n&&n.id===e||a(void 0))}),[e,t,l,i,n,o]),{policyId:o,policy:n,setPolicy:s}})(),c=(0,r.useContext)(T),{canReadPolicies:d,canWritePolicies:u}=c.rbac,p=(0,v.k6)(),m=De(),g=(0,a.useTransformQueryResponse)((0,Oe.useParameterizedQuery)(ln),sn),y=Ze(),b=(e=>{const[t,i]=r.useReducer(((t,i)=>{if(!e)return hn;switch(i){case gn.CLOSE:return hn;case gn.DUPLICATE:return{isEditing:!1,initialValue:Ge(e),isOpen:!0};case gn.EDIT:return{isEditing:!0,initialValue:e,isOpen:!0};default:return(0,P.vE)(i)}}),hn);return{data:t,close:(0,r.useCallback)((()=>i(gn.CLOSE)),[i]),duplicate:(0,r.useCallback)((()=>i(gn.DUPLICATE)),[i]),edit:(0,r.useCallback)((()=>i(gn.EDIT)),[i])}})(n),C=r.useRef(null),S=r.useCallback((e=>{var t;"Policy"===(null===(t=e.payload)||void 0===t?void 0:t.type)&&o(e.payload.value)}),[o]);r.useEffect((()=>{const e=g.query;i!==(null==n?void 0:n.id)&&e(i).then(S)}),[i,g.query,n,o,S]);const x=r.useCallback((e=>{const t=b.close;e&&o(e),t()}),[o,b.close]),O=r.useCallback((()=>{const e=m.open;n&&e(n)}),[n,m.open]),N=r.useCallback((e=>{const t=m.close;e?p.push(Hn.listPage()):t()}),[p,m.close]),I=r.useCallback((e=>{n&&o(Object.assign(Object.assign({},n),{isEnabled:e}))}),[n,o]),R=r.useCallback((e=>{(0,y.mutate)({policyIds:[i],shouldBeEnabled:e}).then((t=>{var n;200===(null===(n=t.payload)||void 0===n?void 0:n.status)?t.payload.value.includes(i)?I(e):(0,a.addDangerNotification)(h.pages.policyDetail.errorChangingEnabledStatus.notFound.title,h.pages.policyDetail.errorChangingEnabledStatus.notFound.text):(0,a.addDangerNotification)(h.pages.policyDetail.errorChangingEnabledStatus.else.title,h.pages.policyDetail.errorChangingEnabledStatus.else.text)}))}),[i,y.mutate,I]);if(!d)return r.createElement(E,null);if(void 0===n){if(404===g.status)return r.createElement(un,{policyId:i||""});if(!g.loading&&"Policy"!==(null===(e=g.payload)||void 0===e?void 0:e.type)){let e=`code: ${g.status}`;return"Msg"===(null===(t=g.payload)||void 0===t?void 0:t.type)&&g.payload.value.msg&&(e=g.payload.value.msg),r.createElement(mn,{action:()=>{var e;null===(e=C.current)||void 0===e||e.refresh(),g.query(i).then(S)},error:e})}return r.createElement(_n,null)}return r.createElement(r.Fragment,null,r.createElement(f.q,null,r.createElement("title",null,n.name," - Policies | Red Hat Insights")),r.createElement(l.PageHeader,null,r.createElement(s.Stack,null,r.createElement(s.StackItem,null,r.createElement(s.Breadcrumb,null,r.createElement(a.BreadcrumbLinkItem,{ouiaId:"to-list-page",to:Hn.listPage()},"Policies"),r.createElement(s.BreadcrumbItem,{to:"#",isActive:!0},n.name))),r.createElement(s.StackItem,null,r.createElement(s.Split,null,r.createElement(s.SplitItem,{isFilled:!0},r.createElement(l.PageHeaderTitle,{title:n.name})),r.createElement(s.SplitItem,null,r.createElement(cn,{isEnabled:n.isEnabled,disabled:!u,edit:b.edit,duplicate:b.duplicate,delete:O,changeEnabled:R,loadingEnabledChange:y.loading})))))),r.createElement(l.Main,null,r.createElement(a.Section,{ouiaId:"policy-detail",style:{paddingBottom:"4px"}},r.createElement(vn,{isEnabled:n.isEnabled,loading:y.loading}),r.createElement(ne,{actions:n.actions,description:n.description,created:n.ctime,updated:n.mtime,conditions:n.conditions})),r.createElement("div",{className:zn},r.createElement(s.Title,{headingLevel:"h2",size:"lg"},"Recent trigger history")),r.createElement(Gn,{policyId:i,ref:C})),b.data.isOpen&&r.createElement(Zi,{isOpen:!0,close:x,showCreateStep:!1,policiesExist:!1,initialValue:b.data.initialValue,isEditing:b.data.isEditing}),m.isOpen&&r.createElement(Ki,{onClose:N,loading:!1,count:m.count,policy:m.policy}))}}],qn=e=>r.createElement(b,null,r.createElement(v.AW,Object.assign({},e))),Zn=()=>r.createElement(v.rs,null,Qn.map((e=>r.createElement(qn,{key:e.path,component:e.component,path:e.path}))),r.createElement(v.l_,{to:Hn.listPage()})),Wn=be.apis.urls,$n=e=>({dailyEmail:e.daily_email,immediateEmail:e.instant_email}),Kn=()=>{const{rbac:e,userSettings:t}=(()=>{const e=(0,v.k6)(),[t,i]=(0,r.useState)(void 0),n=(e=>{const t=(0,a.useTransformQueryResponse)((0,Oe.useQuery)((0,Ie.actionBuilder)("GET",Wn.userSettings.email).build(),void 0),$n),i=t.query;return(0,a.useSyncInterval)(e,(0,r.useCallback)((()=>{i()}),[i])),(0,r.useMemo)((()=>{let e=!1;const n=t.payload;return n&&(e=!!n.dailyEmail||!!n.immediateEmail),{settings:t.payload,refresh:i,isSubscribedForNotifications:e}}),[t.payload,i])})(9e5);return(0,r.useEffect)((()=>{(0,a.waitForInsights)().then((e=>{e.chrome.init(),e.chrome.identifyApp(be.appId),e.chrome.hasOwnProperty("hideGlobalFilter")&&e.chrome.hideGlobalFilter&&e.chrome.hideGlobalFilter()}))}),[e]),(0,r.useEffect)((()=>{(0,a.waitForInsights)().then((e=>{e.chrome.auth.getUser().then((()=>{(0,a.fetchRBAC)(be.appId).then(i)}))}))}),[]),{rbac:t?{canReadPolicies:t.hasPermission("policies","policies","read"),canWritePolicies:t.hasPermission("policies","policies","write")}:void 0,userSettings:n}})();return e?r.createElement(T.Provider,{value:{rbac:e,userSettings:t}},e.canReadPolicies?r.createElement(r.Fragment,null,r.createElement(n.NotificationsPortal,null),r.createElement(Zn,null)):r.createElement(E,null)):r.createElement(a.AppSkeleton,null)}},1833:(e,t,i)=>{"use strict";i.d(t,{M:()=>a,i:()=>r});var n=i(55128);const a=(...e)=>(0,n.initStore)({},{},...e),r=()=>(0,n.restoreStore)()}}]);
//# sourceMappingURL=../sourcemaps/162.8efe2a34d0fe6a7418f3.js.map